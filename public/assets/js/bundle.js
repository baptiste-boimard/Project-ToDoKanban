(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
/*! Sortable 1.14.0 - MIT | git://github.com/SortableJS/Sortable.git */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Sortable=e()}(this,function(){"use strict";function e(e,t){var n,o=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)),o}function A(o){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?e(Object(i),!0).forEach(function(t){var e,n;e=o,t=i[n=t],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(i,t))})}return o}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function i(t,e){if(null==t)return{};var n,o=function(t,e){if(null==t)return{};for(var n,o={},i=Object.keys(t),r=0;r<i.length;r++)n=i[r],0<=e.indexOf(n)||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(t),r=0;r<i.length;r++)n=i[r],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n]);return o}function r(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function t(t){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var y=t(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),w=t(/Edge/i),s=t(/firefox/i),u=t(/safari/i)&&!t(/chrome/i)&&!t(/android/i),n=t(/iP(ad|od|hone)/i),c=t(/chrome/i)&&t(/android/i),d={capture:!1,passive:!1};function h(t,e,n){t.addEventListener(e,n,!y&&d)}function f(t,e,n){t.removeEventListener(e,n,!y&&d)}function p(t,e){if(e&&(">"===e[0]&&(e=e.substring(1)),t))try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(t){return}}function N(t,e,n,o){if(t){n=n||document;do{if(null!=e&&(">"!==e[0]||t.parentNode===n)&&p(t,e)||o&&t===n)return t}while(t!==n&&(t=(i=t).host&&i!==document&&i.host.nodeType?i.host:i.parentNode))}var i;return null}var g,m=/\s+/g;function I(t,e,n){var o;t&&e&&(t.classList?t.classList[n?"add":"remove"](e):(o=(" "+t.className+" ").replace(m," ").replace(" "+e+" "," "),t.className=(o+(n?" "+e:"")).replace(m," ")))}function P(t,e,n){var o=t&&t.style;if(o){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];o[e=!(e in o||-1!==e.indexOf("webkit"))?"-webkit-"+e:e]=n+("string"==typeof n?"":"px")}}function v(t,e){var n="";if("string"==typeof t)n=t;else do{var o=P(t,"transform")}while(o&&"none"!==o&&(n=o+" "+n),!e&&(t=t.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function b(t,e,n){if(t){var o=t.getElementsByTagName(e),i=0,r=o.length;if(n)for(;i<r;i++)n(o[i],i);return o}return[]}function O(){var t=document.scrollingElement;return t||document.documentElement}function k(t,e,n,o,i){if(t.getBoundingClientRect||t===window){var r,a,l,s,c,u,d=t!==window&&t.parentNode&&t!==O()?(a=(r=t.getBoundingClientRect()).top,l=r.left,s=r.bottom,c=r.right,u=r.height,r.width):(l=a=0,s=window.innerHeight,c=window.innerWidth,u=window.innerHeight,window.innerWidth);if((e||n)&&t!==window&&(i=i||t.parentNode,!y))do{if(i&&i.getBoundingClientRect&&("none"!==P(i,"transform")||n&&"static"!==P(i,"position"))){var h=i.getBoundingClientRect();a-=h.top+parseInt(P(i,"border-top-width")),l-=h.left+parseInt(P(i,"border-left-width")),s=a+r.height,c=l+r.width;break}}while(i=i.parentNode);return o&&t!==window&&(o=(e=v(i||t))&&e.a,t=e&&e.d,e&&(s=(a/=t)+(u/=t),c=(l/=o)+(d/=o))),{top:a,left:l,bottom:s,right:c,width:d,height:u}}}function R(t,e,n){for(var o=M(t,!0),i=k(t)[e];o;){var r=k(o)[n];if(!("top"===n||"left"===n?r<=i:i<=r))return o;if(o===O())break;o=M(o,!1)}return!1}function X(t,e,n,o){for(var i=0,r=0,a=t.children;r<a.length;){if("none"!==a[r].style.display&&a[r]!==Bt.ghost&&(o||a[r]!==Bt.dragged)&&N(a[r],n.draggable,t,!1)){if(i===e)return a[r];i++}r++}return null}function Y(t,e){for(var n=t.lastElementChild;n&&(n===Bt.ghost||"none"===P(n,"display")||e&&!p(n,e));)n=n.previousElementSibling;return n||null}function B(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)"TEMPLATE"===t.nodeName.toUpperCase()||t===Bt.clone||e&&!p(t,e)||n++;return n}function E(t){var e=0,n=0,o=O();if(t)do{var i=v(t),r=i.a,i=i.d}while(e+=t.scrollLeft*r,n+=t.scrollTop*i,t!==o&&(t=t.parentNode));return[e,n]}function M(t,e){if(!t||!t.getBoundingClientRect)return O();var n=t,o=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=P(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n.getBoundingClientRect||n===document.body)return O();if(o||e)return n;o=!0}}}while(n=n.parentNode);return O()}function D(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function S(e,n){return function(){var t;g||(1===(t=arguments).length?e.call(this,t[0]):e.apply(this,t),g=setTimeout(function(){g=void 0},n))}}function F(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function _(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function C(t,e){P(t,"position","absolute"),P(t,"top",e.top),P(t,"left",e.left),P(t,"width",e.width),P(t,"height",e.height)}function T(t){P(t,"position",""),P(t,"top",""),P(t,"left",""),P(t,"width",""),P(t,"height","")}var j="Sortable"+(new Date).getTime();function x(){var e,o=[];return{captureAnimationState:function(){o=[],this.options.animation&&[].slice.call(this.el.children).forEach(function(t){var e,n;"none"!==P(t,"display")&&t!==Bt.ghost&&(o.push({target:t,rect:k(t)}),e=A({},o[o.length-1].rect),!t.thisAnimationDuration||(n=v(t,!0))&&(e.top-=n.f,e.left-=n.e),t.fromRect=e)})},addAnimationState:function(t){o.push(t)},removeAnimationState:function(t){o.splice(function(t,e){for(var n in t)if(t.hasOwnProperty(n))for(var o in e)if(e.hasOwnProperty(o)&&e[o]===t[n][o])return Number(n);return-1}(o,{target:t}),1)},animateAll:function(t){var c=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof t&&t());var u=!1,d=0;o.forEach(function(t){var e=0,n=t.target,o=n.fromRect,i=k(n),r=n.prevFromRect,a=n.prevToRect,l=t.rect,s=v(n,!0);s&&(i.top-=s.f,i.left-=s.e),n.toRect=i,n.thisAnimationDuration&&D(r,i)&&!D(o,i)&&(l.top-i.top)/(l.left-i.left)==(o.top-i.top)/(o.left-i.left)&&(t=l,s=r,r=a,a=c.options,e=Math.sqrt(Math.pow(s.top-t.top,2)+Math.pow(s.left-t.left,2))/Math.sqrt(Math.pow(s.top-r.top,2)+Math.pow(s.left-r.left,2))*a.animation),D(i,o)||(n.prevFromRect=o,n.prevToRect=i,e=e||c.options.animation,c.animate(n,l,i,e)),e&&(u=!0,d=Math.max(d,e),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout(function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null},e),n.thisAnimationDuration=e)}),clearTimeout(e),u?e=setTimeout(function(){"function"==typeof t&&t()},d):"function"==typeof t&&t(),o=[]},animate:function(t,e,n,o){var i,r;o&&(P(t,"transition",""),P(t,"transform",""),i=(r=v(this.el))&&r.a,r=r&&r.d,i=(e.left-n.left)/(i||1),r=(e.top-n.top)/(r||1),t.animatingX=!!i,t.animatingY=!!r,P(t,"transform","translate3d("+i+"px,"+r+"px,0)"),this.forRepaintDummy=t.offsetWidth,P(t,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),P(t,"transform","translate3d(0,0,0)"),"number"==typeof t.animated&&clearTimeout(t.animated),t.animated=setTimeout(function(){P(t,"transition",""),P(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1},o))}}}var H=[],L={initializeByDefault:!0},K={mount:function(e){for(var t in L)!L.hasOwnProperty(t)||t in e||(e[t]=L[t]);H.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),H.push(e)},pluginEvent:function(e,n,o){var t=this;this.eventCanceled=!1,o.cancel=function(){t.eventCanceled=!0};var i=e+"Global";H.forEach(function(t){n[t.pluginName]&&(n[t.pluginName][i]&&n[t.pluginName][i](A({sortable:n},o)),n.options[t.pluginName]&&n[t.pluginName][e]&&n[t.pluginName][e](A({sortable:n},o)))})},initializePlugins:function(n,o,i,t){for(var e in H.forEach(function(t){var e=t.pluginName;(n.options[e]||t.initializeByDefault)&&((t=new t(n,o,n.options)).sortable=n,t.options=n.options,n[e]=t,a(i,t.defaults))}),n.options){var r;n.options.hasOwnProperty(e)&&(void 0!==(r=this.modifyOption(n,e,n.options[e]))&&(n.options[e]=r))}},getEventProperties:function(e,n){var o={};return H.forEach(function(t){"function"==typeof t.eventProperties&&a(o,t.eventProperties.call(n[t.pluginName],e))}),o},modifyOption:function(e,n,o){var i;return H.forEach(function(t){e[t.pluginName]&&t.optionListeners&&"function"==typeof t.optionListeners[n]&&(i=t.optionListeners[n].call(e[t.pluginName],o))}),i}};function W(t){var e=t.sortable,n=t.rootEl,o=t.name,i=t.targetEl,r=t.cloneEl,a=t.toEl,l=t.fromEl,s=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,d=t.newDraggableIndex,h=t.originalEvent,f=t.putSortable,p=t.extraEventProperties;if(e=e||n&&n[j]){var g,m=e.options,t="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||y||w?(g=document.createEvent("Event")).initEvent(o,!0,!0):g=new CustomEvent(o,{bubbles:!0,cancelable:!0}),g.to=a||n,g.from=l||n,g.item=i||n,g.clone=r,g.oldIndex=s,g.newIndex=c,g.oldDraggableIndex=u,g.newDraggableIndex=d,g.originalEvent=h,g.pullMode=f?f.lastPutMode:void 0;var v,b=A(A({},p),K.getEventProperties(o,e));for(v in b)g[v]=b[v];n&&n.dispatchEvent(g),m[t]&&m[t].call(e,g)}}function z(t,e){var n=(o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).evt,o=i(o,G);K.pluginEvent.bind(Bt)(t,e,A({dragEl:q,parentEl:V,ghostEl:Z,rootEl:$,nextEl:Q,lastDownEl:J,cloneEl:tt,cloneHidden:et,dragStarted:pt,putSortable:lt,activeSortable:Bt.active,originalEvent:n,oldIndex:nt,oldDraggableIndex:it,newIndex:ot,newDraggableIndex:rt,hideGhostForTarget:kt,unhideGhostForTarget:Rt,cloneNowHidden:function(){et=!0},cloneNowShown:function(){et=!1},dispatchSortableEvent:function(t){U({sortable:e,name:t,originalEvent:n})}},o))}var G=["evt"];function U(t){W(A({putSortable:lt,cloneEl:tt,targetEl:q,rootEl:$,oldIndex:nt,oldDraggableIndex:it,newIndex:ot,newDraggableIndex:rt},t))}var q,V,Z,$,Q,J,tt,et,nt,ot,it,rt,at,lt,st,ct,ut,dt,ht,ft,pt,gt,mt,vt,bt,yt=!1,wt=!1,Et=[],Dt=!1,St=!1,_t=[],Ct=!1,Tt=[],xt="undefined"!=typeof document,Ot=n,Mt=w||y?"cssFloat":"float",At=xt&&!c&&!n&&"draggable"in document.createElement("div"),Nt=function(){if(xt){if(y)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}}(),It=function(t,e){var n=P(t),o=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=X(t,0,e),r=X(t,1,e),a=i&&P(i),l=r&&P(r),s=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+k(i).width,t=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+k(r).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&a.float&&"none"!==a.float){e="left"===a.float?"left":"right";return!r||"both"!==l.clear&&l.clear!==e?"horizontal":"vertical"}return i&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||o<=s&&"none"===n[Mt]||r&&"none"===n[Mt]&&o<s+t)?"vertical":"horizontal"},Pt=function(t){function l(r,a){return function(t,e,n,o){var i=t.options.group.name&&e.options.group.name&&t.options.group.name===e.options.group.name;if(null==r&&(a||i))return!0;if(null==r||!1===r)return!1;if(a&&"clone"===r)return r;if("function"==typeof r)return l(r(t,e,n,o),a)(t,e,n,o);e=(a?t:e).options.group.name;return!0===r||"string"==typeof r&&r===e||r.join&&-1<r.indexOf(e)}}var e={},n=t.group;n&&"object"==o(n)||(n={name:n}),e.name=n.name,e.checkPull=l(n.pull,!0),e.checkPut=l(n.put),e.revertClone=n.revertClone,t.group=e},kt=function(){!Nt&&Z&&P(Z,"display","none")},Rt=function(){!Nt&&Z&&P(Z,"display","")};xt&&document.addEventListener("click",function(t){if(wt)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),wt=!1},!0);function Xt(t){if(q){t=t.touches?t.touches[0]:t;var e=(i=t.clientX,r=t.clientY,Et.some(function(t){var e=t[j].options.emptyInsertThreshold;if(e&&!Y(t)){var n=k(t),o=i>=n.left-e&&i<=n.right+e,e=r>=n.top-e&&r<=n.bottom+e;return o&&e?a=t:void 0}}),a);if(e){var n,o={};for(n in t)t.hasOwnProperty(n)&&(o[n]=t[n]);o.target=o.rootEl=e,o.preventDefault=void 0,o.stopPropagation=void 0,e[j]._onDragOver(o)}}var i,r,a}function Yt(t){q&&q.parentNode[j]._isOutsideThisEl(t.target)}function Bt(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=a({},e),t[j]=this;var n,o,i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return It(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Bt.supportPointer&&"PointerEvent"in window&&!u,emptyInsertThreshold:5};for(n in K.initializePlugins(this,t,i),i)n in e||(e[n]=i[n]);for(o in Pt(e),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!e.forceFallback&&At,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?h(t,"pointerdown",this._onTapStart):(h(t,"mousedown",this._onTapStart),h(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(h(t,"dragover",this),h(t,"dragenter",this)),Et.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),a(this,x())}function Ft(t,e,n,o,i,r,a,l){var s,c,u=t[j],d=u.options.onMove;return!window.CustomEvent||y||w?(s=document.createEvent("Event")).initEvent("move",!0,!0):s=new CustomEvent("move",{bubbles:!0,cancelable:!0}),s.to=e,s.from=t,s.dragged=n,s.draggedRect=o,s.related=i||e,s.relatedRect=r||k(e),s.willInsertAfter=l,s.originalEvent=a,t.dispatchEvent(s),c=d?d.call(u,s,a):c}function jt(t){t.draggable=!1}function Ht(){Ct=!1}function Lt(t){return setTimeout(t,0)}function Kt(t){return clearTimeout(t)}Bt.prototype={constructor:Bt,_isOutsideThisEl:function(t){this.el.contains(t)||t===this.el||(gt=null)},_getDirection:function(t,e){return"function"==typeof this.options.direction?this.options.direction.call(this,t,e,q):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,o=this.el,t=this.options,i=t.preventOnFilter,r=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,l=(a||e).target,s=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,c=t.filter;if(!function(t){Tt.length=0;var e=t.getElementsByTagName("input"),n=e.length;for(;n--;){var o=e[n];o.checked&&Tt.push(o)}}(o),!q&&!(/mousedown|pointerdown/.test(r)&&0!==e.button||t.disabled)&&!s.isContentEditable&&(this.nativeDraggable||!u||!l||"SELECT"!==l.tagName.toUpperCase())&&!((l=N(l,t.draggable,o,!1))&&l.animated||J===l)){if(nt=B(l),it=B(l,t.draggable),"function"==typeof c){if(c.call(this,e,l,this))return U({sortable:n,rootEl:s,name:"filter",targetEl:l,toEl:o,fromEl:o}),z("filter",n,{evt:e}),void(i&&e.cancelable&&e.preventDefault())}else if(c=c&&c.split(",").some(function(t){if(t=N(s,t.trim(),o,!1))return U({sortable:n,rootEl:t,name:"filter",targetEl:l,fromEl:o,toEl:o}),z("filter",n,{evt:e}),!0}))return void(i&&e.cancelable&&e.preventDefault());t.handle&&!N(s,t.handle,o,!1)||this._prepareDragStart(e,a,l)}}},_prepareDragStart:function(t,e,n){var o,i=this,r=i.el,a=i.options,l=r.ownerDocument;n&&!q&&n.parentNode===r&&(o=k(n),$=r,V=(q=n).parentNode,Q=q.nextSibling,J=n,at=a.group,st={target:Bt.dragged=q,clientX:(e||t).clientX,clientY:(e||t).clientY},ht=st.clientX-o.left,ft=st.clientY-o.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,q.style["will-change"]="all",o=function(){z("delayEnded",i,{evt:t}),Bt.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!s&&i.nativeDraggable&&(q.draggable=!0),i._triggerDragStart(t,e),U({sortable:i,name:"choose",originalEvent:t}),I(q,a.chosenClass,!0))},a.ignore.split(",").forEach(function(t){b(q,t.trim(),jt)}),h(l,"dragover",Xt),h(l,"mousemove",Xt),h(l,"touchmove",Xt),h(l,"mouseup",i._onDrop),h(l,"touchend",i._onDrop),h(l,"touchcancel",i._onDrop),s&&this.nativeDraggable&&(this.options.touchStartThreshold=4,q.draggable=!0),z("delayStart",this,{evt:t}),!a.delay||a.delayOnTouchOnly&&!e||this.nativeDraggable&&(w||y)?o():Bt.eventCanceled?this._onDrop():(h(l,"mouseup",i._disableDelayedDrag),h(l,"touchend",i._disableDelayedDrag),h(l,"touchcancel",i._disableDelayedDrag),h(l,"mousemove",i._delayedDragTouchMoveHandler),h(l,"touchmove",i._delayedDragTouchMoveHandler),a.supportPointer&&h(l,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(o,a.delay)))},_delayedDragTouchMoveHandler:function(t){t=t.touches?t.touches[0]:t;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){q&&jt(q),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;f(t,"mouseup",this._disableDelayedDrag),f(t,"touchend",this._disableDelayedDrag),f(t,"touchcancel",this._disableDelayedDrag),f(t,"mousemove",this._delayedDragTouchMoveHandler),f(t,"touchmove",this._delayedDragTouchMoveHandler),f(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||"touch"==t.pointerType&&t,!this.nativeDraggable||e?this.options.supportPointer?h(document,"pointermove",this._onTouchMove):h(document,e?"touchmove":"mousemove",this._onTouchMove):(h(q,"dragend",this),h($,"dragstart",this._onDragStart));try{document.selection?Lt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(t,e){var n;yt=!1,$&&q?(z("dragStarted",this,{evt:e}),this.nativeDraggable&&h(document,"dragover",Yt),n=this.options,t||I(q,n.dragClass,!1),I(q,n.ghostClass,!0),Bt.active=this,t&&this._appendGhost(),U({sortable:this,name:"start",originalEvent:e})):this._nulling()},_emulateDragOver:function(){if(ct){this._lastX=ct.clientX,this._lastY=ct.clientY,kt();for(var t=document.elementFromPoint(ct.clientX,ct.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ct.clientX,ct.clientY))!==e;)e=t;if(q.parentNode[j]._isOutsideThisEl(t),e)do{if(e[j])if(e[j]._onDragOver({clientX:ct.clientX,clientY:ct.clientY,target:t,rootEl:e})&&!this.options.dragoverBubble)break}while(e=(t=e).parentNode);Rt()}},_onTouchMove:function(t){if(st){var e=this.options,n=e.fallbackTolerance,o=e.fallbackOffset,i=t.touches?t.touches[0]:t,r=Z&&v(Z,!0),a=Z&&r&&r.a,l=Z&&r&&r.d,e=Ot&&bt&&E(bt),a=(i.clientX-st.clientX+o.x)/(a||1)+(e?e[0]-_t[0]:0)/(a||1),l=(i.clientY-st.clientY+o.y)/(l||1)+(e?e[1]-_t[1]:0)/(l||1);if(!Bt.active&&!yt){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}Z&&(r?(r.e+=a-(ut||0),r.f+=l-(dt||0)):r={a:1,b:0,c:0,d:1,e:a,f:l},r="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")"),P(Z,"webkitTransform",r),P(Z,"mozTransform",r),P(Z,"msTransform",r),P(Z,"transform",r),ut=a,dt=l,ct=i),t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!Z){var t=this.options.fallbackOnBody?document.body:$,e=k(q,!0,Ot,!0,t),n=this.options;if(Ot){for(bt=t;"static"===P(bt,"position")&&"none"===P(bt,"transform")&&bt!==document;)bt=bt.parentNode;bt!==document.body&&bt!==document.documentElement?(bt===document&&(bt=O()),e.top+=bt.scrollTop,e.left+=bt.scrollLeft):bt=O(),_t=E(bt)}I(Z=q.cloneNode(!0),n.ghostClass,!1),I(Z,n.fallbackClass,!0),I(Z,n.dragClass,!0),P(Z,"transition",""),P(Z,"transform",""),P(Z,"box-sizing","border-box"),P(Z,"margin",0),P(Z,"top",e.top),P(Z,"left",e.left),P(Z,"width",e.width),P(Z,"height",e.height),P(Z,"opacity","0.8"),P(Z,"position",Ot?"absolute":"fixed"),P(Z,"zIndex","100000"),P(Z,"pointerEvents","none"),Bt.ghost=Z,t.appendChild(Z),P(Z,"transform-origin",ht/parseInt(Z.style.width)*100+"% "+ft/parseInt(Z.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,o=t.dataTransfer,i=n.options;z("dragStart",this,{evt:t}),Bt.eventCanceled?this._onDrop():(z("setupClone",this),Bt.eventCanceled||((tt=_(q)).draggable=!1,tt.style["will-change"]="",this._hideClone(),I(tt,this.options.chosenClass,!1),Bt.clone=tt),n.cloneId=Lt(function(){z("clone",n),Bt.eventCanceled||(n.options.removeCloneOnHide||$.insertBefore(tt,q),n._hideClone(),U({sortable:n,name:"clone"}))}),e||I(q,i.dragClass,!0),e?(wt=!0,n._loopId=setInterval(n._emulateDragOver,50)):(f(document,"mouseup",n._onDrop),f(document,"touchend",n._onDrop),f(document,"touchcancel",n._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(n,o,q)),h(document,"drop",n),P(q,"transform","translateZ(0)")),yt=!0,n._dragStartId=Lt(n._dragStarted.bind(n,e,t)),h(document,"selectstart",n),pt=!0,u&&P(document.body,"user-select","none"))},_onDragOver:function(n){var o,i,r,t,a=this.el,l=n.target,e=this.options,s=e.group,c=Bt.active,u=at===s,d=e.sort,h=lt||c,f=this,p=!1;if(!Ct){if(void 0!==n.preventDefault&&n.cancelable&&n.preventDefault(),l=N(l,e.draggable,a,!0),T("dragOver"),Bt.eventCanceled)return p;if(q.contains(n.target)||l.animated&&l.animatingX&&l.animatingY||f._ignoreWhileAnimating===l)return O(!1);if(wt=!1,c&&!e.disabled&&(u?d||(i=V!==$):lt===this||(this.lastPutMode=at.checkPull(this,c,q,n))&&s.checkPut(this,c,q,n))){if(r="vertical"===this._getDirection(n,l),o=k(q),T("dragOverValid"),Bt.eventCanceled)return p;if(i)return V=$,x(),this._hideClone(),T("revert"),Bt.eventCanceled||(Q?$.insertBefore(q,Q):$.appendChild(q)),O(!0);var g=Y(a,e.draggable);if(!g||function(t,e,n){n=k(Y(n.el,n.options.draggable));return e?t.clientX>n.right+10||t.clientX<=n.right&&t.clientY>n.bottom&&t.clientX>=n.left:t.clientX>n.right&&t.clientY>n.top||t.clientX<=n.right&&t.clientY>n.bottom+10}(n,r,this)&&!g.animated){if(g===q)return O(!1);if((l=g&&a===n.target?g:l)&&(w=k(l)),!1!==Ft($,a,q,o,l,w,n,!!l))return x(),a.appendChild(q),V=a,M(),O(!0)}else if(g&&function(t,e,n){n=k(X(n.el,0,n.options,!0));return e?t.clientX<n.left-10||t.clientY<n.top&&t.clientX<n.right:t.clientY<n.top-10||t.clientY<n.bottom&&t.clientX<n.left}(n,r,this)){var m=X(a,0,e,!0);if(m===q)return O(!1);if(w=k(l=m),!1!==Ft($,a,q,o,l,w,n,!1))return x(),a.insertBefore(q,m),V=a,M(),O(!0)}else if(l.parentNode===a){var v,b,y,w=k(l),E=q.parentNode!==a,D=(D=q.animated&&q.toRect||o,C=l.animated&&l.toRect||w,S=(t=r)?D.left:D.top,s=t?D.right:D.bottom,g=t?D.width:D.height,m=t?C.left:C.top,D=t?C.right:C.bottom,C=t?C.width:C.height,!(S===m||s===D||S+g/2===m+C/2)),S=r?"top":"left",g=R(l,"top","top")||R(q,"top","top"),m=g?g.scrollTop:void 0;if(gt!==l&&(b=w[S],Dt=!1,St=!D&&e.invertSwap||E),0!==(v=function(t,e,n,o,i,r,a,l){var s=o?t.clientY:t.clientX,c=o?n.height:n.width,t=o?n.top:n.left,o=o?n.bottom:n.right,n=!1;if(!a)if(l&&vt<c*i){if(Dt=!Dt&&(1===mt?t+c*r/2<s:s<o-c*r/2)?!0:Dt)n=!0;else if(1===mt?s<t+vt:o-vt<s)return-mt}else if(t+c*(1-i)/2<s&&s<o-c*(1-i)/2)return function(t){return B(q)<B(t)?1:-1}(e);if((n=n||a)&&(s<t+c*r/2||o-c*r/2<s))return t+c/2<s?1:-1;return 0}(n,l,w,r,D?1:e.swapThreshold,null==e.invertedSwapThreshold?e.swapThreshold:e.invertedSwapThreshold,St,gt===l)))for(var _=B(q);(y=V.children[_-=v])&&("none"===P(y,"display")||y===Z););if(0===v||y===l)return O(!1);mt=v;var C=(gt=l).nextElementSibling,E=!1,D=Ft($,a,q,o,l,w,n,E=1===v);if(!1!==D)return 1!==D&&-1!==D||(E=1===D),Ct=!0,setTimeout(Ht,30),x(),E&&!C?a.appendChild(q):l.parentNode.insertBefore(q,E?C:l),g&&F(g,0,m-g.scrollTop),V=q.parentNode,void 0===b||St||(vt=Math.abs(b-k(l)[S])),M(),O(!0)}if(a.contains(q))return O(!1)}return!1}function T(t,e){z(t,f,A({evt:n,isOwner:u,axis:r?"vertical":"horizontal",revert:i,dragRect:o,targetRect:w,canSort:d,fromSortable:h,target:l,completed:O,onMove:function(t,e){return Ft($,a,q,o,t,k(t),n,e)},changed:M},e))}function x(){T("dragOverAnimationCapture"),f.captureAnimationState(),f!==h&&h.captureAnimationState()}function O(t){return T("dragOverCompleted",{insertion:t}),t&&(u?c._hideClone():c._showClone(f),f!==h&&(I(q,(lt||c).options.ghostClass,!1),I(q,e.ghostClass,!0)),lt!==f&&f!==Bt.active?lt=f:f===Bt.active&&lt&&(lt=null),h===f&&(f._ignoreWhileAnimating=l),f.animateAll(function(){T("dragOverAnimationComplete"),f._ignoreWhileAnimating=null}),f!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(l===q&&!q.animated||l===a&&!l.animated)&&(gt=null),e.dragoverBubble||n.rootEl||l===document||(q.parentNode[j]._isOutsideThisEl(n.target),t||Xt(n)),!e.dragoverBubble&&n.stopPropagation&&n.stopPropagation(),p=!0}function M(){ot=B(q),rt=B(q,e.draggable),U({sortable:f,name:"change",toEl:a,newIndex:ot,newDraggableIndex:rt,originalEvent:n})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){f(document,"mousemove",this._onTouchMove),f(document,"touchmove",this._onTouchMove),f(document,"pointermove",this._onTouchMove),f(document,"dragover",Xt),f(document,"mousemove",Xt),f(document,"touchmove",Xt)},_offUpEvents:function(){var t=this.el.ownerDocument;f(t,"mouseup",this._onDrop),f(t,"touchend",this._onDrop),f(t,"pointerup",this._onDrop),f(t,"touchcancel",this._onDrop),f(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;ot=B(q),rt=B(q,n.draggable),z("drop",this,{evt:t}),V=q&&q.parentNode,ot=B(q),rt=B(q,n.draggable),Bt.eventCanceled||(Dt=St=yt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Kt(this.cloneId),Kt(this._dragStartId),this.nativeDraggable&&(f(document,"drop",this),f(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),u&&P(document.body,"user-select",""),P(q,"transform",""),t&&(pt&&(t.cancelable&&t.preventDefault(),n.dropBubble||t.stopPropagation()),Z&&Z.parentNode&&Z.parentNode.removeChild(Z),($===V||lt&&"clone"!==lt.lastPutMode)&&tt&&tt.parentNode&&tt.parentNode.removeChild(tt),q&&(this.nativeDraggable&&f(q,"dragend",this),jt(q),q.style["will-change"]="",pt&&!yt&&I(q,(lt||this).options.ghostClass,!1),I(q,this.options.chosenClass,!1),U({sortable:this,name:"unchoose",toEl:V,newIndex:null,newDraggableIndex:null,originalEvent:t}),$!==V?(0<=ot&&(U({rootEl:V,name:"add",toEl:V,fromEl:$,originalEvent:t}),U({sortable:this,name:"remove",toEl:V,originalEvent:t}),U({rootEl:V,name:"sort",toEl:V,fromEl:$,originalEvent:t}),U({sortable:this,name:"sort",toEl:V,originalEvent:t})),lt&&lt.save()):ot!==nt&&0<=ot&&(U({sortable:this,name:"update",toEl:V,originalEvent:t}),U({sortable:this,name:"sort",toEl:V,originalEvent:t})),Bt.active&&(null!=ot&&-1!==ot||(ot=nt,rt=it),U({sortable:this,name:"end",toEl:V,originalEvent:t}),this.save())))),this._nulling()},_nulling:function(){z("nulling",this),$=q=V=Z=Q=tt=J=et=st=ct=pt=ot=rt=nt=it=gt=mt=lt=at=Bt.dragged=Bt.ghost=Bt.clone=Bt.active=null,Tt.forEach(function(t){t.checked=!0}),Tt.length=ut=dt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":q&&(this._onDragOver(t),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move");t.cancelable&&t.preventDefault()}(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var t,e=[],n=this.el.children,o=0,i=n.length,r=this.options;o<i;o++)N(t=n[o],r.draggable,this.el,!1)&&e.push(t.getAttribute(r.dataIdAttr)||function(t){var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,o=0;for(;n--;)o+=e.charCodeAt(n);return o.toString(36)}(t));return e},sort:function(t,e){var n={},o=this.el;this.toArray().forEach(function(t,e){e=o.children[e];N(e,this.options.draggable,o,!1)&&(n[t]=e)},this),e&&this.captureAnimationState(),t.forEach(function(t){n[t]&&(o.removeChild(n[t]),o.appendChild(n[t]))}),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return N(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];var o=K.modifyOption(this,t,e);n[t]=void 0!==o?o:e,"group"===t&&Pt(n)},destroy:function(){z("destroy",this);var t=this.el;t[j]=null,f(t,"mousedown",this._onTapStart),f(t,"touchstart",this._onTapStart),f(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(f(t,"dragover",this),f(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Et.splice(Et.indexOf(this.el),1),this.el=t=null},_hideClone:function(){et||(z("hideClone",this),Bt.eventCanceled||(P(tt,"display","none"),this.options.removeCloneOnHide&&tt.parentNode&&tt.parentNode.removeChild(tt),et=!0))},_showClone:function(t){"clone"===t.lastPutMode?et&&(z("showClone",this),Bt.eventCanceled||(q.parentNode!=$||this.options.group.revertClone?Q?$.insertBefore(tt,Q):$.appendChild(tt):$.insertBefore(tt,q),this.options.group.revertClone&&this.animate(q,tt),P(tt,"display",""),et=!1)):this._hideClone()}},xt&&h(document,"touchmove",function(t){(Bt.active||yt)&&t.cancelable&&t.preventDefault()}),Bt.utils={on:h,off:f,css:P,find:b,is:function(t,e){return!!N(t,e,t,!1)},extend:function(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},throttle:S,closest:N,toggleClass:I,clone:_,index:B,nextTick:Lt,cancelNextTick:Kt,detectDirection:It,getChild:X},Bt.get=function(t){return t[j]},Bt.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];(e=e[0].constructor===Array?e[0]:e).forEach(function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(Bt.utils=A(A({},Bt.utils),t.utils)),K.mount(t)})},Bt.create=function(t,e){return new Bt(t,e)};var Wt,zt,Gt,Ut,qt,Vt,Zt=[],$t=!(Bt.version="1.14.0");function Qt(){Zt.forEach(function(t){clearInterval(t.pid)}),Zt=[]}function Jt(){clearInterval(Vt)}var te,ee=S(function(n,t,e,o){if(t.scroll){var i,r=(n.touches?n.touches[0]:n).clientX,a=(n.touches?n.touches[0]:n).clientY,l=t.scrollSensitivity,s=t.scrollSpeed,c=O(),u=!1;zt!==e&&(zt=e,Qt(),Wt=t.scroll,i=t.scrollFn,!0===Wt&&(Wt=M(e,!0)));var d=0,h=Wt;do{var f=h,p=k(f),g=p.top,m=p.bottom,v=p.left,b=p.right,y=p.width,w=p.height,E=void 0,D=void 0,S=f.scrollWidth,_=f.scrollHeight,C=P(f),T=f.scrollLeft,p=f.scrollTop,D=f===c?(E=y<S&&("auto"===C.overflowX||"scroll"===C.overflowX||"visible"===C.overflowX),w<_&&("auto"===C.overflowY||"scroll"===C.overflowY||"visible"===C.overflowY)):(E=y<S&&("auto"===C.overflowX||"scroll"===C.overflowX),w<_&&("auto"===C.overflowY||"scroll"===C.overflowY)),T=E&&(Math.abs(b-r)<=l&&T+y<S)-(Math.abs(v-r)<=l&&!!T),p=D&&(Math.abs(m-a)<=l&&p+w<_)-(Math.abs(g-a)<=l&&!!p);if(!Zt[d])for(var x=0;x<=d;x++)Zt[x]||(Zt[x]={});Zt[d].vx==T&&Zt[d].vy==p&&Zt[d].el===f||(Zt[d].el=f,Zt[d].vx=T,Zt[d].vy=p,clearInterval(Zt[d].pid),0==T&&0==p||(u=!0,Zt[d].pid=setInterval(function(){o&&0===this.layer&&Bt.active._onTouchMove(qt);var t=Zt[this.layer].vy?Zt[this.layer].vy*s:0,e=Zt[this.layer].vx?Zt[this.layer].vx*s:0;"function"==typeof i&&"continue"!==i.call(Bt.dragged.parentNode[j],e,t,n,qt,Zt[this.layer].el)||F(Zt[this.layer].el,e,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&h!==c&&(h=M(h,!1)));$t=u}},30),n=function(t){var e=t.originalEvent,n=t.putSortable,o=t.dragEl,i=t.activeSortable,r=t.dispatchSortableEvent,a=t.hideGhostForTarget,t=t.unhideGhostForTarget;e&&(i=n||i,a(),e=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,e=document.elementFromPoint(e.clientX,e.clientY),t(),i&&!i.el.contains(e)&&(r("spill"),this.onSpill({dragEl:o,putSortable:n})))};function ne(){}function oe(){}ne.prototype={startIndex:null,dragStart:function(t){t=t.oldDraggableIndex;this.startIndex=t},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();t=X(this.sortable.el,this.startIndex,this.options);t?this.sortable.el.insertBefore(e,t):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:n},a(ne,{pluginName:"revertOnSpill"}),oe.prototype={onSpill:function(t){var e=t.dragEl,t=t.putSortable||this.sortable;t.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),t.animateAll()},drop:n},a(oe,{pluginName:"removeOnSpill"});var ie,re,ae,le,se,ce=[],ue=[],de=!1,he=!1,fe=!1;function pe(n,o){ue.forEach(function(t,e){e=o.children[t.sortableIndex+(n?Number(e):0)];e?o.insertBefore(t,e):o.appendChild(t)})}function ge(){ce.forEach(function(t){t!==ae&&t.parentNode&&t.parentNode.removeChild(t)})}return Bt.mount(new function(){function t(){for(var t in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this))}return t.prototype={dragStarted:function(t){t=t.originalEvent;this.sortable.nativeDraggable?h(document,"dragover",this._handleAutoScroll):this.options.supportPointer?h(document,"pointermove",this._handleFallbackAutoScroll):t.touches?h(document,"touchmove",this._handleFallbackAutoScroll):h(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){t=t.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?f(document,"dragover",this._handleAutoScroll):(f(document,"pointermove",this._handleFallbackAutoScroll),f(document,"touchmove",this._handleFallbackAutoScroll),f(document,"mousemove",this._handleFallbackAutoScroll)),Jt(),Qt(),clearTimeout(g),g=void 0},nulling:function(){qt=zt=Wt=$t=Vt=Gt=Ut=null,Zt.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(e,n){var o,i=this,r=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,t=document.elementFromPoint(r,a);qt=e,n||this.options.forceAutoScrollFallback||w||y||u?(ee(e,this.options,t,n),o=M(t,!0),!$t||Vt&&r===Gt&&a===Ut||(Vt&&Jt(),Vt=setInterval(function(){var t=M(document.elementFromPoint(r,a),!0);t!==o&&(o=t,Qt()),ee(e,i.options,t,n)},10),Gt=r,Ut=a)):this.options.bubbleScroll&&M(t,!0)!==O()?ee(e,this.options,M(t,!1),!1):Qt()}},a(t,{pluginName:"scroll",initializeByDefault:!0})}),Bt.mount(oe,ne),Bt.mount(new function(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(t){t=t.dragEl;te=t},dragOverValid:function(t){var e=t.completed,n=t.target,o=t.onMove,i=t.activeSortable,r=t.changed,a=t.cancel;i.options.swap&&(t=this.sortable.el,i=this.options,n&&n!==t&&(t=te,te=!1!==o(n)?(I(n,i.swapClass,!0),n):null,t&&t!==te&&I(t,i.swapClass,!1)),r(),e(!0),a())},drop:function(t){var e,n,o=t.activeSortable,i=t.putSortable,r=t.dragEl,a=i||this.sortable,l=this.options;te&&I(te,l.swapClass,!1),te&&(l.swap||i&&i.options.swap)&&r!==te&&(a.captureAnimationState(),a!==o&&o.captureAnimationState(),n=te,t=(e=r).parentNode,l=n.parentNode,t&&l&&!t.isEqualNode(n)&&!l.isEqualNode(e)&&(i=B(e),r=B(n),t.isEqualNode(l)&&i<r&&r++,t.insertBefore(n,t.children[i]),l.insertBefore(e,l.children[r])),a.animateAll(),a!==o&&o.animateAll())},nulling:function(){te=null}},a(t,{pluginName:"swap",eventProperties:function(){return{swapItem:te}}})}),Bt.mount(new function(){function t(o){for(var t in this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this));o.options.supportPointer?h(document,"pointerup",this._deselectMultiDrag):(h(document,"mouseup",this._deselectMultiDrag),h(document,"touchend",this._deselectMultiDrag)),h(document,"keydown",this._checkKeyDown),h(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(t,e){var n="";ce.length&&re===o?ce.forEach(function(t,e){n+=(e?", ":"")+t.textContent}):n=e.textContent,t.setData("Text",n)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(t){t=t.dragEl;ae=t},delayEnded:function(){this.isMultiDrag=~ce.indexOf(ae)},setupClone:function(t){var e=t.sortable,t=t.cancel;if(this.isMultiDrag){for(var n=0;n<ce.length;n++)ue.push(_(ce[n])),ue[n].sortableIndex=ce[n].sortableIndex,ue[n].draggable=!1,ue[n].style["will-change"]="",I(ue[n],this.options.selectedClass,!1),ce[n]===ae&&I(ue[n],this.options.chosenClass,!1);e._hideClone(),t()}},clone:function(t){var e=t.sortable,n=t.rootEl,o=t.dispatchSortableEvent,t=t.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||ce.length&&re===e&&(pe(!0,n),o("clone"),t()))},showClone:function(t){var e=t.cloneNowShown,n=t.rootEl,t=t.cancel;this.isMultiDrag&&(pe(!1,n),ue.forEach(function(t){P(t,"display","")}),e(),se=!1,t())},hideClone:function(t){var e=this,n=(t.sortable,t.cloneNowHidden),t=t.cancel;this.isMultiDrag&&(ue.forEach(function(t){P(t,"display","none"),e.options.removeCloneOnHide&&t.parentNode&&t.parentNode.removeChild(t)}),n(),se=!0,t())},dragStartGlobal:function(t){t.sortable;!this.isMultiDrag&&re&&re.multiDrag._deselectMultiDrag(),ce.forEach(function(t){t.sortableIndex=B(t)}),ce=ce.sort(function(t,e){return t.sortableIndex-e.sortableIndex}),fe=!0},dragStarted:function(t){var e,n=this,t=t.sortable;this.isMultiDrag&&(this.options.sort&&(t.captureAnimationState(),this.options.animation&&(ce.forEach(function(t){t!==ae&&P(t,"position","absolute")}),e=k(ae,!1,!0,!0),ce.forEach(function(t){t!==ae&&C(t,e)}),de=he=!0)),t.animateAll(function(){de=he=!1,n.options.animation&&ce.forEach(function(t){T(t)}),n.options.sort&&ge()}))},dragOver:function(t){var e=t.target,n=t.completed,t=t.cancel;he&&~ce.indexOf(e)&&(n(!1),t())},revert:function(t){var n,o,e=t.fromSortable,i=t.rootEl,r=t.sortable,a=t.dragRect;1<ce.length&&(ce.forEach(function(t){r.addAnimationState({target:t,rect:he?k(t):a}),T(t),t.fromRect=a,e.removeAnimationState(t)}),he=!1,n=!this.options.removeCloneOnHide,o=i,ce.forEach(function(t,e){e=o.children[t.sortableIndex+(n?Number(e):0)];e?o.insertBefore(t,e):o.appendChild(t)}))},dragOverCompleted:function(t){var e,n=t.sortable,o=t.isOwner,i=t.insertion,r=t.activeSortable,a=t.parentEl,l=t.putSortable,t=this.options;i&&(o&&r._hideClone(),de=!1,t.animation&&1<ce.length&&(he||!o&&!r.options.sort&&!l)&&(e=k(ae,!1,!0,!0),ce.forEach(function(t){t!==ae&&(C(t,e),a.appendChild(t))}),he=!0),o||(he||ge(),1<ce.length?(o=se,r._showClone(n),r.options.animation&&!se&&o&&ue.forEach(function(t){r.addAnimationState({target:t,rect:le}),t.fromRect=le,t.thisAnimationDuration=null})):r._showClone(n)))},dragOverAnimationCapture:function(t){var e=t.dragRect,n=t.isOwner,t=t.activeSortable;ce.forEach(function(t){t.thisAnimationDuration=null}),t.options.animation&&!n&&t.multiDrag.isMultiDrag&&(le=a({},e),e=v(ae,!0),le.top-=e.f,le.left-=e.e)},dragOverAnimationComplete:function(){he&&(he=!1,ge())},drop:function(t){var e=t.originalEvent,n=t.rootEl,o=t.parentEl,i=t.sortable,r=t.dispatchSortableEvent,a=t.oldIndex,l=t.putSortable,s=l||this.sortable;if(e){var c,u,d,h=this.options,f=o.children;if(!fe)if(h.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),I(ae,h.selectedClass,!~ce.indexOf(ae)),~ce.indexOf(ae))ce.splice(ce.indexOf(ae),1),ie=null,W({sortable:i,rootEl:n,name:"deselect",targetEl:ae,originalEvt:e});else{if(ce.push(ae),W({sortable:i,rootEl:n,name:"select",targetEl:ae,originalEvt:e}),e.shiftKey&&ie&&i.el.contains(ie)){var p=B(ie),t=B(ae);if(~p&&~t&&p!==t)for(var g,m=p<t?(g=p,t):(g=t,p+1);g<m;g++)~ce.indexOf(f[g])||(I(f[g],h.selectedClass,!0),ce.push(f[g]),W({sortable:i,rootEl:n,name:"select",targetEl:f[g],originalEvt:e}))}else ie=ae;re=s}fe&&this.isMultiDrag&&(he=!1,(o[j].options.sort||o!==n)&&1<ce.length&&(c=k(ae),u=B(ae,":not(."+this.options.selectedClass+")"),!de&&h.animation&&(ae.thisAnimationDuration=null),s.captureAnimationState(),de||(h.animation&&(ae.fromRect=c,ce.forEach(function(t){var e;t.thisAnimationDuration=null,t!==ae&&(e=he?k(t):c,t.fromRect=e,s.addAnimationState({target:t,rect:e}))})),ge(),ce.forEach(function(t){f[u]?o.insertBefore(t,f[u]):o.appendChild(t),u++}),a===B(ae)&&(d=!1,ce.forEach(function(t){t.sortableIndex!==B(t)&&(d=!0)}),d&&r("update"))),ce.forEach(function(t){T(t)}),s.animateAll()),re=s),(n===o||l&&"clone"!==l.lastPutMode)&&ue.forEach(function(t){t.parentNode&&t.parentNode.removeChild(t)})}},nullingGlobal:function(){this.isMultiDrag=fe=!1,ue.length=0},destroyGlobal:function(){this._deselectMultiDrag(),f(document,"pointerup",this._deselectMultiDrag),f(document,"mouseup",this._deselectMultiDrag),f(document,"touchend",this._deselectMultiDrag),f(document,"keydown",this._checkKeyDown),f(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(t){if(!(void 0!==fe&&fe||re!==this.sortable||t&&N(t.target,this.options.draggable,this.sortable.el,!1)||t&&0!==t.button))for(;ce.length;){var e=ce[0];I(e,this.options.selectedClass,!1),ce.shift(),W({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:e,originalEvt:t})}},_checkKeyDown:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},a(t,{pluginName:"multiDrag",utils:{select:function(t){var e=t.parentNode[j];e&&e.options.multiDrag&&!~ce.indexOf(t)&&(re&&re!==e&&(re.multiDrag._deselectMultiDrag(),re=e),I(t,e.options.selectedClass,!0),ce.push(t))},deselect:function(t){var e=t.parentNode[j],n=ce.indexOf(t);e&&e.options.multiDrag&&~n&&(I(t,e.options.selectedClass,!1),ce.splice(n,1))}},eventProperties:function(){var n=this,o=[],i=[];return ce.forEach(function(t){var e;o.push({multiDragElement:t,index:t.sortableIndex}),e=he&&t!==ae?-1:he?B(t,":not(."+n.options.selectedClass+")"):B(t),i.push({multiDragElement:t,index:e})}),{items:r(ce),clones:[].concat(ue),oldIndicies:o,newIndicies:i}},optionListeners:{multiDragKey:function(t){return"ctrl"===(t=t.toLowerCase())?t="Control":1<t.length&&(t=t.charAt(0).toUpperCase()+t.substr(1)),t}}})}),Bt});
},{}],2:[function(require,module,exports){
const listModule = require('./list');
const cardModule = require('./card');
const utilsModule = require('./utils');


const app = {
    //Url = adresse donnée par heroku
    baseUrl : 'https://punkyproject-todokanban.herokuapp.com/',
    
    
  
    
    // fonction d'initialisation, lancée au chargement de la page
    init: () => {
        console.log('app.init !');
        app.addListenerToActions();
        listModule.setUrl(app.baseUrl);
        cardModule.setUrl(app.baseUrl);
        listModule.getAllListsFromAPI();


    },
   


    addListenerToActions: () => {

        //Event click sur ajouter une liste
        const addListButton = document.querySelector('#addListButton');
        addListButton.addEventListener('click', () => {
            const addListModal = document.querySelector('#addListModal');
            addListModal.classList.add('is-active');
        });

        //Event pour récupérer la data du formulaire Modal List
        const addListModalForm = document.querySelector('#addListModalForm');
        addListModalForm.addEventListener('submit', listModule.handleAddListForm);
        
        //Action pour récupérer le formulaire Modal Card
        const addCardModalForm = document.querySelector('#addCardModalForm');
        addCardModalForm.addEventListener('submit', cardModule.handleAddCardForm);
        
        //Event pour fermer les modals
        const removeButtonsModal = document.querySelectorAll('.close, .modal-background');
        removeButtonsModal.forEach(button => {
            button.addEventListener('click', utilsModule.hideModals);
        });

    },

   
}; 


// on accroche un écouteur d'évènement sur le document : quand le chargement est terminé, on lance app.init
document.addEventListener('DOMContentLoaded', app.init);
},{"./card":3,"./list":4,"./utils":5}],3:[function(require,module,exports){
const utilsModule = require('./utils');
const Sortable = require('sortablejs');

const cardModule = {
    listModule.getAllListsFromAPI();

    url: null,
    setUrl: (baseUrl) => {
        cardModule.url = baseUrl + 'cards';
    },


    deleteCardToAPI : async (event) => {
        const card = event.target.closest('.box');
        const cardId = card.dataset.cardId;

        try {
            const result = await fetch(`${cardModule.url}/${cardId}`, {
                method : 'DELETE'
            });
            const data = result.json();
            card.remove();
        } catch (error) {
            console.log(error);
        };
    },

    //Ajoute la classe 'is-active' pour afficher le Modal
    showAddCardModal:(event) => {
        const addCardModal = document.querySelector('#addCardModal');
        addCardModal.classList.add('is-active');
        //Récupére l'input hidden du form de la card modal qui doit contenir
        // l'id de la liste
        const hiddenInputId = addCardModal.querySelector('input[name="list_id"]');
        //Récupére l'élément d'ou vient l'event et extraction de son dataset
        const listId = event.target.closest('.panel').dataset.listId;
        //Attribution de listId comme value de l'input
        hiddenInputId.value = listId;
    },

    showEditCardForm : (event) => {
        //Cache le text et affiche le form
        const card = event.target.closest('.box');
        utilsModule.showAndHide(card, '#nameCard', '#editCardForm')

        
        //Custom nom de la card dans le form et select
        const cardName = event.target.closest('.box').querySelector('#nameCard');
        const titleCard = event.target.closest('.box').querySelector('input[name="title"]');
        titleCard.value = cardName.textContent;
        titleCard.select();

        //affichage de la couleur actuelle dans le form
        const div = event.target.closest('.box');
        //récupére la couleur actuelle de la carte
        const color = div.style.backgroundColor;
        //puis on modifie la value de l'input color 
        const colorCard = event.target.closest('.box').querySelector('input[name="color"]');
        colorCard.value = utilsModule.RGBToHex(color)
    
        
    },

    //Récupération des date du form addCard
    handleAddCardForm: async (event) => {
        event.preventDefault();
        
        //lors de la création de la nouvelle carte, on fait évoluer les positions des
        //cartes existantes en incrémendant +1 et PATCH vlistModule.getAllListsFromAPI();
ers l'API
        //récupé l'id de la liste
        const listId = Object.fromEntries(new FormData(event.target)).list_id;
        //récupére d'abord la liste
        const list = document.querySelector(`[data-list-id="${listId}"]`);
        //puis les cartes de la liste
        const cards = list.querySelectorAll('.box');
        cards.forEach( async(card) => {
            const positionId = Number(card.dataset.positionId);
            card.dataset.positionId = positionId + 1;
            const cardId = card.dataset.cardId;
            const formData = new FormData();
            formData.append('position', card.dataset.positionId);
            formData.append('list_id', listId);

            try {
                const result = await fetch(`${cardModule.url}/${cardId}`, {
                    method : 'PATCH',
                    body : formData,
                });
    
                const data = await result.json();
                listModule.getAllListsFromAPI();

            } catch (error) {
                console.log(error);
            };

        });
       
        //création de la nouvelle carte
        const formData = new FormData(event.target);
        formData.append('position', 0);
        // const formObject = Object.fromEntries(formData);
        // console.log(formObject);

        try {
            const result = await fetch(`${cardModule.url}`, {
                method : 'POST',
                body : formData,
            });
            const data = await result.json();

            cardModule.makeCardInDOM(data);
            
        } catch (error) {
            console.log(error);
        };listModule.getAllListsFromAPI();

        
        //Ferme le form
        utilsModule.hideModals();
    },

    //Soumission du form edit card
    handleEditCardForm : async (event) => {
        event.preventDefault();
        const formData = new FormData(event.target);
        // const object = Object.fromEntries(formData);
        const card = event.target.closest('.box');
        const cardId = card.dataset.cardId;

        try {

            const result = await fetch(`${cardModule.url}/${cardId}`, {
                    method : 'PATCH',
                    body : formData,
                });
                
            const data = await result.json();listModule.getAllListsFromAPI();

            //maj du title de la card
            card.querySelector('#nameCard').textContent = data.title;
            card.style.backgroundColor = `${data.color}`;

        } catch (error) {
            console.log(error);
        };
        
        utilsModule.showAndHide(card, '#editCardForm', '#nameCard')
       
    },

     //Création de la nouvelle card
     makeCardInDOM: (object) => {

        //Clone le template
        const card = document.getElementById('cardTemplate').content.firstChild;
        const newCard = card.cloneNode(true);
        //Récupére les données de notre formulaire pour les injecter dans le template
        const nameCard = newCard.querySelector('#nameCard');
        nameCard.textContent = object.title;
        //Récupére l'element pour changer la couleur 
        newCard.style.backgroundColor = `${object.color}`;

        //donne à la carte son id
        newCard.dataset.cardId = object.id;
        //donne la position à la card aussi
        newCard.dataset.positionId = object.position;
        
        //Récupére la liste correspondant à l'id du formulaire
        const listDiv = document.querySelector(`[data-list-id="${object.list_id}"]`);
        //Récupére la div parente ou insérer la carte
        const parentDiv = listDiv.querySelector('.has-background-light')
        parentDiv.insertBefore(newCard, parentDiv.firstChild);
        
        //Event edition des cards (click icone crayon)
        const editCardButton = newCard.querySelector('.editCardButton');
        editCardButton.addEventListener('click', cardModule.showEditCardForm);
        
        
        //Event Click icone poubelle card
        const delCardButton = newCard.querySelector('.delCardButton');
        delCardButton.addEventListener('click', cardModule.deleteCardToAPI)


        // event sur form edit list
        // Validation du form edit card
        const editCardsForm = newCard.querySelector('#editCardForm');
        editCardsForm.addEventListener('submit', cardModule.handleEditCardForm);
        //Appuie ECHAP
        editCardsForm.addEventListener('keydown', (event)=> {
            if (event.code == 'Escape') {

                utilsModule.showAndHide(newCard, '#editCardForm', '#nameCard')
            
            }
        });
        //Appuie autre part
        editCardsForm.addEventListener('click', (event) => {
            event.stopPropagation();
        });

        //essais de sortable
        const el = document.querySelector('.has-background-light');
        const sortable = Sortable.create(el, {  
            group : 'cards',
            dataIdAttr: 'data-card-id',// choisit quel element nous donne un id
            //permet de ne pas drag sur le form et de pouvoir eidter le texte
            filter: '.not-sortable',
            preventOnFilter: false, 
            

            onEnd: async (evt) => {   // event à la fin du drag
                
                const targetGroup = evt.to;
                const originGroup = evt.from;

                let cards = originGroup.querySelectorAll('.box');
                cards.forEach( async (card, position) => {
                    const id = card.dataset.cardId;
                    const formData = new FormData();
                    // on envoie la position au formData
                    formData.append('position', position);
                    try {
                        const result = await fetch(`${cardModule.url}/${id}`, {
                            method : 'PATCH',
                            body : formData,
                        });
                        // pas de maj du front puisque c'est le front qui envoie l'info a l'API
                    } catch (error) {
                        console.log(error);
                    };

                });

                if (originGroup === targetGroup) {
                    return;
                };

                cards = targetGroup.querySelectorAll('.box');
                const list_id = targetGroup.closest('.panel').dataset.listId;
                cards.forEach( async (card, position) => {
                    const id = card.dataset.cardId;
                    const formData = new FormData();
                    formData.append('position',position);
                    formData.append('list_id',list_id);
                    try {
                        const result = await fetch(`${cardModule.url}/${id}`, {
                            method : 'PATCH',
                            body : formData,
                        });
                        // pas de maj du front puisque c'est le front qui envoie l'info a l'API
                    } catch (error) {
                        console.log(error);
                    };
                });
            }
               
        });
    },


}

module.exports = cardModule;
},{"./utils":5,"sortablejs":1}],4:[function(require,module,exports){
const cardModule = require('./card');
const utilsModule = require('./utils');
const Sortable = require('sortablejs');



const listModule = {

    url: null,
    setUrl: (baseUrl) => {
        listModule.url = baseUrl + 'lists';
    },


    getAllListsFromAPI: async () => {
        try {
            const result = await fetch(`${listModule.url}`, {
            method: 'GET',
            });

            const data = await result.json();
       
            for (let list of data) {
                listModule.makeListInDOM(list);
                    for (card of list.cards) {
                        cardModule.makeCardInDOM(card);
                    };
                };
        } catch (error) {
            console.log(error);
        };
    },

    deleteListToAPI : async (event) => {
        const list = event.target.closest('.panel');
        const listId = list.dataset.listId;

        const listName = list.querySelector('h2').textContent;
        if (!window.confirm(`Supprimer la liste ${listName} ?`)) {
            return;
        }
        
        try {
            const result = await fetch(`${listModule.url}/${listId}`, {
                method : 'DELETE'
            });
            const data = await result.json();
            list.remove();
        } catch (error) {
            console.log(error);
        };
    },

    //Ajoute la class 'is-active' pour afficher le Modal
    showAddListModal: () => {
        
        //Récupére l'element du formulaire contenant input hidden
        const hiddenInputId = addListModal.querySelector('input[name="listId"]');
         //Attribution de listId comme value de l'input
    },

    // Open form edit list and close title
    showEditListForm: (event) => {

        //Cache le text et on affiche le form
        const list = event.target.closest('.panel');
        utilsModule.showAndHide(list, 'h2', 'form');

        //Custom nom de la list dans le form et select
        const titleList = event.target.closest('div').querySelector('input[name="name"]');
        titleList.value = event.target.textContent;
        titleList.select();
    },

    //Permet de récupérer les informations du formulaire AddList
    handleAddListForm: async (event) => {
        event.preventDefault();
       
        //lors de la création d'une nouvelle => incrémentation de +1 des positions
        // des listes existantes et avant modif vers l'API
        const lists = document.querySelectorAll('.panel');
        lists.forEach( async(list) => {
            const positionId = Number(list.dataset.positionId);
            list.dataset.positionId = positionId + 1;
            const listId = list.dataset.listId;
            const formData = new FormData();
            formData.append('position', list.dataset.positionId);

            try {
                const result = await fetch(`${listModule.url}/${listId}`, {
                    method : 'PATCH',
                    body : formData,
                });
    
                const data = await result.json();
            
            } catch (error) {
                console.log(error);
            };

        });
       
        //création de la nouvelle liste en position 0
        const formData = new FormData(event.target);
        formData.append('position',0);
        try {
            const result = await fetch(`${listModule.url}`, {
                method : 'POST',
                body : formData,
            });

            const data = await result.json();
            //Crée la liste avec les données
            listModule.makeListInDOM(data);
            
        } catch (error) {
            console.log(error);
        };
        
        //Ferme le form
        utilsModule.hideModals();
        
        
        
    },

    //Soumission du form edit list
    handleEditListForm: async (event) => {
        event.preventDefault();
        const formData = new FormData(event.target);

        const list = event.target.closest('.panel');
        const listId = list.dataset.listId;

        try {
            const result = await fetch(`${listModule.url}/${listId}`, {
                method : 'PATCH',
                body : formData,
            });
            const data = await result.json();
            //maj du titre de la liste
            list.querySelector('h2').textContent = data.name;
        } catch (error) {
            console.log(error);
        };

        utilsModule.showAndHide(list, 'form', 'h2');

    },

    //Création de la nouvelle liste
    makeListInDOM : (data) => {
     
        
        //On clone notre template
        const list = document.getElementById('listTemplate').content.firstChild;
        const newList = list.cloneNode(true);
        //Récupére le name dans le formulmaire pour nommer notre liste
        const nameList = newList.querySelector('h2');
        nameList.textContent = data.name;  
        //Donne l'id a la nouvelle list
        newList.dataset.listId = data.id;
        //donne la position à la liste aussi
        newList.dataset.positionId = data.position;


        //Insére et affiche notre nouvelle liste
        const parentDiv = document.querySelector('.card-lists');
        parentDiv.insertBefore(newList, parentDiv.firstChild);

        
        //event sur le bouton plus pour ajouter une card
        const addCardModal = document.querySelector('.is-pulled-left');
        addCardModal.addEventListener('click', cardModule.showAddCardModal);
        //event double click sur le nom pour éditer les listes
        nameList.addEventListener('dblclick', listModule.showEditListForm);
        // event sur form edit list
        //Validation du form
        const editListsForm = document.querySelector('#editListForm');
        editListsForm.addEventListener('submit', listModule.handleEditListForm);
        //Appuie ECHAP
        editListsForm.addEventListener('keydown', (event)=> {
            if (event.code == 'Escape') {

                utilsModule.showAndHide(newList, 'form', 'h2');
              
            }
        });
        //Appuie autre part
        editListsForm.addEventListener('click', (event) => {
            event.stopPropagation();
        });

        //event click delete button list
        const delListButton = document.querySelector('.delListButton');
        delListButton.addEventListener('click', listModule.deleteListToAPI);

        //sortable
        const el = document.querySelector('.card-lists');
        const sortable = Sortable.create(el, {
            draggable : '.panel',    //utile ? je sais pas ^^
            chosenClass: "sortable-chosen",  // Permet de donner une classe a l'élément choisit et modif le css après
            dataIdAttr: 'data-list-id', // choisit quel element nous donne un id
            //permet de ne pas drag sur le form et de pouvoir eidter le texte
            filter: '.not-sortable',
            preventOnFilter: false, 

            onEnd: async (evt) => {   // event à la fin du drag
                sortable.toArray().forEach( async (id, position) => {  
                    // récupére l'odre sous forme de tableau qu'on boucle
                    const formData = new FormData();        // on construit un formData
                    formData.append('position', position)
                    try {
                        const result = await fetch(`${listModule.url}/${id}`, {
                            method : 'PATCH',
                            body : formData,
                        });
                        // pas de maj du front puisque c'est le front qui envoie l'info a l'API
                    } catch (error) {
                        console.log(error);
                    };
            
                })
            },
        })


    },


}

module.exports = listModule;
},{"./card":3,"./utils":5,"sortablejs":1}],5:[function(require,module,exports){

const utilsModule = {

    //Remove la class 'is-active' pour hide le Modal
    hideModals: () => {
        const allModals = document.querySelectorAll('.modal');
        allModals.forEach(modal => {
            modal.classList.remove('is-active');
        });
    },
    //fonction qui gére de cacher et faire apparaitre les formulaires
    showAndHide: (parent, classToHide, classToShow) => {
        parent.querySelector(classToHide).classList.add('is-hidden');
        parent.querySelector(classToShow).classList.remove('is-hidden');
    },

    // fonction pour transformer une couleur rgb en hex
    RGBToHex :(rgb) => {
        // Choose correct separator
        let sep = rgb.indexOf(",") > -1 ? "," : " ";
        // Turn "rgb(r,g,b)" into [r,g,b]
        rgb = rgb.substr(4).split(")")[0].split(sep);
      
        let r = (+rgb[0]).toString(16),
            g = (+rgb[1]).toString(16),
            b = (+rgb[2]).toString(16);
      
        if (r.length == 1)
          r = "0" + r;
        if (g.length == 1)
          g = "0" + g;
        if (b.length == 1)
          b = "0" + b;
      
        return "#" + r + g + b;
    
    },

}

module.exports = utilsModule;
},{}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvc29ydGFibGVqcy9Tb3J0YWJsZS5taW4uanMiLCJzcmMvYXBwLmpzIiwic3JjL2NhcmQuanMiLCJzcmMvbGlzdC5qcyIsInNyYy91dGlscy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25RQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiLyohIFNvcnRhYmxlIDEuMTQuMCAtIE1JVCB8IGdpdDovL2dpdGh1Yi5jb20vU29ydGFibGVKUy9Tb3J0YWJsZS5naXQgKi9cbiFmdW5jdGlvbih0LGUpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPWUoKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKGUpOih0PXR8fHNlbGYpLlNvcnRhYmxlPWUoKX0odGhpcyxmdW5jdGlvbigpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGUoZSx0KXt2YXIgbixvPU9iamVjdC5rZXlzKGUpO3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzJiYobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpLHQmJihuPW4uZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSxvLnB1c2guYXBwbHkobyxuKSksb31mdW5jdGlvbiBBKG8pe2Zvcih2YXIgdD0xO3Q8YXJndW1lbnRzLmxlbmd0aDt0Kyspe3ZhciBpPW51bGwhPWFyZ3VtZW50c1t0XT9hcmd1bWVudHNbdF06e307dCUyP2UoT2JqZWN0KGkpLCEwKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlLG47ZT1vLHQ9aVtuPXRdLG4gaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSxuLHt2YWx1ZTp0LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVtuXT10fSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMobyxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhpKSk6ZShPYmplY3QoaSkpLmZvckVhY2goZnVuY3Rpb24odCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KG8sdCxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGksdCkpfSl9cmV0dXJuIG99ZnVuY3Rpb24gbyh0KXtyZXR1cm4obz1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJlwic3ltYm9sXCI9PXR5cGVvZiBTeW1ib2wuaXRlcmF0b3I/ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZ0LmNvbnN0cnVjdG9yPT09U3ltYm9sJiZ0IT09U3ltYm9sLnByb3RvdHlwZT9cInN5bWJvbFwiOnR5cGVvZiB0fSkodCl9ZnVuY3Rpb24gYSgpe3JldHVybihhPU9iamVjdC5hc3NpZ258fGZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0xO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspe3ZhciBuLG89YXJndW1lbnRzW2VdO2ZvcihuIGluIG8pT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sbikmJih0W25dPW9bbl0pfXJldHVybiB0fSkuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIGkodCxlKXtpZihudWxsPT10KXJldHVybnt9O3ZhciBuLG89ZnVuY3Rpb24odCxlKXtpZihudWxsPT10KXJldHVybnt9O2Zvcih2YXIgbixvPXt9LGk9T2JqZWN0LmtleXModCkscj0wO3I8aS5sZW5ndGg7cisrKW49aVtyXSwwPD1lLmluZGV4T2Yobil8fChvW25dPXRbbl0pO3JldHVybiBvfSh0LGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpZm9yKHZhciBpPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHModCkscj0wO3I8aS5sZW5ndGg7cisrKW49aVtyXSwwPD1lLmluZGV4T2Yobil8fE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbCh0LG4pJiYob1tuXT10W25dKTtyZXR1cm4gb31mdW5jdGlvbiByKHQpe3JldHVybiBmdW5jdGlvbih0KXtpZihBcnJheS5pc0FycmF5KHQpKXJldHVybiBsKHQpfSh0KXx8ZnVuY3Rpb24odCl7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIFN5bWJvbCYmbnVsbCE9dFtTeW1ib2wuaXRlcmF0b3JdfHxudWxsIT10W1wiQEBpdGVyYXRvclwiXSlyZXR1cm4gQXJyYXkuZnJvbSh0KX0odCl8fGZ1bmN0aW9uKHQsZSl7aWYodCl7aWYoXCJzdHJpbmdcIj09dHlwZW9mIHQpcmV0dXJuIGwodCxlKTt2YXIgbj1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCkuc2xpY2UoOCwtMSk7cmV0dXJuXCJNYXBcIj09PShuPVwiT2JqZWN0XCI9PT1uJiZ0LmNvbnN0cnVjdG9yP3QuY29uc3RydWN0b3IubmFtZTpuKXx8XCJTZXRcIj09PW4/QXJyYXkuZnJvbSh0KTpcIkFyZ3VtZW50c1wiPT09bnx8L14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3Qobik/bCh0LGUpOnZvaWQgMH19KHQpfHxmdW5jdGlvbigpe3Rocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpfSgpfWZ1bmN0aW9uIGwodCxlKXsobnVsbD09ZXx8ZT50Lmxlbmd0aCkmJihlPXQubGVuZ3RoKTtmb3IodmFyIG49MCxvPW5ldyBBcnJheShlKTtuPGU7bisrKW9bbl09dFtuXTtyZXR1cm4gb31mdW5jdGlvbiB0KHQpe2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5uYXZpZ2F0b3IpcmV0dXJuISFuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKHQpfXZhciB5PXQoLyg/OlRyaWRlbnQuKnJ2WyA6XT8xMVxcLnxtc2llfGllbW9iaWxlfFdpbmRvd3MgUGhvbmUpL2kpLHc9dCgvRWRnZS9pKSxzPXQoL2ZpcmVmb3gvaSksdT10KC9zYWZhcmkvaSkmJiF0KC9jaHJvbWUvaSkmJiF0KC9hbmRyb2lkL2kpLG49dCgvaVAoYWR8b2R8aG9uZSkvaSksYz10KC9jaHJvbWUvaSkmJnQoL2FuZHJvaWQvaSksZD17Y2FwdHVyZTohMSxwYXNzaXZlOiExfTtmdW5jdGlvbiBoKHQsZSxuKXt0LmFkZEV2ZW50TGlzdGVuZXIoZSxuLCF5JiZkKX1mdW5jdGlvbiBmKHQsZSxuKXt0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxuLCF5JiZkKX1mdW5jdGlvbiBwKHQsZSl7aWYoZSYmKFwiPlwiPT09ZVswXSYmKGU9ZS5zdWJzdHJpbmcoMSkpLHQpKXRyeXtpZih0Lm1hdGNoZXMpcmV0dXJuIHQubWF0Y2hlcyhlKTtpZih0Lm1zTWF0Y2hlc1NlbGVjdG9yKXJldHVybiB0Lm1zTWF0Y2hlc1NlbGVjdG9yKGUpO2lmKHQud2Via2l0TWF0Y2hlc1NlbGVjdG9yKXJldHVybiB0LndlYmtpdE1hdGNoZXNTZWxlY3RvcihlKX1jYXRjaCh0KXtyZXR1cm59fWZ1bmN0aW9uIE4odCxlLG4sbyl7aWYodCl7bj1ufHxkb2N1bWVudDtkb3tpZihudWxsIT1lJiYoXCI+XCIhPT1lWzBdfHx0LnBhcmVudE5vZGU9PT1uKSYmcCh0LGUpfHxvJiZ0PT09bilyZXR1cm4gdH13aGlsZSh0IT09biYmKHQ9KGk9dCkuaG9zdCYmaSE9PWRvY3VtZW50JiZpLmhvc3Qubm9kZVR5cGU/aS5ob3N0OmkucGFyZW50Tm9kZSkpfXZhciBpO3JldHVybiBudWxsfXZhciBnLG09L1xccysvZztmdW5jdGlvbiBJKHQsZSxuKXt2YXIgbzt0JiZlJiYodC5jbGFzc0xpc3Q/dC5jbGFzc0xpc3Rbbj9cImFkZFwiOlwicmVtb3ZlXCJdKGUpOihvPShcIiBcIit0LmNsYXNzTmFtZStcIiBcIikucmVwbGFjZShtLFwiIFwiKS5yZXBsYWNlKFwiIFwiK2UrXCIgXCIsXCIgXCIpLHQuY2xhc3NOYW1lPShvKyhuP1wiIFwiK2U6XCJcIikpLnJlcGxhY2UobSxcIiBcIikpKX1mdW5jdGlvbiBQKHQsZSxuKXt2YXIgbz10JiZ0LnN0eWxlO2lmKG8pe2lmKHZvaWQgMD09PW4pcmV0dXJuIGRvY3VtZW50LmRlZmF1bHRWaWV3JiZkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlP249ZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZSh0LFwiXCIpOnQuY3VycmVudFN0eWxlJiYobj10LmN1cnJlbnRTdHlsZSksdm9pZCAwPT09ZT9uOm5bZV07b1tlPSEoZSBpbiBvfHwtMSE9PWUuaW5kZXhPZihcIndlYmtpdFwiKSk/XCItd2Via2l0LVwiK2U6ZV09bisoXCJzdHJpbmdcIj09dHlwZW9mIG4/XCJcIjpcInB4XCIpfX1mdW5jdGlvbiB2KHQsZSl7dmFyIG49XCJcIjtpZihcInN0cmluZ1wiPT10eXBlb2YgdCluPXQ7ZWxzZSBkb3t2YXIgbz1QKHQsXCJ0cmFuc2Zvcm1cIil9d2hpbGUobyYmXCJub25lXCIhPT1vJiYobj1vK1wiIFwiK24pLCFlJiYodD10LnBhcmVudE5vZGUpKTt2YXIgaT13aW5kb3cuRE9NTWF0cml4fHx3aW5kb3cuV2ViS2l0Q1NTTWF0cml4fHx3aW5kb3cuQ1NTTWF0cml4fHx3aW5kb3cuTVNDU1NNYXRyaXg7cmV0dXJuIGkmJm5ldyBpKG4pfWZ1bmN0aW9uIGIodCxlLG4pe2lmKHQpe3ZhciBvPXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZSksaT0wLHI9by5sZW5ndGg7aWYobilmb3IoO2k8cjtpKyspbihvW2ldLGkpO3JldHVybiBvfXJldHVybltdfWZ1bmN0aW9uIE8oKXt2YXIgdD1kb2N1bWVudC5zY3JvbGxpbmdFbGVtZW50O3JldHVybiB0fHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnR9ZnVuY3Rpb24gayh0LGUsbixvLGkpe2lmKHQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0fHx0PT09d2luZG93KXt2YXIgcixhLGwscyxjLHUsZD10IT09d2luZG93JiZ0LnBhcmVudE5vZGUmJnQhPT1PKCk/KGE9KHI9dC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSkudG9wLGw9ci5sZWZ0LHM9ci5ib3R0b20sYz1yLnJpZ2h0LHU9ci5oZWlnaHQsci53aWR0aCk6KGw9YT0wLHM9d2luZG93LmlubmVySGVpZ2h0LGM9d2luZG93LmlubmVyV2lkdGgsdT13aW5kb3cuaW5uZXJIZWlnaHQsd2luZG93LmlubmVyV2lkdGgpO2lmKChlfHxuKSYmdCE9PXdpbmRvdyYmKGk9aXx8dC5wYXJlbnROb2RlLCF5KSlkb3tpZihpJiZpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCYmKFwibm9uZVwiIT09UChpLFwidHJhbnNmb3JtXCIpfHxuJiZcInN0YXRpY1wiIT09UChpLFwicG9zaXRpb25cIikpKXt2YXIgaD1pLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO2EtPWgudG9wK3BhcnNlSW50KFAoaSxcImJvcmRlci10b3Atd2lkdGhcIikpLGwtPWgubGVmdCtwYXJzZUludChQKGksXCJib3JkZXItbGVmdC13aWR0aFwiKSkscz1hK3IuaGVpZ2h0LGM9bCtyLndpZHRoO2JyZWFrfX13aGlsZShpPWkucGFyZW50Tm9kZSk7cmV0dXJuIG8mJnQhPT13aW5kb3cmJihvPShlPXYoaXx8dCkpJiZlLmEsdD1lJiZlLmQsZSYmKHM9KGEvPXQpKyh1Lz10KSxjPShsLz1vKSsoZC89bykpKSx7dG9wOmEsbGVmdDpsLGJvdHRvbTpzLHJpZ2h0OmMsd2lkdGg6ZCxoZWlnaHQ6dX19fWZ1bmN0aW9uIFIodCxlLG4pe2Zvcih2YXIgbz1NKHQsITApLGk9ayh0KVtlXTtvOyl7dmFyIHI9ayhvKVtuXTtpZighKFwidG9wXCI9PT1ufHxcImxlZnRcIj09PW4/cjw9aTppPD1yKSlyZXR1cm4gbztpZihvPT09TygpKWJyZWFrO289TShvLCExKX1yZXR1cm4hMX1mdW5jdGlvbiBYKHQsZSxuLG8pe2Zvcih2YXIgaT0wLHI9MCxhPXQuY2hpbGRyZW47cjxhLmxlbmd0aDspe2lmKFwibm9uZVwiIT09YVtyXS5zdHlsZS5kaXNwbGF5JiZhW3JdIT09QnQuZ2hvc3QmJihvfHxhW3JdIT09QnQuZHJhZ2dlZCkmJk4oYVtyXSxuLmRyYWdnYWJsZSx0LCExKSl7aWYoaT09PWUpcmV0dXJuIGFbcl07aSsrfXIrK31yZXR1cm4gbnVsbH1mdW5jdGlvbiBZKHQsZSl7Zm9yKHZhciBuPXQubGFzdEVsZW1lbnRDaGlsZDtuJiYobj09PUJ0Lmdob3N0fHxcIm5vbmVcIj09PVAobixcImRpc3BsYXlcIil8fGUmJiFwKG4sZSkpOyluPW4ucHJldmlvdXNFbGVtZW50U2libGluZztyZXR1cm4gbnx8bnVsbH1mdW5jdGlvbiBCKHQsZSl7dmFyIG49MDtpZighdHx8IXQucGFyZW50Tm9kZSlyZXR1cm4tMTtmb3IoO3Q9dC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nOylcIlRFTVBMQVRFXCI9PT10Lm5vZGVOYW1lLnRvVXBwZXJDYXNlKCl8fHQ9PT1CdC5jbG9uZXx8ZSYmIXAodCxlKXx8bisrO3JldHVybiBufWZ1bmN0aW9uIEUodCl7dmFyIGU9MCxuPTAsbz1PKCk7aWYodClkb3t2YXIgaT12KHQpLHI9aS5hLGk9aS5kfXdoaWxlKGUrPXQuc2Nyb2xsTGVmdCpyLG4rPXQuc2Nyb2xsVG9wKmksdCE9PW8mJih0PXQucGFyZW50Tm9kZSkpO3JldHVybltlLG5dfWZ1bmN0aW9uIE0odCxlKXtpZighdHx8IXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KXJldHVybiBPKCk7dmFyIG49dCxvPSExO2Rve2lmKG4uY2xpZW50V2lkdGg8bi5zY3JvbGxXaWR0aHx8bi5jbGllbnRIZWlnaHQ8bi5zY3JvbGxIZWlnaHQpe3ZhciBpPVAobik7aWYobi5jbGllbnRXaWR0aDxuLnNjcm9sbFdpZHRoJiYoXCJhdXRvXCI9PWkub3ZlcmZsb3dYfHxcInNjcm9sbFwiPT1pLm92ZXJmbG93WCl8fG4uY2xpZW50SGVpZ2h0PG4uc2Nyb2xsSGVpZ2h0JiYoXCJhdXRvXCI9PWkub3ZlcmZsb3dZfHxcInNjcm9sbFwiPT1pLm92ZXJmbG93WSkpe2lmKCFuLmdldEJvdW5kaW5nQ2xpZW50UmVjdHx8bj09PWRvY3VtZW50LmJvZHkpcmV0dXJuIE8oKTtpZihvfHxlKXJldHVybiBuO289ITB9fX13aGlsZShuPW4ucGFyZW50Tm9kZSk7cmV0dXJuIE8oKX1mdW5jdGlvbiBEKHQsZSl7cmV0dXJuIE1hdGgucm91bmQodC50b3ApPT09TWF0aC5yb3VuZChlLnRvcCkmJk1hdGgucm91bmQodC5sZWZ0KT09PU1hdGgucm91bmQoZS5sZWZ0KSYmTWF0aC5yb3VuZCh0LmhlaWdodCk9PT1NYXRoLnJvdW5kKGUuaGVpZ2h0KSYmTWF0aC5yb3VuZCh0LndpZHRoKT09PU1hdGgucm91bmQoZS53aWR0aCl9ZnVuY3Rpb24gUyhlLG4pe3JldHVybiBmdW5jdGlvbigpe3ZhciB0O2d8fCgxPT09KHQ9YXJndW1lbnRzKS5sZW5ndGg/ZS5jYWxsKHRoaXMsdFswXSk6ZS5hcHBseSh0aGlzLHQpLGc9c2V0VGltZW91dChmdW5jdGlvbigpe2c9dm9pZCAwfSxuKSl9fWZ1bmN0aW9uIEYodCxlLG4pe3Quc2Nyb2xsTGVmdCs9ZSx0LnNjcm9sbFRvcCs9bn1mdW5jdGlvbiBfKHQpe3ZhciBlPXdpbmRvdy5Qb2x5bWVyLG49d2luZG93LmpRdWVyeXx8d2luZG93LlplcHRvO3JldHVybiBlJiZlLmRvbT9lLmRvbSh0KS5jbG9uZU5vZGUoITApOm4/bih0KS5jbG9uZSghMClbMF06dC5jbG9uZU5vZGUoITApfWZ1bmN0aW9uIEModCxlKXtQKHQsXCJwb3NpdGlvblwiLFwiYWJzb2x1dGVcIiksUCh0LFwidG9wXCIsZS50b3ApLFAodCxcImxlZnRcIixlLmxlZnQpLFAodCxcIndpZHRoXCIsZS53aWR0aCksUCh0LFwiaGVpZ2h0XCIsZS5oZWlnaHQpfWZ1bmN0aW9uIFQodCl7UCh0LFwicG9zaXRpb25cIixcIlwiKSxQKHQsXCJ0b3BcIixcIlwiKSxQKHQsXCJsZWZ0XCIsXCJcIiksUCh0LFwid2lkdGhcIixcIlwiKSxQKHQsXCJoZWlnaHRcIixcIlwiKX12YXIgaj1cIlNvcnRhYmxlXCIrKG5ldyBEYXRlKS5nZXRUaW1lKCk7ZnVuY3Rpb24geCgpe3ZhciBlLG89W107cmV0dXJue2NhcHR1cmVBbmltYXRpb25TdGF0ZTpmdW5jdGlvbigpe289W10sdGhpcy5vcHRpb25zLmFuaW1hdGlvbiYmW10uc2xpY2UuY2FsbCh0aGlzLmVsLmNoaWxkcmVuKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlLG47XCJub25lXCIhPT1QKHQsXCJkaXNwbGF5XCIpJiZ0IT09QnQuZ2hvc3QmJihvLnB1c2goe3RhcmdldDp0LHJlY3Q6ayh0KX0pLGU9QSh7fSxvW28ubGVuZ3RoLTFdLnJlY3QpLCF0LnRoaXNBbmltYXRpb25EdXJhdGlvbnx8KG49dih0LCEwKSkmJihlLnRvcC09bi5mLGUubGVmdC09bi5lKSx0LmZyb21SZWN0PWUpfSl9LGFkZEFuaW1hdGlvblN0YXRlOmZ1bmN0aW9uKHQpe28ucHVzaCh0KX0scmVtb3ZlQW5pbWF0aW9uU3RhdGU6ZnVuY3Rpb24odCl7by5zcGxpY2UoZnVuY3Rpb24odCxlKXtmb3IodmFyIG4gaW4gdClpZih0Lmhhc093blByb3BlcnR5KG4pKWZvcih2YXIgbyBpbiBlKWlmKGUuaGFzT3duUHJvcGVydHkobykmJmVbb109PT10W25dW29dKXJldHVybiBOdW1iZXIobik7cmV0dXJuLTF9KG8se3RhcmdldDp0fSksMSl9LGFuaW1hdGVBbGw6ZnVuY3Rpb24odCl7dmFyIGM9dGhpcztpZighdGhpcy5vcHRpb25zLmFuaW1hdGlvbilyZXR1cm4gY2xlYXJUaW1lb3V0KGUpLHZvaWQoXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdCgpKTt2YXIgdT0hMSxkPTA7by5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlPTAsbj10LnRhcmdldCxvPW4uZnJvbVJlY3QsaT1rKG4pLHI9bi5wcmV2RnJvbVJlY3QsYT1uLnByZXZUb1JlY3QsbD10LnJlY3Qscz12KG4sITApO3MmJihpLnRvcC09cy5mLGkubGVmdC09cy5lKSxuLnRvUmVjdD1pLG4udGhpc0FuaW1hdGlvbkR1cmF0aW9uJiZEKHIsaSkmJiFEKG8saSkmJihsLnRvcC1pLnRvcCkvKGwubGVmdC1pLmxlZnQpPT0oby50b3AtaS50b3ApLyhvLmxlZnQtaS5sZWZ0KSYmKHQ9bCxzPXIscj1hLGE9Yy5vcHRpb25zLGU9TWF0aC5zcXJ0KE1hdGgucG93KHMudG9wLXQudG9wLDIpK01hdGgucG93KHMubGVmdC10LmxlZnQsMikpL01hdGguc3FydChNYXRoLnBvdyhzLnRvcC1yLnRvcCwyKStNYXRoLnBvdyhzLmxlZnQtci5sZWZ0LDIpKSphLmFuaW1hdGlvbiksRChpLG8pfHwobi5wcmV2RnJvbVJlY3Q9byxuLnByZXZUb1JlY3Q9aSxlPWV8fGMub3B0aW9ucy5hbmltYXRpb24sYy5hbmltYXRlKG4sbCxpLGUpKSxlJiYodT0hMCxkPU1hdGgubWF4KGQsZSksY2xlYXJUaW1lb3V0KG4uYW5pbWF0aW9uUmVzZXRUaW1lciksbi5hbmltYXRpb25SZXNldFRpbWVyPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtuLmFuaW1hdGlvblRpbWU9MCxuLnByZXZGcm9tUmVjdD1udWxsLG4uZnJvbVJlY3Q9bnVsbCxuLnByZXZUb1JlY3Q9bnVsbCxuLnRoaXNBbmltYXRpb25EdXJhdGlvbj1udWxsfSxlKSxuLnRoaXNBbmltYXRpb25EdXJhdGlvbj1lKX0pLGNsZWFyVGltZW91dChlKSx1P2U9c2V0VGltZW91dChmdW5jdGlvbigpe1wiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQoKX0sZCk6XCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdCgpLG89W119LGFuaW1hdGU6ZnVuY3Rpb24odCxlLG4sbyl7dmFyIGkscjtvJiYoUCh0LFwidHJhbnNpdGlvblwiLFwiXCIpLFAodCxcInRyYW5zZm9ybVwiLFwiXCIpLGk9KHI9dih0aGlzLmVsKSkmJnIuYSxyPXImJnIuZCxpPShlLmxlZnQtbi5sZWZ0KS8oaXx8MSkscj0oZS50b3Atbi50b3ApLyhyfHwxKSx0LmFuaW1hdGluZ1g9ISFpLHQuYW5pbWF0aW5nWT0hIXIsUCh0LFwidHJhbnNmb3JtXCIsXCJ0cmFuc2xhdGUzZChcIitpK1wicHgsXCIrcitcInB4LDApXCIpLHRoaXMuZm9yUmVwYWludER1bW15PXQub2Zmc2V0V2lkdGgsUCh0LFwidHJhbnNpdGlvblwiLFwidHJhbnNmb3JtIFwiK28rXCJtc1wiKyh0aGlzLm9wdGlvbnMuZWFzaW5nP1wiIFwiK3RoaXMub3B0aW9ucy5lYXNpbmc6XCJcIikpLFAodCxcInRyYW5zZm9ybVwiLFwidHJhbnNsYXRlM2QoMCwwLDApXCIpLFwibnVtYmVyXCI9PXR5cGVvZiB0LmFuaW1hdGVkJiZjbGVhclRpbWVvdXQodC5hbmltYXRlZCksdC5hbmltYXRlZD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7UCh0LFwidHJhbnNpdGlvblwiLFwiXCIpLFAodCxcInRyYW5zZm9ybVwiLFwiXCIpLHQuYW5pbWF0ZWQ9ITEsdC5hbmltYXRpbmdYPSExLHQuYW5pbWF0aW5nWT0hMX0sbykpfX19dmFyIEg9W10sTD17aW5pdGlhbGl6ZUJ5RGVmYXVsdDohMH0sSz17bW91bnQ6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIEwpIUwuaGFzT3duUHJvcGVydHkodCl8fHQgaW4gZXx8KGVbdF09TFt0XSk7SC5mb3JFYWNoKGZ1bmN0aW9uKHQpe2lmKHQucGx1Z2luTmFtZT09PWUucGx1Z2luTmFtZSl0aHJvd1wiU29ydGFibGU6IENhbm5vdCBtb3VudCBwbHVnaW4gXCIuY29uY2F0KGUucGx1Z2luTmFtZSxcIiBtb3JlIHRoYW4gb25jZVwiKX0pLEgucHVzaChlKX0scGx1Z2luRXZlbnQ6ZnVuY3Rpb24oZSxuLG8pe3ZhciB0PXRoaXM7dGhpcy5ldmVudENhbmNlbGVkPSExLG8uY2FuY2VsPWZ1bmN0aW9uKCl7dC5ldmVudENhbmNlbGVkPSEwfTt2YXIgaT1lK1wiR2xvYmFsXCI7SC5mb3JFYWNoKGZ1bmN0aW9uKHQpe25bdC5wbHVnaW5OYW1lXSYmKG5bdC5wbHVnaW5OYW1lXVtpXSYmblt0LnBsdWdpbk5hbWVdW2ldKEEoe3NvcnRhYmxlOm59LG8pKSxuLm9wdGlvbnNbdC5wbHVnaW5OYW1lXSYmblt0LnBsdWdpbk5hbWVdW2VdJiZuW3QucGx1Z2luTmFtZV1bZV0oQSh7c29ydGFibGU6bn0sbykpKX0pfSxpbml0aWFsaXplUGx1Z2luczpmdW5jdGlvbihuLG8saSx0KXtmb3IodmFyIGUgaW4gSC5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlPXQucGx1Z2luTmFtZTsobi5vcHRpb25zW2VdfHx0LmluaXRpYWxpemVCeURlZmF1bHQpJiYoKHQ9bmV3IHQobixvLG4ub3B0aW9ucykpLnNvcnRhYmxlPW4sdC5vcHRpb25zPW4ub3B0aW9ucyxuW2VdPXQsYShpLHQuZGVmYXVsdHMpKX0pLG4ub3B0aW9ucyl7dmFyIHI7bi5vcHRpb25zLmhhc093blByb3BlcnR5KGUpJiYodm9pZCAwIT09KHI9dGhpcy5tb2RpZnlPcHRpb24obixlLG4ub3B0aW9uc1tlXSkpJiYobi5vcHRpb25zW2VdPXIpKX19LGdldEV2ZW50UHJvcGVydGllczpmdW5jdGlvbihlLG4pe3ZhciBvPXt9O3JldHVybiBILmZvckVhY2goZnVuY3Rpb24odCl7XCJmdW5jdGlvblwiPT10eXBlb2YgdC5ldmVudFByb3BlcnRpZXMmJmEobyx0LmV2ZW50UHJvcGVydGllcy5jYWxsKG5bdC5wbHVnaW5OYW1lXSxlKSl9KSxvfSxtb2RpZnlPcHRpb246ZnVuY3Rpb24oZSxuLG8pe3ZhciBpO3JldHVybiBILmZvckVhY2goZnVuY3Rpb24odCl7ZVt0LnBsdWdpbk5hbWVdJiZ0Lm9wdGlvbkxpc3RlbmVycyYmXCJmdW5jdGlvblwiPT10eXBlb2YgdC5vcHRpb25MaXN0ZW5lcnNbbl0mJihpPXQub3B0aW9uTGlzdGVuZXJzW25dLmNhbGwoZVt0LnBsdWdpbk5hbWVdLG8pKX0pLGl9fTtmdW5jdGlvbiBXKHQpe3ZhciBlPXQuc29ydGFibGUsbj10LnJvb3RFbCxvPXQubmFtZSxpPXQudGFyZ2V0RWwscj10LmNsb25lRWwsYT10LnRvRWwsbD10LmZyb21FbCxzPXQub2xkSW5kZXgsYz10Lm5ld0luZGV4LHU9dC5vbGREcmFnZ2FibGVJbmRleCxkPXQubmV3RHJhZ2dhYmxlSW5kZXgsaD10Lm9yaWdpbmFsRXZlbnQsZj10LnB1dFNvcnRhYmxlLHA9dC5leHRyYUV2ZW50UHJvcGVydGllcztpZihlPWV8fG4mJm5bal0pe3ZhciBnLG09ZS5vcHRpb25zLHQ9XCJvblwiK28uY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrby5zdWJzdHIoMSk7IXdpbmRvdy5DdXN0b21FdmVudHx8eXx8dz8oZz1kb2N1bWVudC5jcmVhdGVFdmVudChcIkV2ZW50XCIpKS5pbml0RXZlbnQobywhMCwhMCk6Zz1uZXcgQ3VzdG9tRXZlbnQobyx7YnViYmxlczohMCxjYW5jZWxhYmxlOiEwfSksZy50bz1hfHxuLGcuZnJvbT1sfHxuLGcuaXRlbT1pfHxuLGcuY2xvbmU9cixnLm9sZEluZGV4PXMsZy5uZXdJbmRleD1jLGcub2xkRHJhZ2dhYmxlSW5kZXg9dSxnLm5ld0RyYWdnYWJsZUluZGV4PWQsZy5vcmlnaW5hbEV2ZW50PWgsZy5wdWxsTW9kZT1mP2YubGFzdFB1dE1vZGU6dm9pZCAwO3ZhciB2LGI9QShBKHt9LHApLEsuZ2V0RXZlbnRQcm9wZXJ0aWVzKG8sZSkpO2Zvcih2IGluIGIpZ1t2XT1iW3ZdO24mJm4uZGlzcGF0Y2hFdmVudChnKSxtW3RdJiZtW3RdLmNhbGwoZSxnKX19ZnVuY3Rpb24geih0LGUpe3ZhciBuPShvPTI8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXTp7fSkuZXZ0LG89aShvLEcpO0sucGx1Z2luRXZlbnQuYmluZChCdCkodCxlLEEoe2RyYWdFbDpxLHBhcmVudEVsOlYsZ2hvc3RFbDpaLHJvb3RFbDokLG5leHRFbDpRLGxhc3REb3duRWw6SixjbG9uZUVsOnR0LGNsb25lSGlkZGVuOmV0LGRyYWdTdGFydGVkOnB0LHB1dFNvcnRhYmxlOmx0LGFjdGl2ZVNvcnRhYmxlOkJ0LmFjdGl2ZSxvcmlnaW5hbEV2ZW50Om4sb2xkSW5kZXg6bnQsb2xkRHJhZ2dhYmxlSW5kZXg6aXQsbmV3SW5kZXg6b3QsbmV3RHJhZ2dhYmxlSW5kZXg6cnQsaGlkZUdob3N0Rm9yVGFyZ2V0Omt0LHVuaGlkZUdob3N0Rm9yVGFyZ2V0OlJ0LGNsb25lTm93SGlkZGVuOmZ1bmN0aW9uKCl7ZXQ9ITB9LGNsb25lTm93U2hvd246ZnVuY3Rpb24oKXtldD0hMX0sZGlzcGF0Y2hTb3J0YWJsZUV2ZW50OmZ1bmN0aW9uKHQpe1Uoe3NvcnRhYmxlOmUsbmFtZTp0LG9yaWdpbmFsRXZlbnQ6bn0pfX0sbykpfXZhciBHPVtcImV2dFwiXTtmdW5jdGlvbiBVKHQpe1coQSh7cHV0U29ydGFibGU6bHQsY2xvbmVFbDp0dCx0YXJnZXRFbDpxLHJvb3RFbDokLG9sZEluZGV4Om50LG9sZERyYWdnYWJsZUluZGV4Oml0LG5ld0luZGV4Om90LG5ld0RyYWdnYWJsZUluZGV4OnJ0fSx0KSl9dmFyIHEsVixaLCQsUSxKLHR0LGV0LG50LG90LGl0LHJ0LGF0LGx0LHN0LGN0LHV0LGR0LGh0LGZ0LHB0LGd0LG10LHZ0LGJ0LHl0PSExLHd0PSExLEV0PVtdLER0PSExLFN0PSExLF90PVtdLEN0PSExLFR0PVtdLHh0PVwidW5kZWZpbmVkXCIhPXR5cGVvZiBkb2N1bWVudCxPdD1uLE10PXd8fHk/XCJjc3NGbG9hdFwiOlwiZmxvYXRcIixBdD14dCYmIWMmJiFuJiZcImRyYWdnYWJsZVwiaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxOdD1mdW5jdGlvbigpe2lmKHh0KXtpZih5KXJldHVybiExO3ZhciB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ4XCIpO3JldHVybiB0LnN0eWxlLmNzc1RleHQ9XCJwb2ludGVyLWV2ZW50czphdXRvXCIsXCJhdXRvXCI9PT10LnN0eWxlLnBvaW50ZXJFdmVudHN9fSgpLEl0PWZ1bmN0aW9uKHQsZSl7dmFyIG49UCh0KSxvPXBhcnNlSW50KG4ud2lkdGgpLXBhcnNlSW50KG4ucGFkZGluZ0xlZnQpLXBhcnNlSW50KG4ucGFkZGluZ1JpZ2h0KS1wYXJzZUludChuLmJvcmRlckxlZnRXaWR0aCktcGFyc2VJbnQobi5ib3JkZXJSaWdodFdpZHRoKSxpPVgodCwwLGUpLHI9WCh0LDEsZSksYT1pJiZQKGkpLGw9ciYmUChyKSxzPWEmJnBhcnNlSW50KGEubWFyZ2luTGVmdCkrcGFyc2VJbnQoYS5tYXJnaW5SaWdodCkrayhpKS53aWR0aCx0PWwmJnBhcnNlSW50KGwubWFyZ2luTGVmdCkrcGFyc2VJbnQobC5tYXJnaW5SaWdodCkrayhyKS53aWR0aDtpZihcImZsZXhcIj09PW4uZGlzcGxheSlyZXR1cm5cImNvbHVtblwiPT09bi5mbGV4RGlyZWN0aW9ufHxcImNvbHVtbi1yZXZlcnNlXCI9PT1uLmZsZXhEaXJlY3Rpb24/XCJ2ZXJ0aWNhbFwiOlwiaG9yaXpvbnRhbFwiO2lmKFwiZ3JpZFwiPT09bi5kaXNwbGF5KXJldHVybiBuLmdyaWRUZW1wbGF0ZUNvbHVtbnMuc3BsaXQoXCIgXCIpLmxlbmd0aDw9MT9cInZlcnRpY2FsXCI6XCJob3Jpem9udGFsXCI7aWYoaSYmYS5mbG9hdCYmXCJub25lXCIhPT1hLmZsb2F0KXtlPVwibGVmdFwiPT09YS5mbG9hdD9cImxlZnRcIjpcInJpZ2h0XCI7cmV0dXJuIXJ8fFwiYm90aFwiIT09bC5jbGVhciYmbC5jbGVhciE9PWU/XCJob3Jpem9udGFsXCI6XCJ2ZXJ0aWNhbFwifXJldHVybiBpJiYoXCJibG9ja1wiPT09YS5kaXNwbGF5fHxcImZsZXhcIj09PWEuZGlzcGxheXx8XCJ0YWJsZVwiPT09YS5kaXNwbGF5fHxcImdyaWRcIj09PWEuZGlzcGxheXx8bzw9cyYmXCJub25lXCI9PT1uW010XXx8ciYmXCJub25lXCI9PT1uW010XSYmbzxzK3QpP1widmVydGljYWxcIjpcImhvcml6b250YWxcIn0sUHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gbChyLGEpe3JldHVybiBmdW5jdGlvbih0LGUsbixvKXt2YXIgaT10Lm9wdGlvbnMuZ3JvdXAubmFtZSYmZS5vcHRpb25zLmdyb3VwLm5hbWUmJnQub3B0aW9ucy5ncm91cC5uYW1lPT09ZS5vcHRpb25zLmdyb3VwLm5hbWU7aWYobnVsbD09ciYmKGF8fGkpKXJldHVybiEwO2lmKG51bGw9PXJ8fCExPT09cilyZXR1cm4hMTtpZihhJiZcImNsb25lXCI9PT1yKXJldHVybiByO2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mIHIpcmV0dXJuIGwocih0LGUsbixvKSxhKSh0LGUsbixvKTtlPShhP3Q6ZSkub3B0aW9ucy5ncm91cC5uYW1lO3JldHVybiEwPT09cnx8XCJzdHJpbmdcIj09dHlwZW9mIHImJnI9PT1lfHxyLmpvaW4mJi0xPHIuaW5kZXhPZihlKX19dmFyIGU9e30sbj10Lmdyb3VwO24mJlwib2JqZWN0XCI9PW8obil8fChuPXtuYW1lOm59KSxlLm5hbWU9bi5uYW1lLGUuY2hlY2tQdWxsPWwobi5wdWxsLCEwKSxlLmNoZWNrUHV0PWwobi5wdXQpLGUucmV2ZXJ0Q2xvbmU9bi5yZXZlcnRDbG9uZSx0Lmdyb3VwPWV9LGt0PWZ1bmN0aW9uKCl7IU50JiZaJiZQKFosXCJkaXNwbGF5XCIsXCJub25lXCIpfSxSdD1mdW5jdGlvbigpeyFOdCYmWiYmUChaLFwiZGlzcGxheVwiLFwiXCIpfTt4dCYmZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsZnVuY3Rpb24odCl7aWYod3QpcmV0dXJuIHQucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbiYmdC5zdG9wUHJvcGFnYXRpb24oKSx0LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiYmdC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSx3dD0hMX0sITApO2Z1bmN0aW9uIFh0KHQpe2lmKHEpe3Q9dC50b3VjaGVzP3QudG91Y2hlc1swXTp0O3ZhciBlPShpPXQuY2xpZW50WCxyPXQuY2xpZW50WSxFdC5zb21lKGZ1bmN0aW9uKHQpe3ZhciBlPXRbal0ub3B0aW9ucy5lbXB0eUluc2VydFRocmVzaG9sZDtpZihlJiYhWSh0KSl7dmFyIG49ayh0KSxvPWk+PW4ubGVmdC1lJiZpPD1uLnJpZ2h0K2UsZT1yPj1uLnRvcC1lJiZyPD1uLmJvdHRvbStlO3JldHVybiBvJiZlP2E9dDp2b2lkIDB9fSksYSk7aWYoZSl7dmFyIG4sbz17fTtmb3IobiBpbiB0KXQuaGFzT3duUHJvcGVydHkobikmJihvW25dPXRbbl0pO28udGFyZ2V0PW8ucm9vdEVsPWUsby5wcmV2ZW50RGVmYXVsdD12b2lkIDAsby5zdG9wUHJvcGFnYXRpb249dm9pZCAwLGVbal0uX29uRHJhZ092ZXIobyl9fXZhciBpLHIsYX1mdW5jdGlvbiBZdCh0KXtxJiZxLnBhcmVudE5vZGVbal0uX2lzT3V0c2lkZVRoaXNFbCh0LnRhcmdldCl9ZnVuY3Rpb24gQnQodCxlKXtpZighdHx8IXQubm9kZVR5cGV8fDEhPT10Lm5vZGVUeXBlKXRocm93XCJTb3J0YWJsZTogYGVsYCBtdXN0IGJlIGFuIEhUTUxFbGVtZW50LCBub3QgXCIuY29uY2F0KHt9LnRvU3RyaW5nLmNhbGwodCkpO3RoaXMuZWw9dCx0aGlzLm9wdGlvbnM9ZT1hKHt9LGUpLHRbal09dGhpczt2YXIgbixvLGk9e2dyb3VwOm51bGwsc29ydDohMCxkaXNhYmxlZDohMSxzdG9yZTpudWxsLGhhbmRsZTpudWxsLGRyYWdnYWJsZTovXlt1b11sJC9pLnRlc3QodC5ub2RlTmFtZSk/XCI+bGlcIjpcIj4qXCIsc3dhcFRocmVzaG9sZDoxLGludmVydFN3YXA6ITEsaW52ZXJ0ZWRTd2FwVGhyZXNob2xkOm51bGwscmVtb3ZlQ2xvbmVPbkhpZGU6ITAsZGlyZWN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIEl0KHQsdGhpcy5vcHRpb25zKX0sZ2hvc3RDbGFzczpcInNvcnRhYmxlLWdob3N0XCIsY2hvc2VuQ2xhc3M6XCJzb3J0YWJsZS1jaG9zZW5cIixkcmFnQ2xhc3M6XCJzb3J0YWJsZS1kcmFnXCIsaWdub3JlOlwiYSwgaW1nXCIsZmlsdGVyOm51bGwscHJldmVudE9uRmlsdGVyOiEwLGFuaW1hdGlvbjowLGVhc2luZzpudWxsLHNldERhdGE6ZnVuY3Rpb24odCxlKXt0LnNldERhdGEoXCJUZXh0XCIsZS50ZXh0Q29udGVudCl9LGRyb3BCdWJibGU6ITEsZHJhZ292ZXJCdWJibGU6ITEsZGF0YUlkQXR0cjpcImRhdGEtaWRcIixkZWxheTowLGRlbGF5T25Ub3VjaE9ubHk6ITEsdG91Y2hTdGFydFRocmVzaG9sZDooTnVtYmVyLnBhcnNlSW50P051bWJlcjp3aW5kb3cpLnBhcnNlSW50KHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLDEwKXx8MSxmb3JjZUZhbGxiYWNrOiExLGZhbGxiYWNrQ2xhc3M6XCJzb3J0YWJsZS1mYWxsYmFja1wiLGZhbGxiYWNrT25Cb2R5OiExLGZhbGxiYWNrVG9sZXJhbmNlOjAsZmFsbGJhY2tPZmZzZXQ6e3g6MCx5OjB9LHN1cHBvcnRQb2ludGVyOiExIT09QnQuc3VwcG9ydFBvaW50ZXImJlwiUG9pbnRlckV2ZW50XCJpbiB3aW5kb3cmJiF1LGVtcHR5SW5zZXJ0VGhyZXNob2xkOjV9O2ZvcihuIGluIEsuaW5pdGlhbGl6ZVBsdWdpbnModGhpcyx0LGkpLGkpbiBpbiBlfHwoZVtuXT1pW25dKTtmb3IobyBpbiBQdChlKSx0aGlzKVwiX1wiPT09by5jaGFyQXQoMCkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXNbb10mJih0aGlzW29dPXRoaXNbb10uYmluZCh0aGlzKSk7dGhpcy5uYXRpdmVEcmFnZ2FibGU9IWUuZm9yY2VGYWxsYmFjayYmQXQsdGhpcy5uYXRpdmVEcmFnZ2FibGUmJih0aGlzLm9wdGlvbnMudG91Y2hTdGFydFRocmVzaG9sZD0xKSxlLnN1cHBvcnRQb2ludGVyP2godCxcInBvaW50ZXJkb3duXCIsdGhpcy5fb25UYXBTdGFydCk6KGgodCxcIm1vdXNlZG93blwiLHRoaXMuX29uVGFwU3RhcnQpLGgodCxcInRvdWNoc3RhcnRcIix0aGlzLl9vblRhcFN0YXJ0KSksdGhpcy5uYXRpdmVEcmFnZ2FibGUmJihoKHQsXCJkcmFnb3ZlclwiLHRoaXMpLGgodCxcImRyYWdlbnRlclwiLHRoaXMpKSxFdC5wdXNoKHRoaXMuZWwpLGUuc3RvcmUmJmUuc3RvcmUuZ2V0JiZ0aGlzLnNvcnQoZS5zdG9yZS5nZXQodGhpcyl8fFtdKSxhKHRoaXMseCgpKX1mdW5jdGlvbiBGdCh0LGUsbixvLGkscixhLGwpe3ZhciBzLGMsdT10W2pdLGQ9dS5vcHRpb25zLm9uTW92ZTtyZXR1cm4hd2luZG93LkN1c3RvbUV2ZW50fHx5fHx3PyhzPWRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiRXZlbnRcIikpLmluaXRFdmVudChcIm1vdmVcIiwhMCwhMCk6cz1uZXcgQ3VzdG9tRXZlbnQoXCJtb3ZlXCIse2J1YmJsZXM6ITAsY2FuY2VsYWJsZTohMH0pLHMudG89ZSxzLmZyb209dCxzLmRyYWdnZWQ9bixzLmRyYWdnZWRSZWN0PW8scy5yZWxhdGVkPWl8fGUscy5yZWxhdGVkUmVjdD1yfHxrKGUpLHMud2lsbEluc2VydEFmdGVyPWwscy5vcmlnaW5hbEV2ZW50PWEsdC5kaXNwYXRjaEV2ZW50KHMpLGM9ZD9kLmNhbGwodSxzLGEpOmN9ZnVuY3Rpb24ganQodCl7dC5kcmFnZ2FibGU9ITF9ZnVuY3Rpb24gSHQoKXtDdD0hMX1mdW5jdGlvbiBMdCh0KXtyZXR1cm4gc2V0VGltZW91dCh0LDApfWZ1bmN0aW9uIEt0KHQpe3JldHVybiBjbGVhclRpbWVvdXQodCl9QnQucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpCdCxfaXNPdXRzaWRlVGhpc0VsOmZ1bmN0aW9uKHQpe3RoaXMuZWwuY29udGFpbnModCl8fHQ9PT10aGlzLmVsfHwoZ3Q9bnVsbCl9LF9nZXREaXJlY3Rpb246ZnVuY3Rpb24odCxlKXtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiB0aGlzLm9wdGlvbnMuZGlyZWN0aW9uP3RoaXMub3B0aW9ucy5kaXJlY3Rpb24uY2FsbCh0aGlzLHQsZSxxKTp0aGlzLm9wdGlvbnMuZGlyZWN0aW9ufSxfb25UYXBTdGFydDpmdW5jdGlvbihlKXtpZihlLmNhbmNlbGFibGUpe3ZhciBuPXRoaXMsbz10aGlzLmVsLHQ9dGhpcy5vcHRpb25zLGk9dC5wcmV2ZW50T25GaWx0ZXIscj1lLnR5cGUsYT1lLnRvdWNoZXMmJmUudG91Y2hlc1swXXx8ZS5wb2ludGVyVHlwZSYmXCJ0b3VjaFwiPT09ZS5wb2ludGVyVHlwZSYmZSxsPShhfHxlKS50YXJnZXQscz1lLnRhcmdldC5zaGFkb3dSb290JiYoZS5wYXRoJiZlLnBhdGhbMF18fGUuY29tcG9zZWRQYXRoJiZlLmNvbXBvc2VkUGF0aCgpWzBdKXx8bCxjPXQuZmlsdGVyO2lmKCFmdW5jdGlvbih0KXtUdC5sZW5ndGg9MDt2YXIgZT10LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIiksbj1lLmxlbmd0aDtmb3IoO24tLTspe3ZhciBvPWVbbl07by5jaGVja2VkJiZUdC5wdXNoKG8pfX0obyksIXEmJiEoL21vdXNlZG93bnxwb2ludGVyZG93bi8udGVzdChyKSYmMCE9PWUuYnV0dG9ufHx0LmRpc2FibGVkKSYmIXMuaXNDb250ZW50RWRpdGFibGUmJih0aGlzLm5hdGl2ZURyYWdnYWJsZXx8IXV8fCFsfHxcIlNFTEVDVFwiIT09bC50YWdOYW1lLnRvVXBwZXJDYXNlKCkpJiYhKChsPU4obCx0LmRyYWdnYWJsZSxvLCExKSkmJmwuYW5pbWF0ZWR8fEo9PT1sKSl7aWYobnQ9QihsKSxpdD1CKGwsdC5kcmFnZ2FibGUpLFwiZnVuY3Rpb25cIj09dHlwZW9mIGMpe2lmKGMuY2FsbCh0aGlzLGUsbCx0aGlzKSlyZXR1cm4gVSh7c29ydGFibGU6bixyb290RWw6cyxuYW1lOlwiZmlsdGVyXCIsdGFyZ2V0RWw6bCx0b0VsOm8sZnJvbUVsOm99KSx6KFwiZmlsdGVyXCIsbix7ZXZ0OmV9KSx2b2lkKGkmJmUuY2FuY2VsYWJsZSYmZS5wcmV2ZW50RGVmYXVsdCgpKX1lbHNlIGlmKGM9YyYmYy5zcGxpdChcIixcIikuc29tZShmdW5jdGlvbih0KXtpZih0PU4ocyx0LnRyaW0oKSxvLCExKSlyZXR1cm4gVSh7c29ydGFibGU6bixyb290RWw6dCxuYW1lOlwiZmlsdGVyXCIsdGFyZ2V0RWw6bCxmcm9tRWw6byx0b0VsOm99KSx6KFwiZmlsdGVyXCIsbix7ZXZ0OmV9KSwhMH0pKXJldHVybiB2b2lkKGkmJmUuY2FuY2VsYWJsZSYmZS5wcmV2ZW50RGVmYXVsdCgpKTt0LmhhbmRsZSYmIU4ocyx0LmhhbmRsZSxvLCExKXx8dGhpcy5fcHJlcGFyZURyYWdTdGFydChlLGEsbCl9fX0sX3ByZXBhcmVEcmFnU3RhcnQ6ZnVuY3Rpb24odCxlLG4pe3ZhciBvLGk9dGhpcyxyPWkuZWwsYT1pLm9wdGlvbnMsbD1yLm93bmVyRG9jdW1lbnQ7biYmIXEmJm4ucGFyZW50Tm9kZT09PXImJihvPWsobiksJD1yLFY9KHE9bikucGFyZW50Tm9kZSxRPXEubmV4dFNpYmxpbmcsSj1uLGF0PWEuZ3JvdXAsc3Q9e3RhcmdldDpCdC5kcmFnZ2VkPXEsY2xpZW50WDooZXx8dCkuY2xpZW50WCxjbGllbnRZOihlfHx0KS5jbGllbnRZfSxodD1zdC5jbGllbnRYLW8ubGVmdCxmdD1zdC5jbGllbnRZLW8udG9wLHRoaXMuX2xhc3RYPShlfHx0KS5jbGllbnRYLHRoaXMuX2xhc3RZPShlfHx0KS5jbGllbnRZLHEuc3R5bGVbXCJ3aWxsLWNoYW5nZVwiXT1cImFsbFwiLG89ZnVuY3Rpb24oKXt6KFwiZGVsYXlFbmRlZFwiLGkse2V2dDp0fSksQnQuZXZlbnRDYW5jZWxlZD9pLl9vbkRyb3AoKTooaS5fZGlzYWJsZURlbGF5ZWREcmFnRXZlbnRzKCksIXMmJmkubmF0aXZlRHJhZ2dhYmxlJiYocS5kcmFnZ2FibGU9ITApLGkuX3RyaWdnZXJEcmFnU3RhcnQodCxlKSxVKHtzb3J0YWJsZTppLG5hbWU6XCJjaG9vc2VcIixvcmlnaW5hbEV2ZW50OnR9KSxJKHEsYS5jaG9zZW5DbGFzcywhMCkpfSxhLmlnbm9yZS5zcGxpdChcIixcIikuZm9yRWFjaChmdW5jdGlvbih0KXtiKHEsdC50cmltKCksanQpfSksaChsLFwiZHJhZ292ZXJcIixYdCksaChsLFwibW91c2Vtb3ZlXCIsWHQpLGgobCxcInRvdWNobW92ZVwiLFh0KSxoKGwsXCJtb3VzZXVwXCIsaS5fb25Ecm9wKSxoKGwsXCJ0b3VjaGVuZFwiLGkuX29uRHJvcCksaChsLFwidG91Y2hjYW5jZWxcIixpLl9vbkRyb3ApLHMmJnRoaXMubmF0aXZlRHJhZ2dhYmxlJiYodGhpcy5vcHRpb25zLnRvdWNoU3RhcnRUaHJlc2hvbGQ9NCxxLmRyYWdnYWJsZT0hMCkseihcImRlbGF5U3RhcnRcIix0aGlzLHtldnQ6dH0pLCFhLmRlbGF5fHxhLmRlbGF5T25Ub3VjaE9ubHkmJiFlfHx0aGlzLm5hdGl2ZURyYWdnYWJsZSYmKHd8fHkpP28oKTpCdC5ldmVudENhbmNlbGVkP3RoaXMuX29uRHJvcCgpOihoKGwsXCJtb3VzZXVwXCIsaS5fZGlzYWJsZURlbGF5ZWREcmFnKSxoKGwsXCJ0b3VjaGVuZFwiLGkuX2Rpc2FibGVEZWxheWVkRHJhZyksaChsLFwidG91Y2hjYW5jZWxcIixpLl9kaXNhYmxlRGVsYXllZERyYWcpLGgobCxcIm1vdXNlbW92ZVwiLGkuX2RlbGF5ZWREcmFnVG91Y2hNb3ZlSGFuZGxlciksaChsLFwidG91Y2htb3ZlXCIsaS5fZGVsYXllZERyYWdUb3VjaE1vdmVIYW5kbGVyKSxhLnN1cHBvcnRQb2ludGVyJiZoKGwsXCJwb2ludGVybW92ZVwiLGkuX2RlbGF5ZWREcmFnVG91Y2hNb3ZlSGFuZGxlciksaS5fZHJhZ1N0YXJ0VGltZXI9c2V0VGltZW91dChvLGEuZGVsYXkpKSl9LF9kZWxheWVkRHJhZ1RvdWNoTW92ZUhhbmRsZXI6ZnVuY3Rpb24odCl7dD10LnRvdWNoZXM/dC50b3VjaGVzWzBdOnQ7TWF0aC5tYXgoTWF0aC5hYnModC5jbGllbnRYLXRoaXMuX2xhc3RYKSxNYXRoLmFicyh0LmNsaWVudFktdGhpcy5fbGFzdFkpKT49TWF0aC5mbG9vcih0aGlzLm9wdGlvbnMudG91Y2hTdGFydFRocmVzaG9sZC8odGhpcy5uYXRpdmVEcmFnZ2FibGUmJndpbmRvdy5kZXZpY2VQaXhlbFJhdGlvfHwxKSkmJnRoaXMuX2Rpc2FibGVEZWxheWVkRHJhZygpfSxfZGlzYWJsZURlbGF5ZWREcmFnOmZ1bmN0aW9uKCl7cSYmanQocSksY2xlYXJUaW1lb3V0KHRoaXMuX2RyYWdTdGFydFRpbWVyKSx0aGlzLl9kaXNhYmxlRGVsYXllZERyYWdFdmVudHMoKX0sX2Rpc2FibGVEZWxheWVkRHJhZ0V2ZW50czpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZWwub3duZXJEb2N1bWVudDtmKHQsXCJtb3VzZXVwXCIsdGhpcy5fZGlzYWJsZURlbGF5ZWREcmFnKSxmKHQsXCJ0b3VjaGVuZFwiLHRoaXMuX2Rpc2FibGVEZWxheWVkRHJhZyksZih0LFwidG91Y2hjYW5jZWxcIix0aGlzLl9kaXNhYmxlRGVsYXllZERyYWcpLGYodCxcIm1vdXNlbW92ZVwiLHRoaXMuX2RlbGF5ZWREcmFnVG91Y2hNb3ZlSGFuZGxlciksZih0LFwidG91Y2htb3ZlXCIsdGhpcy5fZGVsYXllZERyYWdUb3VjaE1vdmVIYW5kbGVyKSxmKHQsXCJwb2ludGVybW92ZVwiLHRoaXMuX2RlbGF5ZWREcmFnVG91Y2hNb3ZlSGFuZGxlcil9LF90cmlnZ2VyRHJhZ1N0YXJ0OmZ1bmN0aW9uKHQsZSl7ZT1lfHxcInRvdWNoXCI9PXQucG9pbnRlclR5cGUmJnQsIXRoaXMubmF0aXZlRHJhZ2dhYmxlfHxlP3RoaXMub3B0aW9ucy5zdXBwb3J0UG9pbnRlcj9oKGRvY3VtZW50LFwicG9pbnRlcm1vdmVcIix0aGlzLl9vblRvdWNoTW92ZSk6aChkb2N1bWVudCxlP1widG91Y2htb3ZlXCI6XCJtb3VzZW1vdmVcIix0aGlzLl9vblRvdWNoTW92ZSk6KGgocSxcImRyYWdlbmRcIix0aGlzKSxoKCQsXCJkcmFnc3RhcnRcIix0aGlzLl9vbkRyYWdTdGFydCkpO3RyeXtkb2N1bWVudC5zZWxlY3Rpb24/THQoZnVuY3Rpb24oKXtkb2N1bWVudC5zZWxlY3Rpb24uZW1wdHkoKX0pOndpbmRvdy5nZXRTZWxlY3Rpb24oKS5yZW1vdmVBbGxSYW5nZXMoKX1jYXRjaCh0KXt9fSxfZHJhZ1N0YXJ0ZWQ6ZnVuY3Rpb24odCxlKXt2YXIgbjt5dD0hMSwkJiZxPyh6KFwiZHJhZ1N0YXJ0ZWRcIix0aGlzLHtldnQ6ZX0pLHRoaXMubmF0aXZlRHJhZ2dhYmxlJiZoKGRvY3VtZW50LFwiZHJhZ292ZXJcIixZdCksbj10aGlzLm9wdGlvbnMsdHx8SShxLG4uZHJhZ0NsYXNzLCExKSxJKHEsbi5naG9zdENsYXNzLCEwKSxCdC5hY3RpdmU9dGhpcyx0JiZ0aGlzLl9hcHBlbmRHaG9zdCgpLFUoe3NvcnRhYmxlOnRoaXMsbmFtZTpcInN0YXJ0XCIsb3JpZ2luYWxFdmVudDplfSkpOnRoaXMuX251bGxpbmcoKX0sX2VtdWxhdGVEcmFnT3ZlcjpmdW5jdGlvbigpe2lmKGN0KXt0aGlzLl9sYXN0WD1jdC5jbGllbnRYLHRoaXMuX2xhc3RZPWN0LmNsaWVudFksa3QoKTtmb3IodmFyIHQ9ZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChjdC5jbGllbnRYLGN0LmNsaWVudFkpLGU9dDt0JiZ0LnNoYWRvd1Jvb3QmJih0PXQuc2hhZG93Um9vdC5lbGVtZW50RnJvbVBvaW50KGN0LmNsaWVudFgsY3QuY2xpZW50WSkpIT09ZTspZT10O2lmKHEucGFyZW50Tm9kZVtqXS5faXNPdXRzaWRlVGhpc0VsKHQpLGUpZG97aWYoZVtqXSlpZihlW2pdLl9vbkRyYWdPdmVyKHtjbGllbnRYOmN0LmNsaWVudFgsY2xpZW50WTpjdC5jbGllbnRZLHRhcmdldDp0LHJvb3RFbDplfSkmJiF0aGlzLm9wdGlvbnMuZHJhZ292ZXJCdWJibGUpYnJlYWt9d2hpbGUoZT0odD1lKS5wYXJlbnROb2RlKTtSdCgpfX0sX29uVG91Y2hNb3ZlOmZ1bmN0aW9uKHQpe2lmKHN0KXt2YXIgZT10aGlzLm9wdGlvbnMsbj1lLmZhbGxiYWNrVG9sZXJhbmNlLG89ZS5mYWxsYmFja09mZnNldCxpPXQudG91Y2hlcz90LnRvdWNoZXNbMF06dCxyPVomJnYoWiwhMCksYT1aJiZyJiZyLmEsbD1aJiZyJiZyLmQsZT1PdCYmYnQmJkUoYnQpLGE9KGkuY2xpZW50WC1zdC5jbGllbnRYK28ueCkvKGF8fDEpKyhlP2VbMF0tX3RbMF06MCkvKGF8fDEpLGw9KGkuY2xpZW50WS1zdC5jbGllbnRZK28ueSkvKGx8fDEpKyhlP2VbMV0tX3RbMV06MCkvKGx8fDEpO2lmKCFCdC5hY3RpdmUmJiF5dCl7aWYobiYmTWF0aC5tYXgoTWF0aC5hYnMoaS5jbGllbnRYLXRoaXMuX2xhc3RYKSxNYXRoLmFicyhpLmNsaWVudFktdGhpcy5fbGFzdFkpKTxuKXJldHVybjt0aGlzLl9vbkRyYWdTdGFydCh0LCEwKX1aJiYocj8oci5lKz1hLSh1dHx8MCksci5mKz1sLShkdHx8MCkpOnI9e2E6MSxiOjAsYzowLGQ6MSxlOmEsZjpsfSxyPVwibWF0cml4KFwiLmNvbmNhdChyLmEsXCIsXCIpLmNvbmNhdChyLmIsXCIsXCIpLmNvbmNhdChyLmMsXCIsXCIpLmNvbmNhdChyLmQsXCIsXCIpLmNvbmNhdChyLmUsXCIsXCIpLmNvbmNhdChyLmYsXCIpXCIpLFAoWixcIndlYmtpdFRyYW5zZm9ybVwiLHIpLFAoWixcIm1velRyYW5zZm9ybVwiLHIpLFAoWixcIm1zVHJhbnNmb3JtXCIsciksUChaLFwidHJhbnNmb3JtXCIsciksdXQ9YSxkdD1sLGN0PWkpLHQuY2FuY2VsYWJsZSYmdC5wcmV2ZW50RGVmYXVsdCgpfX0sX2FwcGVuZEdob3N0OmZ1bmN0aW9uKCl7aWYoIVope3ZhciB0PXRoaXMub3B0aW9ucy5mYWxsYmFja09uQm9keT9kb2N1bWVudC5ib2R5OiQsZT1rKHEsITAsT3QsITAsdCksbj10aGlzLm9wdGlvbnM7aWYoT3Qpe2ZvcihidD10O1wic3RhdGljXCI9PT1QKGJ0LFwicG9zaXRpb25cIikmJlwibm9uZVwiPT09UChidCxcInRyYW5zZm9ybVwiKSYmYnQhPT1kb2N1bWVudDspYnQ9YnQucGFyZW50Tm9kZTtidCE9PWRvY3VtZW50LmJvZHkmJmJ0IT09ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50PyhidD09PWRvY3VtZW50JiYoYnQ9TygpKSxlLnRvcCs9YnQuc2Nyb2xsVG9wLGUubGVmdCs9YnQuc2Nyb2xsTGVmdCk6YnQ9TygpLF90PUUoYnQpfUkoWj1xLmNsb25lTm9kZSghMCksbi5naG9zdENsYXNzLCExKSxJKFosbi5mYWxsYmFja0NsYXNzLCEwKSxJKFosbi5kcmFnQ2xhc3MsITApLFAoWixcInRyYW5zaXRpb25cIixcIlwiKSxQKFosXCJ0cmFuc2Zvcm1cIixcIlwiKSxQKFosXCJib3gtc2l6aW5nXCIsXCJib3JkZXItYm94XCIpLFAoWixcIm1hcmdpblwiLDApLFAoWixcInRvcFwiLGUudG9wKSxQKFosXCJsZWZ0XCIsZS5sZWZ0KSxQKFosXCJ3aWR0aFwiLGUud2lkdGgpLFAoWixcImhlaWdodFwiLGUuaGVpZ2h0KSxQKFosXCJvcGFjaXR5XCIsXCIwLjhcIiksUChaLFwicG9zaXRpb25cIixPdD9cImFic29sdXRlXCI6XCJmaXhlZFwiKSxQKFosXCJ6SW5kZXhcIixcIjEwMDAwMFwiKSxQKFosXCJwb2ludGVyRXZlbnRzXCIsXCJub25lXCIpLEJ0Lmdob3N0PVosdC5hcHBlbmRDaGlsZChaKSxQKFosXCJ0cmFuc2Zvcm0tb3JpZ2luXCIsaHQvcGFyc2VJbnQoWi5zdHlsZS53aWR0aCkqMTAwK1wiJSBcIitmdC9wYXJzZUludChaLnN0eWxlLmhlaWdodCkqMTAwK1wiJVwiKX19LF9vbkRyYWdTdGFydDpmdW5jdGlvbih0LGUpe3ZhciBuPXRoaXMsbz10LmRhdGFUcmFuc2ZlcixpPW4ub3B0aW9uczt6KFwiZHJhZ1N0YXJ0XCIsdGhpcyx7ZXZ0OnR9KSxCdC5ldmVudENhbmNlbGVkP3RoaXMuX29uRHJvcCgpOih6KFwic2V0dXBDbG9uZVwiLHRoaXMpLEJ0LmV2ZW50Q2FuY2VsZWR8fCgodHQ9XyhxKSkuZHJhZ2dhYmxlPSExLHR0LnN0eWxlW1wid2lsbC1jaGFuZ2VcIl09XCJcIix0aGlzLl9oaWRlQ2xvbmUoKSxJKHR0LHRoaXMub3B0aW9ucy5jaG9zZW5DbGFzcywhMSksQnQuY2xvbmU9dHQpLG4uY2xvbmVJZD1MdChmdW5jdGlvbigpe3ooXCJjbG9uZVwiLG4pLEJ0LmV2ZW50Q2FuY2VsZWR8fChuLm9wdGlvbnMucmVtb3ZlQ2xvbmVPbkhpZGV8fCQuaW5zZXJ0QmVmb3JlKHR0LHEpLG4uX2hpZGVDbG9uZSgpLFUoe3NvcnRhYmxlOm4sbmFtZTpcImNsb25lXCJ9KSl9KSxlfHxJKHEsaS5kcmFnQ2xhc3MsITApLGU/KHd0PSEwLG4uX2xvb3BJZD1zZXRJbnRlcnZhbChuLl9lbXVsYXRlRHJhZ092ZXIsNTApKTooZihkb2N1bWVudCxcIm1vdXNldXBcIixuLl9vbkRyb3ApLGYoZG9jdW1lbnQsXCJ0b3VjaGVuZFwiLG4uX29uRHJvcCksZihkb2N1bWVudCxcInRvdWNoY2FuY2VsXCIsbi5fb25Ecm9wKSxvJiYoby5lZmZlY3RBbGxvd2VkPVwibW92ZVwiLGkuc2V0RGF0YSYmaS5zZXREYXRhLmNhbGwobixvLHEpKSxoKGRvY3VtZW50LFwiZHJvcFwiLG4pLFAocSxcInRyYW5zZm9ybVwiLFwidHJhbnNsYXRlWigwKVwiKSkseXQ9ITAsbi5fZHJhZ1N0YXJ0SWQ9THQobi5fZHJhZ1N0YXJ0ZWQuYmluZChuLGUsdCkpLGgoZG9jdW1lbnQsXCJzZWxlY3RzdGFydFwiLG4pLHB0PSEwLHUmJlAoZG9jdW1lbnQuYm9keSxcInVzZXItc2VsZWN0XCIsXCJub25lXCIpKX0sX29uRHJhZ092ZXI6ZnVuY3Rpb24obil7dmFyIG8saSxyLHQsYT10aGlzLmVsLGw9bi50YXJnZXQsZT10aGlzLm9wdGlvbnMscz1lLmdyb3VwLGM9QnQuYWN0aXZlLHU9YXQ9PT1zLGQ9ZS5zb3J0LGg9bHR8fGMsZj10aGlzLHA9ITE7aWYoIUN0KXtpZih2b2lkIDAhPT1uLnByZXZlbnREZWZhdWx0JiZuLmNhbmNlbGFibGUmJm4ucHJldmVudERlZmF1bHQoKSxsPU4obCxlLmRyYWdnYWJsZSxhLCEwKSxUKFwiZHJhZ092ZXJcIiksQnQuZXZlbnRDYW5jZWxlZClyZXR1cm4gcDtpZihxLmNvbnRhaW5zKG4udGFyZ2V0KXx8bC5hbmltYXRlZCYmbC5hbmltYXRpbmdYJiZsLmFuaW1hdGluZ1l8fGYuX2lnbm9yZVdoaWxlQW5pbWF0aW5nPT09bClyZXR1cm4gTyghMSk7aWYod3Q9ITEsYyYmIWUuZGlzYWJsZWQmJih1P2R8fChpPVYhPT0kKTpsdD09PXRoaXN8fCh0aGlzLmxhc3RQdXRNb2RlPWF0LmNoZWNrUHVsbCh0aGlzLGMscSxuKSkmJnMuY2hlY2tQdXQodGhpcyxjLHEsbikpKXtpZihyPVwidmVydGljYWxcIj09PXRoaXMuX2dldERpcmVjdGlvbihuLGwpLG89ayhxKSxUKFwiZHJhZ092ZXJWYWxpZFwiKSxCdC5ldmVudENhbmNlbGVkKXJldHVybiBwO2lmKGkpcmV0dXJuIFY9JCx4KCksdGhpcy5faGlkZUNsb25lKCksVChcInJldmVydFwiKSxCdC5ldmVudENhbmNlbGVkfHwoUT8kLmluc2VydEJlZm9yZShxLFEpOiQuYXBwZW5kQ2hpbGQocSkpLE8oITApO3ZhciBnPVkoYSxlLmRyYWdnYWJsZSk7aWYoIWd8fGZ1bmN0aW9uKHQsZSxuKXtuPWsoWShuLmVsLG4ub3B0aW9ucy5kcmFnZ2FibGUpKTtyZXR1cm4gZT90LmNsaWVudFg+bi5yaWdodCsxMHx8dC5jbGllbnRYPD1uLnJpZ2h0JiZ0LmNsaWVudFk+bi5ib3R0b20mJnQuY2xpZW50WD49bi5sZWZ0OnQuY2xpZW50WD5uLnJpZ2h0JiZ0LmNsaWVudFk+bi50b3B8fHQuY2xpZW50WDw9bi5yaWdodCYmdC5jbGllbnRZPm4uYm90dG9tKzEwfShuLHIsdGhpcykmJiFnLmFuaW1hdGVkKXtpZihnPT09cSlyZXR1cm4gTyghMSk7aWYoKGw9ZyYmYT09PW4udGFyZ2V0P2c6bCkmJih3PWsobCkpLCExIT09RnQoJCxhLHEsbyxsLHcsbiwhIWwpKXJldHVybiB4KCksYS5hcHBlbmRDaGlsZChxKSxWPWEsTSgpLE8oITApfWVsc2UgaWYoZyYmZnVuY3Rpb24odCxlLG4pe249ayhYKG4uZWwsMCxuLm9wdGlvbnMsITApKTtyZXR1cm4gZT90LmNsaWVudFg8bi5sZWZ0LTEwfHx0LmNsaWVudFk8bi50b3AmJnQuY2xpZW50WDxuLnJpZ2h0OnQuY2xpZW50WTxuLnRvcC0xMHx8dC5jbGllbnRZPG4uYm90dG9tJiZ0LmNsaWVudFg8bi5sZWZ0fShuLHIsdGhpcykpe3ZhciBtPVgoYSwwLGUsITApO2lmKG09PT1xKXJldHVybiBPKCExKTtpZih3PWsobD1tKSwhMSE9PUZ0KCQsYSxxLG8sbCx3LG4sITEpKXJldHVybiB4KCksYS5pbnNlcnRCZWZvcmUocSxtKSxWPWEsTSgpLE8oITApfWVsc2UgaWYobC5wYXJlbnROb2RlPT09YSl7dmFyIHYsYix5LHc9ayhsKSxFPXEucGFyZW50Tm9kZSE9PWEsRD0oRD1xLmFuaW1hdGVkJiZxLnRvUmVjdHx8byxDPWwuYW5pbWF0ZWQmJmwudG9SZWN0fHx3LFM9KHQ9cik/RC5sZWZ0OkQudG9wLHM9dD9ELnJpZ2h0OkQuYm90dG9tLGc9dD9ELndpZHRoOkQuaGVpZ2h0LG09dD9DLmxlZnQ6Qy50b3AsRD10P0MucmlnaHQ6Qy5ib3R0b20sQz10P0Mud2lkdGg6Qy5oZWlnaHQsIShTPT09bXx8cz09PUR8fFMrZy8yPT09bStDLzIpKSxTPXI/XCJ0b3BcIjpcImxlZnRcIixnPVIobCxcInRvcFwiLFwidG9wXCIpfHxSKHEsXCJ0b3BcIixcInRvcFwiKSxtPWc/Zy5zY3JvbGxUb3A6dm9pZCAwO2lmKGd0IT09bCYmKGI9d1tTXSxEdD0hMSxTdD0hRCYmZS5pbnZlcnRTd2FwfHxFKSwwIT09KHY9ZnVuY3Rpb24odCxlLG4sbyxpLHIsYSxsKXt2YXIgcz1vP3QuY2xpZW50WTp0LmNsaWVudFgsYz1vP24uaGVpZ2h0Om4ud2lkdGgsdD1vP24udG9wOm4ubGVmdCxvPW8/bi5ib3R0b206bi5yaWdodCxuPSExO2lmKCFhKWlmKGwmJnZ0PGMqaSl7aWYoRHQ9IUR0JiYoMT09PW10P3QrYypyLzI8czpzPG8tYypyLzIpPyEwOkR0KW49ITA7ZWxzZSBpZigxPT09bXQ/czx0K3Z0Om8tdnQ8cylyZXR1cm4tbXR9ZWxzZSBpZih0K2MqKDEtaSkvMjxzJiZzPG8tYyooMS1pKS8yKXJldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gQihxKTxCKHQpPzE6LTF9KGUpO2lmKChuPW58fGEpJiYoczx0K2Mqci8yfHxvLWMqci8yPHMpKXJldHVybiB0K2MvMjxzPzE6LTE7cmV0dXJuIDB9KG4sbCx3LHIsRD8xOmUuc3dhcFRocmVzaG9sZCxudWxsPT1lLmludmVydGVkU3dhcFRocmVzaG9sZD9lLnN3YXBUaHJlc2hvbGQ6ZS5pbnZlcnRlZFN3YXBUaHJlc2hvbGQsU3QsZ3Q9PT1sKSkpZm9yKHZhciBfPUIocSk7KHk9Vi5jaGlsZHJlbltfLT12XSkmJihcIm5vbmVcIj09PVAoeSxcImRpc3BsYXlcIil8fHk9PT1aKTspO2lmKDA9PT12fHx5PT09bClyZXR1cm4gTyghMSk7bXQ9djt2YXIgQz0oZ3Q9bCkubmV4dEVsZW1lbnRTaWJsaW5nLEU9ITEsRD1GdCgkLGEscSxvLGwsdyxuLEU9MT09PXYpO2lmKCExIT09RClyZXR1cm4gMSE9PUQmJi0xIT09RHx8KEU9MT09PUQpLEN0PSEwLHNldFRpbWVvdXQoSHQsMzApLHgoKSxFJiYhQz9hLmFwcGVuZENoaWxkKHEpOmwucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUocSxFP0M6bCksZyYmRihnLDAsbS1nLnNjcm9sbFRvcCksVj1xLnBhcmVudE5vZGUsdm9pZCAwPT09Ynx8U3R8fCh2dD1NYXRoLmFicyhiLWsobClbU10pKSxNKCksTyghMCl9aWYoYS5jb250YWlucyhxKSlyZXR1cm4gTyghMSl9cmV0dXJuITF9ZnVuY3Rpb24gVCh0LGUpe3oodCxmLEEoe2V2dDpuLGlzT3duZXI6dSxheGlzOnI/XCJ2ZXJ0aWNhbFwiOlwiaG9yaXpvbnRhbFwiLHJldmVydDppLGRyYWdSZWN0Om8sdGFyZ2V0UmVjdDp3LGNhblNvcnQ6ZCxmcm9tU29ydGFibGU6aCx0YXJnZXQ6bCxjb21wbGV0ZWQ6Tyxvbk1vdmU6ZnVuY3Rpb24odCxlKXtyZXR1cm4gRnQoJCxhLHEsbyx0LGsodCksbixlKX0sY2hhbmdlZDpNfSxlKSl9ZnVuY3Rpb24geCgpe1QoXCJkcmFnT3ZlckFuaW1hdGlvbkNhcHR1cmVcIiksZi5jYXB0dXJlQW5pbWF0aW9uU3RhdGUoKSxmIT09aCYmaC5jYXB0dXJlQW5pbWF0aW9uU3RhdGUoKX1mdW5jdGlvbiBPKHQpe3JldHVybiBUKFwiZHJhZ092ZXJDb21wbGV0ZWRcIix7aW5zZXJ0aW9uOnR9KSx0JiYodT9jLl9oaWRlQ2xvbmUoKTpjLl9zaG93Q2xvbmUoZiksZiE9PWgmJihJKHEsKGx0fHxjKS5vcHRpb25zLmdob3N0Q2xhc3MsITEpLEkocSxlLmdob3N0Q2xhc3MsITApKSxsdCE9PWYmJmYhPT1CdC5hY3RpdmU/bHQ9ZjpmPT09QnQuYWN0aXZlJiZsdCYmKGx0PW51bGwpLGg9PT1mJiYoZi5faWdub3JlV2hpbGVBbmltYXRpbmc9bCksZi5hbmltYXRlQWxsKGZ1bmN0aW9uKCl7VChcImRyYWdPdmVyQW5pbWF0aW9uQ29tcGxldGVcIiksZi5faWdub3JlV2hpbGVBbmltYXRpbmc9bnVsbH0pLGYhPT1oJiYoaC5hbmltYXRlQWxsKCksaC5faWdub3JlV2hpbGVBbmltYXRpbmc9bnVsbCkpLChsPT09cSYmIXEuYW5pbWF0ZWR8fGw9PT1hJiYhbC5hbmltYXRlZCkmJihndD1udWxsKSxlLmRyYWdvdmVyQnViYmxlfHxuLnJvb3RFbHx8bD09PWRvY3VtZW50fHwocS5wYXJlbnROb2RlW2pdLl9pc091dHNpZGVUaGlzRWwobi50YXJnZXQpLHR8fFh0KG4pKSwhZS5kcmFnb3ZlckJ1YmJsZSYmbi5zdG9wUHJvcGFnYXRpb24mJm4uc3RvcFByb3BhZ2F0aW9uKCkscD0hMH1mdW5jdGlvbiBNKCl7b3Q9QihxKSxydD1CKHEsZS5kcmFnZ2FibGUpLFUoe3NvcnRhYmxlOmYsbmFtZTpcImNoYW5nZVwiLHRvRWw6YSxuZXdJbmRleDpvdCxuZXdEcmFnZ2FibGVJbmRleDpydCxvcmlnaW5hbEV2ZW50Om59KX19LF9pZ25vcmVXaGlsZUFuaW1hdGluZzpudWxsLF9vZmZNb3ZlRXZlbnRzOmZ1bmN0aW9uKCl7Zihkb2N1bWVudCxcIm1vdXNlbW92ZVwiLHRoaXMuX29uVG91Y2hNb3ZlKSxmKGRvY3VtZW50LFwidG91Y2htb3ZlXCIsdGhpcy5fb25Ub3VjaE1vdmUpLGYoZG9jdW1lbnQsXCJwb2ludGVybW92ZVwiLHRoaXMuX29uVG91Y2hNb3ZlKSxmKGRvY3VtZW50LFwiZHJhZ292ZXJcIixYdCksZihkb2N1bWVudCxcIm1vdXNlbW92ZVwiLFh0KSxmKGRvY3VtZW50LFwidG91Y2htb3ZlXCIsWHQpfSxfb2ZmVXBFdmVudHM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmVsLm93bmVyRG9jdW1lbnQ7Zih0LFwibW91c2V1cFwiLHRoaXMuX29uRHJvcCksZih0LFwidG91Y2hlbmRcIix0aGlzLl9vbkRyb3ApLGYodCxcInBvaW50ZXJ1cFwiLHRoaXMuX29uRHJvcCksZih0LFwidG91Y2hjYW5jZWxcIix0aGlzLl9vbkRyb3ApLGYoZG9jdW1lbnQsXCJzZWxlY3RzdGFydFwiLHRoaXMpfSxfb25Ecm9wOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZWwsbj10aGlzLm9wdGlvbnM7b3Q9QihxKSxydD1CKHEsbi5kcmFnZ2FibGUpLHooXCJkcm9wXCIsdGhpcyx7ZXZ0OnR9KSxWPXEmJnEucGFyZW50Tm9kZSxvdD1CKHEpLHJ0PUIocSxuLmRyYWdnYWJsZSksQnQuZXZlbnRDYW5jZWxlZHx8KER0PVN0PXl0PSExLGNsZWFySW50ZXJ2YWwodGhpcy5fbG9vcElkKSxjbGVhclRpbWVvdXQodGhpcy5fZHJhZ1N0YXJ0VGltZXIpLEt0KHRoaXMuY2xvbmVJZCksS3QodGhpcy5fZHJhZ1N0YXJ0SWQpLHRoaXMubmF0aXZlRHJhZ2dhYmxlJiYoZihkb2N1bWVudCxcImRyb3BcIix0aGlzKSxmKGUsXCJkcmFnc3RhcnRcIix0aGlzLl9vbkRyYWdTdGFydCkpLHRoaXMuX29mZk1vdmVFdmVudHMoKSx0aGlzLl9vZmZVcEV2ZW50cygpLHUmJlAoZG9jdW1lbnQuYm9keSxcInVzZXItc2VsZWN0XCIsXCJcIiksUChxLFwidHJhbnNmb3JtXCIsXCJcIiksdCYmKHB0JiYodC5jYW5jZWxhYmxlJiZ0LnByZXZlbnREZWZhdWx0KCksbi5kcm9wQnViYmxlfHx0LnN0b3BQcm9wYWdhdGlvbigpKSxaJiZaLnBhcmVudE5vZGUmJloucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChaKSwoJD09PVZ8fGx0JiZcImNsb25lXCIhPT1sdC5sYXN0UHV0TW9kZSkmJnR0JiZ0dC5wYXJlbnROb2RlJiZ0dC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHR0KSxxJiYodGhpcy5uYXRpdmVEcmFnZ2FibGUmJmYocSxcImRyYWdlbmRcIix0aGlzKSxqdChxKSxxLnN0eWxlW1wid2lsbC1jaGFuZ2VcIl09XCJcIixwdCYmIXl0JiZJKHEsKGx0fHx0aGlzKS5vcHRpb25zLmdob3N0Q2xhc3MsITEpLEkocSx0aGlzLm9wdGlvbnMuY2hvc2VuQ2xhc3MsITEpLFUoe3NvcnRhYmxlOnRoaXMsbmFtZTpcInVuY2hvb3NlXCIsdG9FbDpWLG5ld0luZGV4Om51bGwsbmV3RHJhZ2dhYmxlSW5kZXg6bnVsbCxvcmlnaW5hbEV2ZW50OnR9KSwkIT09Vj8oMDw9b3QmJihVKHtyb290RWw6VixuYW1lOlwiYWRkXCIsdG9FbDpWLGZyb21FbDokLG9yaWdpbmFsRXZlbnQ6dH0pLFUoe3NvcnRhYmxlOnRoaXMsbmFtZTpcInJlbW92ZVwiLHRvRWw6VixvcmlnaW5hbEV2ZW50OnR9KSxVKHtyb290RWw6VixuYW1lOlwic29ydFwiLHRvRWw6Vixmcm9tRWw6JCxvcmlnaW5hbEV2ZW50OnR9KSxVKHtzb3J0YWJsZTp0aGlzLG5hbWU6XCJzb3J0XCIsdG9FbDpWLG9yaWdpbmFsRXZlbnQ6dH0pKSxsdCYmbHQuc2F2ZSgpKTpvdCE9PW50JiYwPD1vdCYmKFUoe3NvcnRhYmxlOnRoaXMsbmFtZTpcInVwZGF0ZVwiLHRvRWw6VixvcmlnaW5hbEV2ZW50OnR9KSxVKHtzb3J0YWJsZTp0aGlzLG5hbWU6XCJzb3J0XCIsdG9FbDpWLG9yaWdpbmFsRXZlbnQ6dH0pKSxCdC5hY3RpdmUmJihudWxsIT1vdCYmLTEhPT1vdHx8KG90PW50LHJ0PWl0KSxVKHtzb3J0YWJsZTp0aGlzLG5hbWU6XCJlbmRcIix0b0VsOlYsb3JpZ2luYWxFdmVudDp0fSksdGhpcy5zYXZlKCkpKSkpLHRoaXMuX251bGxpbmcoKX0sX251bGxpbmc6ZnVuY3Rpb24oKXt6KFwibnVsbGluZ1wiLHRoaXMpLCQ9cT1WPVo9UT10dD1KPWV0PXN0PWN0PXB0PW90PXJ0PW50PWl0PWd0PW10PWx0PWF0PUJ0LmRyYWdnZWQ9QnQuZ2hvc3Q9QnQuY2xvbmU9QnQuYWN0aXZlPW51bGwsVHQuZm9yRWFjaChmdW5jdGlvbih0KXt0LmNoZWNrZWQ9ITB9KSxUdC5sZW5ndGg9dXQ9ZHQ9MH0saGFuZGxlRXZlbnQ6ZnVuY3Rpb24odCl7c3dpdGNoKHQudHlwZSl7Y2FzZVwiZHJvcFwiOmNhc2VcImRyYWdlbmRcIjp0aGlzLl9vbkRyb3AodCk7YnJlYWs7Y2FzZVwiZHJhZ2VudGVyXCI6Y2FzZVwiZHJhZ292ZXJcIjpxJiYodGhpcy5fb25EcmFnT3Zlcih0KSxmdW5jdGlvbih0KXt0LmRhdGFUcmFuc2ZlciYmKHQuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3Q9XCJtb3ZlXCIpO3QuY2FuY2VsYWJsZSYmdC5wcmV2ZW50RGVmYXVsdCgpfSh0KSk7YnJlYWs7Y2FzZVwic2VsZWN0c3RhcnRcIjp0LnByZXZlbnREZWZhdWx0KCl9fSx0b0FycmF5OmZ1bmN0aW9uKCl7Zm9yKHZhciB0LGU9W10sbj10aGlzLmVsLmNoaWxkcmVuLG89MCxpPW4ubGVuZ3RoLHI9dGhpcy5vcHRpb25zO288aTtvKyspTih0PW5bb10sci5kcmFnZ2FibGUsdGhpcy5lbCwhMSkmJmUucHVzaCh0LmdldEF0dHJpYnV0ZShyLmRhdGFJZEF0dHIpfHxmdW5jdGlvbih0KXt2YXIgZT10LnRhZ05hbWUrdC5jbGFzc05hbWUrdC5zcmMrdC5ocmVmK3QudGV4dENvbnRlbnQsbj1lLmxlbmd0aCxvPTA7Zm9yKDtuLS07KW8rPWUuY2hhckNvZGVBdChuKTtyZXR1cm4gby50b1N0cmluZygzNil9KHQpKTtyZXR1cm4gZX0sc29ydDpmdW5jdGlvbih0LGUpe3ZhciBuPXt9LG89dGhpcy5lbDt0aGlzLnRvQXJyYXkoKS5mb3JFYWNoKGZ1bmN0aW9uKHQsZSl7ZT1vLmNoaWxkcmVuW2VdO04oZSx0aGlzLm9wdGlvbnMuZHJhZ2dhYmxlLG8sITEpJiYoblt0XT1lKX0sdGhpcyksZSYmdGhpcy5jYXB0dXJlQW5pbWF0aW9uU3RhdGUoKSx0LmZvckVhY2goZnVuY3Rpb24odCl7blt0XSYmKG8ucmVtb3ZlQ2hpbGQoblt0XSksby5hcHBlbmRDaGlsZChuW3RdKSl9KSxlJiZ0aGlzLmFuaW1hdGVBbGwoKX0sc2F2ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMub3B0aW9ucy5zdG9yZTt0JiZ0LnNldCYmdC5zZXQodGhpcyl9LGNsb3Nlc3Q6ZnVuY3Rpb24odCxlKXtyZXR1cm4gTih0LGV8fHRoaXMub3B0aW9ucy5kcmFnZ2FibGUsdGhpcy5lbCwhMSl9LG9wdGlvbjpmdW5jdGlvbih0LGUpe3ZhciBuPXRoaXMub3B0aW9ucztpZih2b2lkIDA9PT1lKXJldHVybiBuW3RdO3ZhciBvPUsubW9kaWZ5T3B0aW9uKHRoaXMsdCxlKTtuW3RdPXZvaWQgMCE9PW8/bzplLFwiZ3JvdXBcIj09PXQmJlB0KG4pfSxkZXN0cm95OmZ1bmN0aW9uKCl7eihcImRlc3Ryb3lcIix0aGlzKTt2YXIgdD10aGlzLmVsO3Rbal09bnVsbCxmKHQsXCJtb3VzZWRvd25cIix0aGlzLl9vblRhcFN0YXJ0KSxmKHQsXCJ0b3VjaHN0YXJ0XCIsdGhpcy5fb25UYXBTdGFydCksZih0LFwicG9pbnRlcmRvd25cIix0aGlzLl9vblRhcFN0YXJ0KSx0aGlzLm5hdGl2ZURyYWdnYWJsZSYmKGYodCxcImRyYWdvdmVyXCIsdGhpcyksZih0LFwiZHJhZ2VudGVyXCIsdGhpcykpLEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwodC5xdWVyeVNlbGVjdG9yQWxsKFwiW2RyYWdnYWJsZV1cIiksZnVuY3Rpb24odCl7dC5yZW1vdmVBdHRyaWJ1dGUoXCJkcmFnZ2FibGVcIil9KSx0aGlzLl9vbkRyb3AoKSx0aGlzLl9kaXNhYmxlRGVsYXllZERyYWdFdmVudHMoKSxFdC5zcGxpY2UoRXQuaW5kZXhPZih0aGlzLmVsKSwxKSx0aGlzLmVsPXQ9bnVsbH0sX2hpZGVDbG9uZTpmdW5jdGlvbigpe2V0fHwoeihcImhpZGVDbG9uZVwiLHRoaXMpLEJ0LmV2ZW50Q2FuY2VsZWR8fChQKHR0LFwiZGlzcGxheVwiLFwibm9uZVwiKSx0aGlzLm9wdGlvbnMucmVtb3ZlQ2xvbmVPbkhpZGUmJnR0LnBhcmVudE5vZGUmJnR0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodHQpLGV0PSEwKSl9LF9zaG93Q2xvbmU6ZnVuY3Rpb24odCl7XCJjbG9uZVwiPT09dC5sYXN0UHV0TW9kZT9ldCYmKHooXCJzaG93Q2xvbmVcIix0aGlzKSxCdC5ldmVudENhbmNlbGVkfHwocS5wYXJlbnROb2RlIT0kfHx0aGlzLm9wdGlvbnMuZ3JvdXAucmV2ZXJ0Q2xvbmU/UT8kLmluc2VydEJlZm9yZSh0dCxRKTokLmFwcGVuZENoaWxkKHR0KTokLmluc2VydEJlZm9yZSh0dCxxKSx0aGlzLm9wdGlvbnMuZ3JvdXAucmV2ZXJ0Q2xvbmUmJnRoaXMuYW5pbWF0ZShxLHR0KSxQKHR0LFwiZGlzcGxheVwiLFwiXCIpLGV0PSExKSk6dGhpcy5faGlkZUNsb25lKCl9fSx4dCYmaChkb2N1bWVudCxcInRvdWNobW92ZVwiLGZ1bmN0aW9uKHQpeyhCdC5hY3RpdmV8fHl0KSYmdC5jYW5jZWxhYmxlJiZ0LnByZXZlbnREZWZhdWx0KCl9KSxCdC51dGlscz17b246aCxvZmY6Zixjc3M6UCxmaW5kOmIsaXM6ZnVuY3Rpb24odCxlKXtyZXR1cm4hIU4odCxlLHQsITEpfSxleHRlbmQ6ZnVuY3Rpb24odCxlKXtpZih0JiZlKWZvcih2YXIgbiBpbiBlKWUuaGFzT3duUHJvcGVydHkobikmJih0W25dPWVbbl0pO3JldHVybiB0fSx0aHJvdHRsZTpTLGNsb3Nlc3Q6Tix0b2dnbGVDbGFzczpJLGNsb25lOl8saW5kZXg6QixuZXh0VGljazpMdCxjYW5jZWxOZXh0VGljazpLdCxkZXRlY3REaXJlY3Rpb246SXQsZ2V0Q2hpbGQ6WH0sQnQuZ2V0PWZ1bmN0aW9uKHQpe3JldHVybiB0W2pdfSxCdC5tb3VudD1mdW5jdGlvbigpe2Zvcih2YXIgdD1hcmd1bWVudHMubGVuZ3RoLGU9bmV3IEFycmF5KHQpLG49MDtuPHQ7bisrKWVbbl09YXJndW1lbnRzW25dOyhlPWVbMF0uY29uc3RydWN0b3I9PT1BcnJheT9lWzBdOmUpLmZvckVhY2goZnVuY3Rpb24odCl7aWYoIXQucHJvdG90eXBlfHwhdC5wcm90b3R5cGUuY29uc3RydWN0b3IpdGhyb3dcIlNvcnRhYmxlOiBNb3VudGVkIHBsdWdpbiBtdXN0IGJlIGEgY29uc3RydWN0b3IgZnVuY3Rpb24sIG5vdCBcIi5jb25jYXQoe30udG9TdHJpbmcuY2FsbCh0KSk7dC51dGlscyYmKEJ0LnV0aWxzPUEoQSh7fSxCdC51dGlscyksdC51dGlscykpLEsubW91bnQodCl9KX0sQnQuY3JlYXRlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG5ldyBCdCh0LGUpfTt2YXIgV3QsenQsR3QsVXQscXQsVnQsWnQ9W10sJHQ9IShCdC52ZXJzaW9uPVwiMS4xNC4wXCIpO2Z1bmN0aW9uIFF0KCl7WnQuZm9yRWFjaChmdW5jdGlvbih0KXtjbGVhckludGVydmFsKHQucGlkKX0pLFp0PVtdfWZ1bmN0aW9uIEp0KCl7Y2xlYXJJbnRlcnZhbChWdCl9dmFyIHRlLGVlPVMoZnVuY3Rpb24obix0LGUsbyl7aWYodC5zY3JvbGwpe3ZhciBpLHI9KG4udG91Y2hlcz9uLnRvdWNoZXNbMF06bikuY2xpZW50WCxhPShuLnRvdWNoZXM/bi50b3VjaGVzWzBdOm4pLmNsaWVudFksbD10LnNjcm9sbFNlbnNpdGl2aXR5LHM9dC5zY3JvbGxTcGVlZCxjPU8oKSx1PSExO3p0IT09ZSYmKHp0PWUsUXQoKSxXdD10LnNjcm9sbCxpPXQuc2Nyb2xsRm4sITA9PT1XdCYmKFd0PU0oZSwhMCkpKTt2YXIgZD0wLGg9V3Q7ZG97dmFyIGY9aCxwPWsoZiksZz1wLnRvcCxtPXAuYm90dG9tLHY9cC5sZWZ0LGI9cC5yaWdodCx5PXAud2lkdGgsdz1wLmhlaWdodCxFPXZvaWQgMCxEPXZvaWQgMCxTPWYuc2Nyb2xsV2lkdGgsXz1mLnNjcm9sbEhlaWdodCxDPVAoZiksVD1mLnNjcm9sbExlZnQscD1mLnNjcm9sbFRvcCxEPWY9PT1jPyhFPXk8UyYmKFwiYXV0b1wiPT09Qy5vdmVyZmxvd1h8fFwic2Nyb2xsXCI9PT1DLm92ZXJmbG93WHx8XCJ2aXNpYmxlXCI9PT1DLm92ZXJmbG93WCksdzxfJiYoXCJhdXRvXCI9PT1DLm92ZXJmbG93WXx8XCJzY3JvbGxcIj09PUMub3ZlcmZsb3dZfHxcInZpc2libGVcIj09PUMub3ZlcmZsb3dZKSk6KEU9eTxTJiYoXCJhdXRvXCI9PT1DLm92ZXJmbG93WHx8XCJzY3JvbGxcIj09PUMub3ZlcmZsb3dYKSx3PF8mJihcImF1dG9cIj09PUMub3ZlcmZsb3dZfHxcInNjcm9sbFwiPT09Qy5vdmVyZmxvd1kpKSxUPUUmJihNYXRoLmFicyhiLXIpPD1sJiZUK3k8UyktKE1hdGguYWJzKHYtcik8PWwmJiEhVCkscD1EJiYoTWF0aC5hYnMobS1hKTw9bCYmcCt3PF8pLShNYXRoLmFicyhnLWEpPD1sJiYhIXApO2lmKCFadFtkXSlmb3IodmFyIHg9MDt4PD1kO3grKyladFt4XXx8KFp0W3hdPXt9KTtadFtkXS52eD09VCYmWnRbZF0udnk9PXAmJlp0W2RdLmVsPT09Znx8KFp0W2RdLmVsPWYsWnRbZF0udng9VCxadFtkXS52eT1wLGNsZWFySW50ZXJ2YWwoWnRbZF0ucGlkKSwwPT1UJiYwPT1wfHwodT0hMCxadFtkXS5waWQ9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtvJiYwPT09dGhpcy5sYXllciYmQnQuYWN0aXZlLl9vblRvdWNoTW92ZShxdCk7dmFyIHQ9WnRbdGhpcy5sYXllcl0udnk/WnRbdGhpcy5sYXllcl0udnkqczowLGU9WnRbdGhpcy5sYXllcl0udng/WnRbdGhpcy5sYXllcl0udngqczowO1wiZnVuY3Rpb25cIj09dHlwZW9mIGkmJlwiY29udGludWVcIiE9PWkuY2FsbChCdC5kcmFnZ2VkLnBhcmVudE5vZGVbal0sZSx0LG4scXQsWnRbdGhpcy5sYXllcl0uZWwpfHxGKFp0W3RoaXMubGF5ZXJdLmVsLGUsdCl9LmJpbmQoe2xheWVyOmR9KSwyNCkpKSxkKyt9d2hpbGUodC5idWJibGVTY3JvbGwmJmghPT1jJiYoaD1NKGgsITEpKSk7JHQ9dX19LDMwKSxuPWZ1bmN0aW9uKHQpe3ZhciBlPXQub3JpZ2luYWxFdmVudCxuPXQucHV0U29ydGFibGUsbz10LmRyYWdFbCxpPXQuYWN0aXZlU29ydGFibGUscj10LmRpc3BhdGNoU29ydGFibGVFdmVudCxhPXQuaGlkZUdob3N0Rm9yVGFyZ2V0LHQ9dC51bmhpZGVHaG9zdEZvclRhcmdldDtlJiYoaT1ufHxpLGEoKSxlPWUuY2hhbmdlZFRvdWNoZXMmJmUuY2hhbmdlZFRvdWNoZXMubGVuZ3RoP2UuY2hhbmdlZFRvdWNoZXNbMF06ZSxlPWRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoZS5jbGllbnRYLGUuY2xpZW50WSksdCgpLGkmJiFpLmVsLmNvbnRhaW5zKGUpJiYocihcInNwaWxsXCIpLHRoaXMub25TcGlsbCh7ZHJhZ0VsOm8scHV0U29ydGFibGU6bn0pKSl9O2Z1bmN0aW9uIG5lKCl7fWZ1bmN0aW9uIG9lKCl7fW5lLnByb3RvdHlwZT17c3RhcnRJbmRleDpudWxsLGRyYWdTdGFydDpmdW5jdGlvbih0KXt0PXQub2xkRHJhZ2dhYmxlSW5kZXg7dGhpcy5zdGFydEluZGV4PXR9LG9uU3BpbGw6ZnVuY3Rpb24odCl7dmFyIGU9dC5kcmFnRWwsbj10LnB1dFNvcnRhYmxlO3RoaXMuc29ydGFibGUuY2FwdHVyZUFuaW1hdGlvblN0YXRlKCksbiYmbi5jYXB0dXJlQW5pbWF0aW9uU3RhdGUoKTt0PVgodGhpcy5zb3J0YWJsZS5lbCx0aGlzLnN0YXJ0SW5kZXgsdGhpcy5vcHRpb25zKTt0P3RoaXMuc29ydGFibGUuZWwuaW5zZXJ0QmVmb3JlKGUsdCk6dGhpcy5zb3J0YWJsZS5lbC5hcHBlbmRDaGlsZChlKSx0aGlzLnNvcnRhYmxlLmFuaW1hdGVBbGwoKSxuJiZuLmFuaW1hdGVBbGwoKX0sZHJvcDpufSxhKG5lLHtwbHVnaW5OYW1lOlwicmV2ZXJ0T25TcGlsbFwifSksb2UucHJvdG90eXBlPXtvblNwaWxsOmZ1bmN0aW9uKHQpe3ZhciBlPXQuZHJhZ0VsLHQ9dC5wdXRTb3J0YWJsZXx8dGhpcy5zb3J0YWJsZTt0LmNhcHR1cmVBbmltYXRpb25TdGF0ZSgpLGUucGFyZW50Tm9kZSYmZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGUpLHQuYW5pbWF0ZUFsbCgpfSxkcm9wOm59LGEob2Use3BsdWdpbk5hbWU6XCJyZW1vdmVPblNwaWxsXCJ9KTt2YXIgaWUscmUsYWUsbGUsc2UsY2U9W10sdWU9W10sZGU9ITEsaGU9ITEsZmU9ITE7ZnVuY3Rpb24gcGUobixvKXt1ZS5mb3JFYWNoKGZ1bmN0aW9uKHQsZSl7ZT1vLmNoaWxkcmVuW3Quc29ydGFibGVJbmRleCsobj9OdW1iZXIoZSk6MCldO2U/by5pbnNlcnRCZWZvcmUodCxlKTpvLmFwcGVuZENoaWxkKHQpfSl9ZnVuY3Rpb24gZ2UoKXtjZS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QhPT1hZSYmdC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodCl9KX1yZXR1cm4gQnQubW91bnQobmV3IGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe2Zvcih2YXIgdCBpbiB0aGlzLmRlZmF1bHRzPXtzY3JvbGw6ITAsZm9yY2VBdXRvU2Nyb2xsRmFsbGJhY2s6ITEsc2Nyb2xsU2Vuc2l0aXZpdHk6MzAsc2Nyb2xsU3BlZWQ6MTAsYnViYmxlU2Nyb2xsOiEwfSx0aGlzKVwiX1wiPT09dC5jaGFyQXQoMCkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXNbdF0mJih0aGlzW3RdPXRoaXNbdF0uYmluZCh0aGlzKSl9cmV0dXJuIHQucHJvdG90eXBlPXtkcmFnU3RhcnRlZDpmdW5jdGlvbih0KXt0PXQub3JpZ2luYWxFdmVudDt0aGlzLnNvcnRhYmxlLm5hdGl2ZURyYWdnYWJsZT9oKGRvY3VtZW50LFwiZHJhZ292ZXJcIix0aGlzLl9oYW5kbGVBdXRvU2Nyb2xsKTp0aGlzLm9wdGlvbnMuc3VwcG9ydFBvaW50ZXI/aChkb2N1bWVudCxcInBvaW50ZXJtb3ZlXCIsdGhpcy5faGFuZGxlRmFsbGJhY2tBdXRvU2Nyb2xsKTp0LnRvdWNoZXM/aChkb2N1bWVudCxcInRvdWNobW92ZVwiLHRoaXMuX2hhbmRsZUZhbGxiYWNrQXV0b1Njcm9sbCk6aChkb2N1bWVudCxcIm1vdXNlbW92ZVwiLHRoaXMuX2hhbmRsZUZhbGxiYWNrQXV0b1Njcm9sbCl9LGRyYWdPdmVyQ29tcGxldGVkOmZ1bmN0aW9uKHQpe3Q9dC5vcmlnaW5hbEV2ZW50O3RoaXMub3B0aW9ucy5kcmFnT3ZlckJ1YmJsZXx8dC5yb290RWx8fHRoaXMuX2hhbmRsZUF1dG9TY3JvbGwodCl9LGRyb3A6ZnVuY3Rpb24oKXt0aGlzLnNvcnRhYmxlLm5hdGl2ZURyYWdnYWJsZT9mKGRvY3VtZW50LFwiZHJhZ292ZXJcIix0aGlzLl9oYW5kbGVBdXRvU2Nyb2xsKTooZihkb2N1bWVudCxcInBvaW50ZXJtb3ZlXCIsdGhpcy5faGFuZGxlRmFsbGJhY2tBdXRvU2Nyb2xsKSxmKGRvY3VtZW50LFwidG91Y2htb3ZlXCIsdGhpcy5faGFuZGxlRmFsbGJhY2tBdXRvU2Nyb2xsKSxmKGRvY3VtZW50LFwibW91c2Vtb3ZlXCIsdGhpcy5faGFuZGxlRmFsbGJhY2tBdXRvU2Nyb2xsKSksSnQoKSxRdCgpLGNsZWFyVGltZW91dChnKSxnPXZvaWQgMH0sbnVsbGluZzpmdW5jdGlvbigpe3F0PXp0PVd0PSR0PVZ0PUd0PVV0PW51bGwsWnQubGVuZ3RoPTB9LF9oYW5kbGVGYWxsYmFja0F1dG9TY3JvbGw6ZnVuY3Rpb24odCl7dGhpcy5faGFuZGxlQXV0b1Njcm9sbCh0LCEwKX0sX2hhbmRsZUF1dG9TY3JvbGw6ZnVuY3Rpb24oZSxuKXt2YXIgbyxpPXRoaXMscj0oZS50b3VjaGVzP2UudG91Y2hlc1swXTplKS5jbGllbnRYLGE9KGUudG91Y2hlcz9lLnRvdWNoZXNbMF06ZSkuY2xpZW50WSx0PWRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQocixhKTtxdD1lLG58fHRoaXMub3B0aW9ucy5mb3JjZUF1dG9TY3JvbGxGYWxsYmFja3x8d3x8eXx8dT8oZWUoZSx0aGlzLm9wdGlvbnMsdCxuKSxvPU0odCwhMCksISR0fHxWdCYmcj09PUd0JiZhPT09VXR8fChWdCYmSnQoKSxWdD1zZXRJbnRlcnZhbChmdW5jdGlvbigpe3ZhciB0PU0oZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChyLGEpLCEwKTt0IT09byYmKG89dCxRdCgpKSxlZShlLGkub3B0aW9ucyx0LG4pfSwxMCksR3Q9cixVdD1hKSk6dGhpcy5vcHRpb25zLmJ1YmJsZVNjcm9sbCYmTSh0LCEwKSE9PU8oKT9lZShlLHRoaXMub3B0aW9ucyxNKHQsITEpLCExKTpRdCgpfX0sYSh0LHtwbHVnaW5OYW1lOlwic2Nyb2xsXCIsaW5pdGlhbGl6ZUJ5RGVmYXVsdDohMH0pfSksQnQubW91bnQob2UsbmUpLEJ0Lm1vdW50KG5ldyBmdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt0aGlzLmRlZmF1bHRzPXtzd2FwQ2xhc3M6XCJzb3J0YWJsZS1zd2FwLWhpZ2hsaWdodFwifX1yZXR1cm4gdC5wcm90b3R5cGU9e2RyYWdTdGFydDpmdW5jdGlvbih0KXt0PXQuZHJhZ0VsO3RlPXR9LGRyYWdPdmVyVmFsaWQ6ZnVuY3Rpb24odCl7dmFyIGU9dC5jb21wbGV0ZWQsbj10LnRhcmdldCxvPXQub25Nb3ZlLGk9dC5hY3RpdmVTb3J0YWJsZSxyPXQuY2hhbmdlZCxhPXQuY2FuY2VsO2kub3B0aW9ucy5zd2FwJiYodD10aGlzLnNvcnRhYmxlLmVsLGk9dGhpcy5vcHRpb25zLG4mJm4hPT10JiYodD10ZSx0ZT0hMSE9PW8obik/KEkobixpLnN3YXBDbGFzcywhMCksbik6bnVsbCx0JiZ0IT09dGUmJkkodCxpLnN3YXBDbGFzcywhMSkpLHIoKSxlKCEwKSxhKCkpfSxkcm9wOmZ1bmN0aW9uKHQpe3ZhciBlLG4sbz10LmFjdGl2ZVNvcnRhYmxlLGk9dC5wdXRTb3J0YWJsZSxyPXQuZHJhZ0VsLGE9aXx8dGhpcy5zb3J0YWJsZSxsPXRoaXMub3B0aW9uczt0ZSYmSSh0ZSxsLnN3YXBDbGFzcywhMSksdGUmJihsLnN3YXB8fGkmJmkub3B0aW9ucy5zd2FwKSYmciE9PXRlJiYoYS5jYXB0dXJlQW5pbWF0aW9uU3RhdGUoKSxhIT09byYmby5jYXB0dXJlQW5pbWF0aW9uU3RhdGUoKSxuPXRlLHQ9KGU9cikucGFyZW50Tm9kZSxsPW4ucGFyZW50Tm9kZSx0JiZsJiYhdC5pc0VxdWFsTm9kZShuKSYmIWwuaXNFcXVhbE5vZGUoZSkmJihpPUIoZSkscj1CKG4pLHQuaXNFcXVhbE5vZGUobCkmJmk8ciYmcisrLHQuaW5zZXJ0QmVmb3JlKG4sdC5jaGlsZHJlbltpXSksbC5pbnNlcnRCZWZvcmUoZSxsLmNoaWxkcmVuW3JdKSksYS5hbmltYXRlQWxsKCksYSE9PW8mJm8uYW5pbWF0ZUFsbCgpKX0sbnVsbGluZzpmdW5jdGlvbigpe3RlPW51bGx9fSxhKHQse3BsdWdpbk5hbWU6XCJzd2FwXCIsZXZlbnRQcm9wZXJ0aWVzOmZ1bmN0aW9uKCl7cmV0dXJue3N3YXBJdGVtOnRlfX19KX0pLEJ0Lm1vdW50KG5ldyBmdW5jdGlvbigpe2Z1bmN0aW9uIHQobyl7Zm9yKHZhciB0IGluIHRoaXMpXCJfXCI9PT10LmNoYXJBdCgwKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgdGhpc1t0XSYmKHRoaXNbdF09dGhpc1t0XS5iaW5kKHRoaXMpKTtvLm9wdGlvbnMuc3VwcG9ydFBvaW50ZXI/aChkb2N1bWVudCxcInBvaW50ZXJ1cFwiLHRoaXMuX2Rlc2VsZWN0TXVsdGlEcmFnKTooaChkb2N1bWVudCxcIm1vdXNldXBcIix0aGlzLl9kZXNlbGVjdE11bHRpRHJhZyksaChkb2N1bWVudCxcInRvdWNoZW5kXCIsdGhpcy5fZGVzZWxlY3RNdWx0aURyYWcpKSxoKGRvY3VtZW50LFwia2V5ZG93blwiLHRoaXMuX2NoZWNrS2V5RG93biksaChkb2N1bWVudCxcImtleXVwXCIsdGhpcy5fY2hlY2tLZXlVcCksdGhpcy5kZWZhdWx0cz17c2VsZWN0ZWRDbGFzczpcInNvcnRhYmxlLXNlbGVjdGVkXCIsbXVsdGlEcmFnS2V5Om51bGwsc2V0RGF0YTpmdW5jdGlvbih0LGUpe3ZhciBuPVwiXCI7Y2UubGVuZ3RoJiZyZT09PW8/Y2UuZm9yRWFjaChmdW5jdGlvbih0LGUpe24rPShlP1wiLCBcIjpcIlwiKSt0LnRleHRDb250ZW50fSk6bj1lLnRleHRDb250ZW50LHQuc2V0RGF0YShcIlRleHRcIixuKX19fXJldHVybiB0LnByb3RvdHlwZT17bXVsdGlEcmFnS2V5RG93bjohMSxpc011bHRpRHJhZzohMSxkZWxheVN0YXJ0R2xvYmFsOmZ1bmN0aW9uKHQpe3Q9dC5kcmFnRWw7YWU9dH0sZGVsYXlFbmRlZDpmdW5jdGlvbigpe3RoaXMuaXNNdWx0aURyYWc9fmNlLmluZGV4T2YoYWUpfSxzZXR1cENsb25lOmZ1bmN0aW9uKHQpe3ZhciBlPXQuc29ydGFibGUsdD10LmNhbmNlbDtpZih0aGlzLmlzTXVsdGlEcmFnKXtmb3IodmFyIG49MDtuPGNlLmxlbmd0aDtuKyspdWUucHVzaChfKGNlW25dKSksdWVbbl0uc29ydGFibGVJbmRleD1jZVtuXS5zb3J0YWJsZUluZGV4LHVlW25dLmRyYWdnYWJsZT0hMSx1ZVtuXS5zdHlsZVtcIndpbGwtY2hhbmdlXCJdPVwiXCIsSSh1ZVtuXSx0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcywhMSksY2Vbbl09PT1hZSYmSSh1ZVtuXSx0aGlzLm9wdGlvbnMuY2hvc2VuQ2xhc3MsITEpO2UuX2hpZGVDbG9uZSgpLHQoKX19LGNsb25lOmZ1bmN0aW9uKHQpe3ZhciBlPXQuc29ydGFibGUsbj10LnJvb3RFbCxvPXQuZGlzcGF0Y2hTb3J0YWJsZUV2ZW50LHQ9dC5jYW5jZWw7dGhpcy5pc011bHRpRHJhZyYmKHRoaXMub3B0aW9ucy5yZW1vdmVDbG9uZU9uSGlkZXx8Y2UubGVuZ3RoJiZyZT09PWUmJihwZSghMCxuKSxvKFwiY2xvbmVcIiksdCgpKSl9LHNob3dDbG9uZTpmdW5jdGlvbih0KXt2YXIgZT10LmNsb25lTm93U2hvd24sbj10LnJvb3RFbCx0PXQuY2FuY2VsO3RoaXMuaXNNdWx0aURyYWcmJihwZSghMSxuKSx1ZS5mb3JFYWNoKGZ1bmN0aW9uKHQpe1AodCxcImRpc3BsYXlcIixcIlwiKX0pLGUoKSxzZT0hMSx0KCkpfSxoaWRlQ2xvbmU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxuPSh0LnNvcnRhYmxlLHQuY2xvbmVOb3dIaWRkZW4pLHQ9dC5jYW5jZWw7dGhpcy5pc011bHRpRHJhZyYmKHVlLmZvckVhY2goZnVuY3Rpb24odCl7UCh0LFwiZGlzcGxheVwiLFwibm9uZVwiKSxlLm9wdGlvbnMucmVtb3ZlQ2xvbmVPbkhpZGUmJnQucGFyZW50Tm9kZSYmdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHQpfSksbigpLHNlPSEwLHQoKSl9LGRyYWdTdGFydEdsb2JhbDpmdW5jdGlvbih0KXt0LnNvcnRhYmxlOyF0aGlzLmlzTXVsdGlEcmFnJiZyZSYmcmUubXVsdGlEcmFnLl9kZXNlbGVjdE11bHRpRHJhZygpLGNlLmZvckVhY2goZnVuY3Rpb24odCl7dC5zb3J0YWJsZUluZGV4PUIodCl9KSxjZT1jZS5zb3J0KGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQuc29ydGFibGVJbmRleC1lLnNvcnRhYmxlSW5kZXh9KSxmZT0hMH0sZHJhZ1N0YXJ0ZWQ6ZnVuY3Rpb24odCl7dmFyIGUsbj10aGlzLHQ9dC5zb3J0YWJsZTt0aGlzLmlzTXVsdGlEcmFnJiYodGhpcy5vcHRpb25zLnNvcnQmJih0LmNhcHR1cmVBbmltYXRpb25TdGF0ZSgpLHRoaXMub3B0aW9ucy5hbmltYXRpb24mJihjZS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QhPT1hZSYmUCh0LFwicG9zaXRpb25cIixcImFic29sdXRlXCIpfSksZT1rKGFlLCExLCEwLCEwKSxjZS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QhPT1hZSYmQyh0LGUpfSksZGU9aGU9ITApKSx0LmFuaW1hdGVBbGwoZnVuY3Rpb24oKXtkZT1oZT0hMSxuLm9wdGlvbnMuYW5pbWF0aW9uJiZjZS5mb3JFYWNoKGZ1bmN0aW9uKHQpe1QodCl9KSxuLm9wdGlvbnMuc29ydCYmZ2UoKX0pKX0sZHJhZ092ZXI6ZnVuY3Rpb24odCl7dmFyIGU9dC50YXJnZXQsbj10LmNvbXBsZXRlZCx0PXQuY2FuY2VsO2hlJiZ+Y2UuaW5kZXhPZihlKSYmKG4oITEpLHQoKSl9LHJldmVydDpmdW5jdGlvbih0KXt2YXIgbixvLGU9dC5mcm9tU29ydGFibGUsaT10LnJvb3RFbCxyPXQuc29ydGFibGUsYT10LmRyYWdSZWN0OzE8Y2UubGVuZ3RoJiYoY2UuZm9yRWFjaChmdW5jdGlvbih0KXtyLmFkZEFuaW1hdGlvblN0YXRlKHt0YXJnZXQ6dCxyZWN0OmhlP2sodCk6YX0pLFQodCksdC5mcm9tUmVjdD1hLGUucmVtb3ZlQW5pbWF0aW9uU3RhdGUodCl9KSxoZT0hMSxuPSF0aGlzLm9wdGlvbnMucmVtb3ZlQ2xvbmVPbkhpZGUsbz1pLGNlLmZvckVhY2goZnVuY3Rpb24odCxlKXtlPW8uY2hpbGRyZW5bdC5zb3J0YWJsZUluZGV4KyhuP051bWJlcihlKTowKV07ZT9vLmluc2VydEJlZm9yZSh0LGUpOm8uYXBwZW5kQ2hpbGQodCl9KSl9LGRyYWdPdmVyQ29tcGxldGVkOmZ1bmN0aW9uKHQpe3ZhciBlLG49dC5zb3J0YWJsZSxvPXQuaXNPd25lcixpPXQuaW5zZXJ0aW9uLHI9dC5hY3RpdmVTb3J0YWJsZSxhPXQucGFyZW50RWwsbD10LnB1dFNvcnRhYmxlLHQ9dGhpcy5vcHRpb25zO2kmJihvJiZyLl9oaWRlQ2xvbmUoKSxkZT0hMSx0LmFuaW1hdGlvbiYmMTxjZS5sZW5ndGgmJihoZXx8IW8mJiFyLm9wdGlvbnMuc29ydCYmIWwpJiYoZT1rKGFlLCExLCEwLCEwKSxjZS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QhPT1hZSYmKEModCxlKSxhLmFwcGVuZENoaWxkKHQpKX0pLGhlPSEwKSxvfHwoaGV8fGdlKCksMTxjZS5sZW5ndGg/KG89c2Usci5fc2hvd0Nsb25lKG4pLHIub3B0aW9ucy5hbmltYXRpb24mJiFzZSYmbyYmdWUuZm9yRWFjaChmdW5jdGlvbih0KXtyLmFkZEFuaW1hdGlvblN0YXRlKHt0YXJnZXQ6dCxyZWN0OmxlfSksdC5mcm9tUmVjdD1sZSx0LnRoaXNBbmltYXRpb25EdXJhdGlvbj1udWxsfSkpOnIuX3Nob3dDbG9uZShuKSkpfSxkcmFnT3ZlckFuaW1hdGlvbkNhcHR1cmU6ZnVuY3Rpb24odCl7dmFyIGU9dC5kcmFnUmVjdCxuPXQuaXNPd25lcix0PXQuYWN0aXZlU29ydGFibGU7Y2UuZm9yRWFjaChmdW5jdGlvbih0KXt0LnRoaXNBbmltYXRpb25EdXJhdGlvbj1udWxsfSksdC5vcHRpb25zLmFuaW1hdGlvbiYmIW4mJnQubXVsdGlEcmFnLmlzTXVsdGlEcmFnJiYobGU9YSh7fSxlKSxlPXYoYWUsITApLGxlLnRvcC09ZS5mLGxlLmxlZnQtPWUuZSl9LGRyYWdPdmVyQW5pbWF0aW9uQ29tcGxldGU6ZnVuY3Rpb24oKXtoZSYmKGhlPSExLGdlKCkpfSxkcm9wOmZ1bmN0aW9uKHQpe3ZhciBlPXQub3JpZ2luYWxFdmVudCxuPXQucm9vdEVsLG89dC5wYXJlbnRFbCxpPXQuc29ydGFibGUscj10LmRpc3BhdGNoU29ydGFibGVFdmVudCxhPXQub2xkSW5kZXgsbD10LnB1dFNvcnRhYmxlLHM9bHx8dGhpcy5zb3J0YWJsZTtpZihlKXt2YXIgYyx1LGQsaD10aGlzLm9wdGlvbnMsZj1vLmNoaWxkcmVuO2lmKCFmZSlpZihoLm11bHRpRHJhZ0tleSYmIXRoaXMubXVsdGlEcmFnS2V5RG93biYmdGhpcy5fZGVzZWxlY3RNdWx0aURyYWcoKSxJKGFlLGguc2VsZWN0ZWRDbGFzcywhfmNlLmluZGV4T2YoYWUpKSx+Y2UuaW5kZXhPZihhZSkpY2Uuc3BsaWNlKGNlLmluZGV4T2YoYWUpLDEpLGllPW51bGwsVyh7c29ydGFibGU6aSxyb290RWw6bixuYW1lOlwiZGVzZWxlY3RcIix0YXJnZXRFbDphZSxvcmlnaW5hbEV2dDplfSk7ZWxzZXtpZihjZS5wdXNoKGFlKSxXKHtzb3J0YWJsZTppLHJvb3RFbDpuLG5hbWU6XCJzZWxlY3RcIix0YXJnZXRFbDphZSxvcmlnaW5hbEV2dDplfSksZS5zaGlmdEtleSYmaWUmJmkuZWwuY29udGFpbnMoaWUpKXt2YXIgcD1CKGllKSx0PUIoYWUpO2lmKH5wJiZ+dCYmcCE9PXQpZm9yKHZhciBnLG09cDx0PyhnPXAsdCk6KGc9dCxwKzEpO2c8bTtnKyspfmNlLmluZGV4T2YoZltnXSl8fChJKGZbZ10saC5zZWxlY3RlZENsYXNzLCEwKSxjZS5wdXNoKGZbZ10pLFcoe3NvcnRhYmxlOmkscm9vdEVsOm4sbmFtZTpcInNlbGVjdFwiLHRhcmdldEVsOmZbZ10sb3JpZ2luYWxFdnQ6ZX0pKX1lbHNlIGllPWFlO3JlPXN9ZmUmJnRoaXMuaXNNdWx0aURyYWcmJihoZT0hMSwob1tqXS5vcHRpb25zLnNvcnR8fG8hPT1uKSYmMTxjZS5sZW5ndGgmJihjPWsoYWUpLHU9QihhZSxcIjpub3QoLlwiK3RoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzK1wiKVwiKSwhZGUmJmguYW5pbWF0aW9uJiYoYWUudGhpc0FuaW1hdGlvbkR1cmF0aW9uPW51bGwpLHMuY2FwdHVyZUFuaW1hdGlvblN0YXRlKCksZGV8fChoLmFuaW1hdGlvbiYmKGFlLmZyb21SZWN0PWMsY2UuZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgZTt0LnRoaXNBbmltYXRpb25EdXJhdGlvbj1udWxsLHQhPT1hZSYmKGU9aGU/ayh0KTpjLHQuZnJvbVJlY3Q9ZSxzLmFkZEFuaW1hdGlvblN0YXRlKHt0YXJnZXQ6dCxyZWN0OmV9KSl9KSksZ2UoKSxjZS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2ZbdV0/by5pbnNlcnRCZWZvcmUodCxmW3VdKTpvLmFwcGVuZENoaWxkKHQpLHUrK30pLGE9PT1CKGFlKSYmKGQ9ITEsY2UuZm9yRWFjaChmdW5jdGlvbih0KXt0LnNvcnRhYmxlSW5kZXghPT1CKHQpJiYoZD0hMCl9KSxkJiZyKFwidXBkYXRlXCIpKSksY2UuZm9yRWFjaChmdW5jdGlvbih0KXtUKHQpfSkscy5hbmltYXRlQWxsKCkpLHJlPXMpLChuPT09b3x8bCYmXCJjbG9uZVwiIT09bC5sYXN0UHV0TW9kZSkmJnVlLmZvckVhY2goZnVuY3Rpb24odCl7dC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodCl9KX19LG51bGxpbmdHbG9iYWw6ZnVuY3Rpb24oKXt0aGlzLmlzTXVsdGlEcmFnPWZlPSExLHVlLmxlbmd0aD0wfSxkZXN0cm95R2xvYmFsOmZ1bmN0aW9uKCl7dGhpcy5fZGVzZWxlY3RNdWx0aURyYWcoKSxmKGRvY3VtZW50LFwicG9pbnRlcnVwXCIsdGhpcy5fZGVzZWxlY3RNdWx0aURyYWcpLGYoZG9jdW1lbnQsXCJtb3VzZXVwXCIsdGhpcy5fZGVzZWxlY3RNdWx0aURyYWcpLGYoZG9jdW1lbnQsXCJ0b3VjaGVuZFwiLHRoaXMuX2Rlc2VsZWN0TXVsdGlEcmFnKSxmKGRvY3VtZW50LFwia2V5ZG93blwiLHRoaXMuX2NoZWNrS2V5RG93biksZihkb2N1bWVudCxcImtleXVwXCIsdGhpcy5fY2hlY2tLZXlVcCl9LF9kZXNlbGVjdE11bHRpRHJhZzpmdW5jdGlvbih0KXtpZighKHZvaWQgMCE9PWZlJiZmZXx8cmUhPT10aGlzLnNvcnRhYmxlfHx0JiZOKHQudGFyZ2V0LHRoaXMub3B0aW9ucy5kcmFnZ2FibGUsdGhpcy5zb3J0YWJsZS5lbCwhMSl8fHQmJjAhPT10LmJ1dHRvbikpZm9yKDtjZS5sZW5ndGg7KXt2YXIgZT1jZVswXTtJKGUsdGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MsITEpLGNlLnNoaWZ0KCksVyh7c29ydGFibGU6dGhpcy5zb3J0YWJsZSxyb290RWw6dGhpcy5zb3J0YWJsZS5lbCxuYW1lOlwiZGVzZWxlY3RcIix0YXJnZXRFbDplLG9yaWdpbmFsRXZ0OnR9KX19LF9jaGVja0tleURvd246ZnVuY3Rpb24odCl7dC5rZXk9PT10aGlzLm9wdGlvbnMubXVsdGlEcmFnS2V5JiYodGhpcy5tdWx0aURyYWdLZXlEb3duPSEwKX0sX2NoZWNrS2V5VXA6ZnVuY3Rpb24odCl7dC5rZXk9PT10aGlzLm9wdGlvbnMubXVsdGlEcmFnS2V5JiYodGhpcy5tdWx0aURyYWdLZXlEb3duPSExKX19LGEodCx7cGx1Z2luTmFtZTpcIm11bHRpRHJhZ1wiLHV0aWxzOntzZWxlY3Q6ZnVuY3Rpb24odCl7dmFyIGU9dC5wYXJlbnROb2RlW2pdO2UmJmUub3B0aW9ucy5tdWx0aURyYWcmJiF+Y2UuaW5kZXhPZih0KSYmKHJlJiZyZSE9PWUmJihyZS5tdWx0aURyYWcuX2Rlc2VsZWN0TXVsdGlEcmFnKCkscmU9ZSksSSh0LGUub3B0aW9ucy5zZWxlY3RlZENsYXNzLCEwKSxjZS5wdXNoKHQpKX0sZGVzZWxlY3Q6ZnVuY3Rpb24odCl7dmFyIGU9dC5wYXJlbnROb2RlW2pdLG49Y2UuaW5kZXhPZih0KTtlJiZlLm9wdGlvbnMubXVsdGlEcmFnJiZ+biYmKEkodCxlLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcywhMSksY2Uuc3BsaWNlKG4sMSkpfX0sZXZlbnRQcm9wZXJ0aWVzOmZ1bmN0aW9uKCl7dmFyIG49dGhpcyxvPVtdLGk9W107cmV0dXJuIGNlLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGU7by5wdXNoKHttdWx0aURyYWdFbGVtZW50OnQsaW5kZXg6dC5zb3J0YWJsZUluZGV4fSksZT1oZSYmdCE9PWFlPy0xOmhlP0IodCxcIjpub3QoLlwiK24ub3B0aW9ucy5zZWxlY3RlZENsYXNzK1wiKVwiKTpCKHQpLGkucHVzaCh7bXVsdGlEcmFnRWxlbWVudDp0LGluZGV4OmV9KX0pLHtpdGVtczpyKGNlKSxjbG9uZXM6W10uY29uY2F0KHVlKSxvbGRJbmRpY2llczpvLG5ld0luZGljaWVzOml9fSxvcHRpb25MaXN0ZW5lcnM6e211bHRpRHJhZ0tleTpmdW5jdGlvbih0KXtyZXR1cm5cImN0cmxcIj09PSh0PXQudG9Mb3dlckNhc2UoKSk/dD1cIkNvbnRyb2xcIjoxPHQubGVuZ3RoJiYodD10LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK3Quc3Vic3RyKDEpKSx0fX19KX0pLEJ0fSk7IiwiY29uc3QgbGlzdE1vZHVsZSA9IHJlcXVpcmUoJy4vbGlzdCcpO1xuY29uc3QgY2FyZE1vZHVsZSA9IHJlcXVpcmUoJy4vY2FyZCcpO1xuY29uc3QgdXRpbHNNb2R1bGUgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG5cblxuY29uc3QgYXBwID0ge1xuICAgIFxuICAgIGJhc2VVcmwgOiAnaHR0cHM6Ly9wcm9qZWN0LXRvZG9rYW5iYW4uaGVyb2t1YXBwLmNvbS86MzAzMC8nLFxuICAgIFxuICAgIFxuICAgIC8vVE9ETyBHUk9VUEVSIERBTlMgTEUgTUVNRSBQUk9KRVQgUVVFIExFIEJBQ0tcbiAgICAvL1RPRE8gRklOSVIgTEVTIFRBR1NcbiAgICBcbiAgICAvLyBmb25jdGlvbiBkJ2luaXRpYWxpc2F0aW9uLCBsYW5jw6llIGF1IGNoYXJnZW1lbnQgZGUgbGEgcGFnZVxuICAgIGluaXQ6ICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2FwcC5pbml0ICEnKTtcbiAgICAgICAgYXBwLmFkZExpc3RlbmVyVG9BY3Rpb25zKCk7XG4gICAgICAgIGxpc3RNb2R1bGUuc2V0VXJsKGFwcC5iYXNlVXJsKTtcbiAgICAgICAgY2FyZE1vZHVsZS5zZXRVcmwoYXBwLmJhc2VVcmwpO1xuICAgICAgICBsaXN0TW9kdWxlLmdldEFsbExpc3RzRnJvbUFQSSgpO1xuXG5cbiAgICB9LFxuICAgXG5cblxuICAgIGFkZExpc3RlbmVyVG9BY3Rpb25zOiAoKSA9PiB7XG5cbiAgICAgICAgLy9FdmVudCBjbGljayBzdXIgYWpvdXRlciB1bmUgbGlzdGVcbiAgICAgICAgY29uc3QgYWRkTGlzdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGRMaXN0QnV0dG9uJyk7XG4gICAgICAgIGFkZExpc3RCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhZGRMaXN0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkTGlzdE1vZGFsJyk7XG4gICAgICAgICAgICBhZGRMaXN0TW9kYWwuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vRXZlbnQgcG91ciByw6ljdXDDqXJlciBsYSBkYXRhIGR1IGZvcm11bGFpcmUgTW9kYWwgTGlzdFxuICAgICAgICBjb25zdCBhZGRMaXN0TW9kYWxGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZExpc3RNb2RhbEZvcm0nKTtcbiAgICAgICAgYWRkTGlzdE1vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBsaXN0TW9kdWxlLmhhbmRsZUFkZExpc3RGb3JtKTtcbiAgICAgICAgXG4gICAgICAgIC8vQWN0aW9uIHBvdXIgcsOpY3Vww6lyZXIgbGUgZm9ybXVsYWlyZSBNb2RhbCBDYXJkXG4gICAgICAgIGNvbnN0IGFkZENhcmRNb2RhbEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkQ2FyZE1vZGFsRm9ybScpO1xuICAgICAgICBhZGRDYXJkTW9kYWxGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGNhcmRNb2R1bGUuaGFuZGxlQWRkQ2FyZEZvcm0pO1xuICAgICAgICBcbiAgICAgICAgLy9FdmVudCBwb3VyIGZlcm1lciBsZXMgbW9kYWxzXG4gICAgICAgIGNvbnN0IHJlbW92ZUJ1dHRvbnNNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jbG9zZSwgLm1vZGFsLWJhY2tncm91bmQnKTtcbiAgICAgICAgcmVtb3ZlQnV0dG9uc01vZGFsLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHV0aWxzTW9kdWxlLmhpZGVNb2RhbHMpO1xuICAgICAgICB9KTtcblxuICAgIH0sXG5cbiAgIFxufTsgXG5cblxuLy8gb24gYWNjcm9jaGUgdW4gw6ljb3V0ZXVyIGQnw6l2w6huZW1lbnQgc3VyIGxlIGRvY3VtZW50IDogcXVhbmQgbGUgY2hhcmdlbWVudCBlc3QgdGVybWluw6ksIG9uIGxhbmNlIGFwcC5pbml0XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgYXBwLmluaXQpOyIsImNvbnN0IHV0aWxzTW9kdWxlID0gcmVxdWlyZSgnLi91dGlscycpO1xuY29uc3QgU29ydGFibGUgPSByZXF1aXJlKCdzb3J0YWJsZWpzJyk7XG5cbmNvbnN0IGNhcmRNb2R1bGUgPSB7XG5cbiAgICB1cmw6IG51bGwsXG4gICAgc2V0VXJsOiAoYmFzZVVybCkgPT4ge1xuICAgICAgICBjYXJkTW9kdWxlLnVybCA9IGJhc2VVcmwgKyAnY2FyZHMnO1xuICAgIH0sXG5cblxuICAgIGRlbGV0ZUNhcmRUb0FQSSA6IGFzeW5jIChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCBjYXJkID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5ib3gnKTtcbiAgICAgICAgY29uc3QgY2FyZElkID0gY2FyZC5kYXRhc2V0LmNhcmRJZDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZmV0Y2goYCR7Y2FyZE1vZHVsZS51cmx9LyR7Y2FyZElkfWAsIHtcbiAgICAgICAgICAgICAgICBtZXRob2QgOiAnREVMRVRFJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcmVzdWx0Lmpzb24oKTtcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH07XG4gICAgfSxcblxuICAgIC8vQWpvdXRlIGxhIGNsYXNzZSAnaXMtYWN0aXZlJyBwb3VyIGFmZmljaGVyIGxlIE1vZGFsXG4gICAgc2hvd0FkZENhcmRNb2RhbDooZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZENhcmRNb2RhbCcpO1xuICAgICAgICBhZGRDYXJkTW9kYWwuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XG4gICAgICAgIC8vUsOpY3Vww6lyZSBsJ2lucHV0IGhpZGRlbiBkdSBmb3JtIGRlIGxhIGNhcmQgbW9kYWwgcXVpIGRvaXQgY29udGVuaXJcbiAgICAgICAgLy8gbCdpZCBkZSBsYSBsaXN0ZVxuICAgICAgICBjb25zdCBoaWRkZW5JbnB1dElkID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJsaXN0X2lkXCJdJyk7XG4gICAgICAgIC8vUsOpY3Vww6lyZSBsJ8OpbMOpbWVudCBkJ291IHZpZW50IGwnZXZlbnQgZXQgZXh0cmFjdGlvbiBkZSBzb24gZGF0YXNldFxuICAgICAgICBjb25zdCBsaXN0SWQgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLnBhbmVsJykuZGF0YXNldC5saXN0SWQ7XG4gICAgICAgIC8vQXR0cmlidXRpb24gZGUgbGlzdElkIGNvbW1lIHZhbHVlIGRlIGwnaW5wdXRcbiAgICAgICAgaGlkZGVuSW5wdXRJZC52YWx1ZSA9IGxpc3RJZDtcbiAgICB9LFxuXG4gICAgc2hvd0VkaXRDYXJkRm9ybSA6IChldmVudCkgPT4ge1xuICAgICAgICAvL0NhY2hlIGxlIHRleHQgZXQgYWZmaWNoZSBsZSBmb3JtXG4gICAgICAgIGNvbnN0IGNhcmQgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLmJveCcpO1xuICAgICAgICB1dGlsc01vZHVsZS5zaG93QW5kSGlkZShjYXJkLCAnI25hbWVDYXJkJywgJyNlZGl0Q2FyZEZvcm0nKVxuXG4gICAgICAgIFxuICAgICAgICAvL0N1c3RvbSBub20gZGUgbGEgY2FyZCBkYW5zIGxlIGZvcm0gZXQgc2VsZWN0XG4gICAgICAgIGNvbnN0IGNhcmROYW1lID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5ib3gnKS5xdWVyeVNlbGVjdG9yKCcjbmFtZUNhcmQnKTtcbiAgICAgICAgY29uc3QgdGl0bGVDYXJkID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5ib3gnKS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwidGl0bGVcIl0nKTtcbiAgICAgICAgdGl0bGVDYXJkLnZhbHVlID0gY2FyZE5hbWUudGV4dENvbnRlbnQ7XG4gICAgICAgIHRpdGxlQ2FyZC5zZWxlY3QoKTtcblxuICAgICAgICAvL2FmZmljaGFnZSBkZSBsYSBjb3VsZXVyIGFjdHVlbGxlIGRhbnMgbGUgZm9ybVxuICAgICAgICBjb25zdCBkaXYgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLmJveCcpO1xuICAgICAgICAvL3LDqWN1cMOpcmUgbGEgY291bGV1ciBhY3R1ZWxsZSBkZSBsYSBjYXJ0ZVxuICAgICAgICBjb25zdCBjb2xvciA9IGRpdi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgIC8vcHVpcyBvbiBtb2RpZmllIGxhIHZhbHVlIGRlIGwnaW5wdXQgY29sb3IgXG4gICAgICAgIGNvbnN0IGNvbG9yQ2FyZCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCcuYm94JykucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImNvbG9yXCJdJyk7XG4gICAgICAgIGNvbG9yQ2FyZC52YWx1ZSA9IHV0aWxzTW9kdWxlLlJHQlRvSGV4KGNvbG9yKVxuICAgIFxuICAgICAgICBcbiAgICB9LFxuXG4gICAgLy9Sw6ljdXDDqXJhdGlvbiBkZXMgZGF0ZSBkdSBmb3JtIGFkZENhcmRcbiAgICBoYW5kbGVBZGRDYXJkRm9ybTogYXN5bmMgKGV2ZW50KSA9PiB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIFxuICAgICAgICAvL2xvcnMgZGUgbGEgY3LDqWF0aW9uIGRlIGxhIG5vdXZlbGxlIGNhcnRlLCBvbiBmYWl0IMOpdm9sdWVyIGxlcyBwb3NpdGlvbnMgZGVzXG4gICAgICAgIC8vY2FydGVzIGV4aXN0YW50ZXMgZW4gaW5jcsOpbWVuZGFudCArMSBldCBQQVRDSCB2ZXJzIGwnQVBJXG4gICAgICAgIC8vcsOpY3Vww6kgbCdpZCBkZSBsYSBsaXN0ZVxuICAgICAgICBjb25zdCBsaXN0SWQgPSBPYmplY3QuZnJvbUVudHJpZXMobmV3IEZvcm1EYXRhKGV2ZW50LnRhcmdldCkpLmxpc3RfaWQ7XG4gICAgICAgIC8vcsOpY3Vww6lyZSBkJ2Fib3JkIGxhIGxpc3RlXG4gICAgICAgIGNvbnN0IGxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1saXN0LWlkPVwiJHtsaXN0SWR9XCJdYCk7XG4gICAgICAgIC8vcHVpcyBsZXMgY2FydGVzIGRlIGxhIGxpc3RlXG4gICAgICAgIGNvbnN0IGNhcmRzID0gbGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuYm94Jyk7XG4gICAgICAgIGNhcmRzLmZvckVhY2goIGFzeW5jKGNhcmQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uSWQgPSBOdW1iZXIoY2FyZC5kYXRhc2V0LnBvc2l0aW9uSWQpO1xuICAgICAgICAgICAgY2FyZC5kYXRhc2V0LnBvc2l0aW9uSWQgPSBwb3NpdGlvbklkICsgMTtcbiAgICAgICAgICAgIGNvbnN0IGNhcmRJZCA9IGNhcmQuZGF0YXNldC5jYXJkSWQ7XG4gICAgICAgICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdwb3NpdGlvbicsIGNhcmQuZGF0YXNldC5wb3NpdGlvbklkKTtcbiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnbGlzdF9pZCcsIGxpc3RJZCk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZmV0Y2goYCR7Y2FyZE1vZHVsZS51cmx9LyR7Y2FyZElkfWAsIHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kIDogJ1BBVENIJyxcbiAgICAgICAgICAgICAgICAgICAgYm9keSA6IGZvcm1EYXRhLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXN1bHQuanNvbigpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSk7XG4gICAgICAgXG4gICAgICAgIC8vY3LDqWF0aW9uIGRlIGxhIG5vdXZlbGxlIGNhcnRlXG4gICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGV2ZW50LnRhcmdldCk7XG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZCgncG9zaXRpb24nLCAwKTtcbiAgICAgICAgLy8gY29uc3QgZm9ybU9iamVjdCA9IE9iamVjdC5mcm9tRW50cmllcyhmb3JtRGF0YSk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGZvcm1PYmplY3QpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmZXRjaChgJHtjYXJkTW9kdWxlLnVybH1gLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kIDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGJvZHkgOiBmb3JtRGF0YSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3VsdC5qc29uKCk7XG5cbiAgICAgICAgICAgIGNhcmRNb2R1bGUubWFrZUNhcmRJbkRPTShkYXRhKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgLy9GZXJtZSBsZSBmb3JtXG4gICAgICAgIHV0aWxzTW9kdWxlLmhpZGVNb2RhbHMoKTtcbiAgICB9LFxuXG4gICAgLy9Tb3VtaXNzaW9uIGR1IGZvcm0gZWRpdCBjYXJkXG4gICAgaGFuZGxlRWRpdENhcmRGb3JtIDogYXN5bmMgKGV2ZW50KSA9PiB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGV2ZW50LnRhcmdldCk7XG4gICAgICAgIC8vIGNvbnN0IG9iamVjdCA9IE9iamVjdC5mcm9tRW50cmllcyhmb3JtRGF0YSk7XG4gICAgICAgIGNvbnN0IGNhcmQgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLmJveCcpO1xuICAgICAgICBjb25zdCBjYXJkSWQgPSBjYXJkLmRhdGFzZXQuY2FyZElkO1xuXG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZldGNoKGAke2NhcmRNb2R1bGUudXJsfS8ke2NhcmRJZH1gLCB7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZCA6ICdQQVRDSCcsXG4gICAgICAgICAgICAgICAgICAgIGJvZHkgOiBmb3JtRGF0YSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXN1bHQuanNvbigpO1xuICAgICAgICAgICAgLy9tYWogZHUgdGl0bGUgZGUgbGEgY2FyZFxuICAgICAgICAgICAgY2FyZC5xdWVyeVNlbGVjdG9yKCcjbmFtZUNhcmQnKS50ZXh0Q29udGVudCA9IGRhdGEudGl0bGU7XG4gICAgICAgICAgICBjYXJkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGAke2RhdGEuY29sb3J9YDtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgdXRpbHNNb2R1bGUuc2hvd0FuZEhpZGUoY2FyZCwgJyNlZGl0Q2FyZEZvcm0nLCAnI25hbWVDYXJkJylcbiAgICAgICBcbiAgICB9LFxuXG4gICAgIC8vQ3LDqWF0aW9uIGRlIGxhIG5vdXZlbGxlIGNhcmRcbiAgICAgbWFrZUNhcmRJbkRPTTogKG9iamVjdCkgPT4ge1xuXG4gICAgICAgIC8vQ2xvbmUgbGUgdGVtcGxhdGVcbiAgICAgICAgY29uc3QgY2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXJkVGVtcGxhdGUnKS5jb250ZW50LmZpcnN0Q2hpbGQ7XG4gICAgICAgIGNvbnN0IG5ld0NhcmQgPSBjYXJkLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgLy9Sw6ljdXDDqXJlIGxlcyBkb25uw6llcyBkZSBub3RyZSBmb3JtdWxhaXJlIHBvdXIgbGVzIGluamVjdGVyIGRhbnMgbGUgdGVtcGxhdGVcbiAgICAgICAgY29uc3QgbmFtZUNhcmQgPSBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJyNuYW1lQ2FyZCcpO1xuICAgICAgICBuYW1lQ2FyZC50ZXh0Q29udGVudCA9IG9iamVjdC50aXRsZTtcbiAgICAgICAgLy9Sw6ljdXDDqXJlIGwnZWxlbWVudCBwb3VyIGNoYW5nZXIgbGEgY291bGV1ciBcbiAgICAgICAgbmV3Q2FyZC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBgJHtvYmplY3QuY29sb3J9YDtcblxuICAgICAgICAvL2Rvbm5lIMOgIGxhIGNhcnRlIHNvbiBpZFxuICAgICAgICBuZXdDYXJkLmRhdGFzZXQuY2FyZElkID0gb2JqZWN0LmlkO1xuICAgICAgICAvL2Rvbm5lIGxhIHBvc2l0aW9uIMOgIGxhIGNhcmQgYXVzc2lcbiAgICAgICAgbmV3Q2FyZC5kYXRhc2V0LnBvc2l0aW9uSWQgPSBvYmplY3QucG9zaXRpb247XG4gICAgICAgIFxuICAgICAgICAvL1LDqWN1cMOpcmUgbGEgbGlzdGUgY29ycmVzcG9uZGFudCDDoCBsJ2lkIGR1IGZvcm11bGFpcmVcbiAgICAgICAgY29uc3QgbGlzdERpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWxpc3QtaWQ9XCIke29iamVjdC5saXN0X2lkfVwiXWApO1xuICAgICAgICAvL1LDqWN1cMOpcmUgbGEgZGl2IHBhcmVudGUgb3UgaW5zw6lyZXIgbGEgY2FydGVcbiAgICAgICAgY29uc3QgcGFyZW50RGl2ID0gbGlzdERpdi5xdWVyeVNlbGVjdG9yKCcuaGFzLWJhY2tncm91bmQtbGlnaHQnKVxuICAgICAgICBwYXJlbnREaXYuaW5zZXJ0QmVmb3JlKG5ld0NhcmQsIHBhcmVudERpdi5maXJzdENoaWxkKTtcbiAgICAgICAgXG4gICAgICAgIC8vRXZlbnQgZWRpdGlvbiBkZXMgY2FyZHMgKGNsaWNrIGljb25lIGNyYXlvbilcbiAgICAgICAgY29uc3QgZWRpdENhcmRCdXR0b24gPSBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5lZGl0Q2FyZEJ1dHRvbicpO1xuICAgICAgICBlZGl0Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNhcmRNb2R1bGUuc2hvd0VkaXRDYXJkRm9ybSk7XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgLy9FdmVudCBDbGljayBpY29uZSBwb3ViZWxsZSBjYXJkXG4gICAgICAgIGNvbnN0IGRlbENhcmRCdXR0b24gPSBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5kZWxDYXJkQnV0dG9uJyk7XG4gICAgICAgIGRlbENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjYXJkTW9kdWxlLmRlbGV0ZUNhcmRUb0FQSSlcblxuXG4gICAgICAgIC8vIGV2ZW50IHN1ciBmb3JtIGVkaXQgbGlzdFxuICAgICAgICAvLyBWYWxpZGF0aW9uIGR1IGZvcm0gZWRpdCBjYXJkXG4gICAgICAgIGNvbnN0IGVkaXRDYXJkc0Zvcm0gPSBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJyNlZGl0Q2FyZEZvcm0nKTtcbiAgICAgICAgZWRpdENhcmRzRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBjYXJkTW9kdWxlLmhhbmRsZUVkaXRDYXJkRm9ybSk7XG4gICAgICAgIC8vQXBwdWllIEVDSEFQXG4gICAgICAgIGVkaXRDYXJkc0Zvcm0uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldmVudCk9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuY29kZSA9PSAnRXNjYXBlJykge1xuXG4gICAgICAgICAgICAgICAgdXRpbHNNb2R1bGUuc2hvd0FuZEhpZGUobmV3Q2FyZCwgJyNlZGl0Q2FyZEZvcm0nLCAnI25hbWVDYXJkJylcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy9BcHB1aWUgYXV0cmUgcGFydFxuICAgICAgICBlZGl0Q2FyZHNGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9lc3NhaXMgZGUgc29ydGFibGVcbiAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGFzLWJhY2tncm91bmQtbGlnaHQnKTtcbiAgICAgICAgY29uc3Qgc29ydGFibGUgPSBTb3J0YWJsZS5jcmVhdGUoZWwsIHsgIFxuICAgICAgICAgICAgZ3JvdXAgOiAnY2FyZHMnLFxuICAgICAgICAgICAgZGF0YUlkQXR0cjogJ2RhdGEtY2FyZC1pZCcsLy8gY2hvaXNpdCBxdWVsIGVsZW1lbnQgbm91cyBkb25uZSB1biBpZFxuICAgICAgICAgICAgLy9wZXJtZXQgZGUgbmUgcGFzIGRyYWcgc3VyIGxlIGZvcm0gZXQgZGUgcG91dm9pciBlaWR0ZXIgbGUgdGV4dGVcbiAgICAgICAgICAgIGZpbHRlcjogJy5ub3Qtc29ydGFibGUnLFxuICAgICAgICAgICAgcHJldmVudE9uRmlsdGVyOiBmYWxzZSwgXG4gICAgICAgICAgICBcblxuICAgICAgICAgICAgb25FbmQ6IGFzeW5jIChldnQpID0+IHsgICAvLyBldmVudCDDoCBsYSBmaW4gZHUgZHJhZ1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEdyb3VwID0gZXZ0LnRvO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9yaWdpbkdyb3VwID0gZXZ0LmZyb207XG5cbiAgICAgICAgICAgICAgICBsZXQgY2FyZHMgPSBvcmlnaW5Hcm91cC5xdWVyeVNlbGVjdG9yQWxsKCcuYm94Jyk7XG4gICAgICAgICAgICAgICAgY2FyZHMuZm9yRWFjaCggYXN5bmMgKGNhcmQsIHBvc2l0aW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gY2FyZC5kYXRhc2V0LmNhcmRJZDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gb24gZW52b2llIGxhIHBvc2l0aW9uIGF1IGZvcm1EYXRhXG4gICAgICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgncG9zaXRpb24nLCBwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmZXRjaChgJHtjYXJkTW9kdWxlLnVybH0vJHtpZH1gLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kIDogJ1BBVENIJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib2R5IDogZm9ybURhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBhcyBkZSBtYWogZHUgZnJvbnQgcHVpc3F1ZSBjJ2VzdCBsZSBmcm9udCBxdWkgZW52b2llIGwnaW5mbyBhIGwnQVBJXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmIChvcmlnaW5Hcm91cCA9PT0gdGFyZ2V0R3JvdXApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBjYXJkcyA9IHRhcmdldEdyb3VwLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ib3gnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaXN0X2lkID0gdGFyZ2V0R3JvdXAuY2xvc2VzdCgnLnBhbmVsJykuZGF0YXNldC5saXN0SWQ7XG4gICAgICAgICAgICAgICAgY2FyZHMuZm9yRWFjaCggYXN5bmMgKGNhcmQsIHBvc2l0aW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gY2FyZC5kYXRhc2V0LmNhcmRJZDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdwb3NpdGlvbicscG9zaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2xpc3RfaWQnLGxpc3RfaWQpO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZmV0Y2goYCR7Y2FyZE1vZHVsZS51cmx9LyR7aWR9YCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZCA6ICdQQVRDSCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keSA6IGZvcm1EYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwYXMgZGUgbWFqIGR1IGZyb250IHB1aXNxdWUgYydlc3QgbGUgZnJvbnQgcXVpIGVudm9pZSBsJ2luZm8gYSBsJ0FQSVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgXG4gICAgICAgIH0pO1xuICAgIH0sXG5cblxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNhcmRNb2R1bGU7IiwiY29uc3QgY2FyZE1vZHVsZSA9IHJlcXVpcmUoJy4vY2FyZCcpO1xuY29uc3QgdXRpbHNNb2R1bGUgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG5jb25zdCBTb3J0YWJsZSA9IHJlcXVpcmUoJ3NvcnRhYmxlanMnKTtcblxuXG5cbmNvbnN0IGxpc3RNb2R1bGUgPSB7XG5cbiAgICB1cmw6IG51bGwsXG4gICAgc2V0VXJsOiAoYmFzZVVybCkgPT4ge1xuICAgICAgICBsaXN0TW9kdWxlLnVybCA9IGJhc2VVcmwgKyAnbGlzdHMnO1xuICAgIH0sXG5cblxuICAgIGdldEFsbExpc3RzRnJvbUFQSTogYXN5bmMgKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZmV0Y2goYCR7bGlzdE1vZHVsZS51cmx9YCwge1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzdWx0Lmpzb24oKTtcbiAgICAgICBcbiAgICAgICAgICAgIGZvciAobGV0IGxpc3Qgb2YgZGF0YSkge1xuICAgICAgICAgICAgICAgIGxpc3RNb2R1bGUubWFrZUxpc3RJbkRPTShsaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjYXJkIG9mIGxpc3QuY2FyZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRNb2R1bGUubWFrZUNhcmRJbkRPTShjYXJkKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICBkZWxldGVMaXN0VG9BUEkgOiBhc3luYyAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgbGlzdCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCcucGFuZWwnKTtcbiAgICAgICAgY29uc3QgbGlzdElkID0gbGlzdC5kYXRhc2V0Lmxpc3RJZDtcblxuICAgICAgICBjb25zdCBsaXN0TmFtZSA9IGxpc3QucXVlcnlTZWxlY3RvcignaDInKS50ZXh0Q29udGVudDtcbiAgICAgICAgaWYgKCF3aW5kb3cuY29uZmlybShgU3VwcHJpbWVyIGxhIGxpc3RlICR7bGlzdE5hbWV9ID9gKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZmV0Y2goYCR7bGlzdE1vZHVsZS51cmx9LyR7bGlzdElkfWAsIHtcbiAgICAgICAgICAgICAgICBtZXRob2QgOiAnREVMRVRFJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzdWx0Lmpzb24oKTtcbiAgICAgICAgICAgIGxpc3QucmVtb3ZlKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH07XG4gICAgfSxcblxuICAgIC8vQWpvdXRlIGxhIGNsYXNzICdpcy1hY3RpdmUnIHBvdXIgYWZmaWNoZXIgbGUgTW9kYWxcbiAgICBzaG93QWRkTGlzdE1vZGFsOiAoKSA9PiB7XG4gICAgICAgIFxuICAgICAgICAvL1LDqWN1cMOpcmUgbCdlbGVtZW50IGR1IGZvcm11bGFpcmUgY29udGVuYW50IGlucHV0IGhpZGRlblxuICAgICAgICBjb25zdCBoaWRkZW5JbnB1dElkID0gYWRkTGlzdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJsaXN0SWRcIl0nKTtcbiAgICAgICAgIC8vQXR0cmlidXRpb24gZGUgbGlzdElkIGNvbW1lIHZhbHVlIGRlIGwnaW5wdXRcbiAgICB9LFxuXG4gICAgLy8gT3BlbiBmb3JtIGVkaXQgbGlzdCBhbmQgY2xvc2UgdGl0bGVcbiAgICBzaG93RWRpdExpc3RGb3JtOiAoZXZlbnQpID0+IHtcblxuICAgICAgICAvL0NhY2hlIGxlIHRleHQgZXQgb24gYWZmaWNoZSBsZSBmb3JtXG4gICAgICAgIGNvbnN0IGxpc3QgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLnBhbmVsJyk7XG4gICAgICAgIHV0aWxzTW9kdWxlLnNob3dBbmRIaWRlKGxpc3QsICdoMicsICdmb3JtJyk7XG5cbiAgICAgICAgLy9DdXN0b20gbm9tIGRlIGxhIGxpc3QgZGFucyBsZSBmb3JtIGV0IHNlbGVjdFxuICAgICAgICBjb25zdCB0aXRsZUxpc3QgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnZGl2JykucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cIm5hbWVcIl0nKTtcbiAgICAgICAgdGl0bGVMaXN0LnZhbHVlID0gZXZlbnQudGFyZ2V0LnRleHRDb250ZW50O1xuICAgICAgICB0aXRsZUxpc3Quc2VsZWN0KCk7XG4gICAgfSxcblxuICAgIC8vUGVybWV0IGRlIHLDqWN1cMOpcmVyIGxlcyBpbmZvcm1hdGlvbnMgZHUgZm9ybXVsYWlyZSBBZGRMaXN0XG4gICAgaGFuZGxlQWRkTGlzdEZvcm06IGFzeW5jIChldmVudCkgPT4ge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgIFxuICAgICAgICAvL2xvcnMgZGUgbGEgY3LDqWF0aW9uIGQndW5lIG5vdXZlbGxlID0+IGluY3LDqW1lbnRhdGlvbiBkZSArMSBkZXMgcG9zaXRpb25zXG4gICAgICAgIC8vIGRlcyBsaXN0ZXMgZXhpc3RhbnRlcyBldCBhdmFudCBtb2RpZiB2ZXJzIGwnQVBJXG4gICAgICAgIGNvbnN0IGxpc3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBhbmVsJyk7XG4gICAgICAgIGxpc3RzLmZvckVhY2goIGFzeW5jKGxpc3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uSWQgPSBOdW1iZXIobGlzdC5kYXRhc2V0LnBvc2l0aW9uSWQpO1xuICAgICAgICAgICAgbGlzdC5kYXRhc2V0LnBvc2l0aW9uSWQgPSBwb3NpdGlvbklkICsgMTtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RJZCA9IGxpc3QuZGF0YXNldC5saXN0SWQ7XG4gICAgICAgICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdwb3NpdGlvbicsIGxpc3QuZGF0YXNldC5wb3NpdGlvbklkKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmZXRjaChgJHtsaXN0TW9kdWxlLnVybH0vJHtsaXN0SWR9YCwge1xuICAgICAgICAgICAgICAgICAgICBtZXRob2QgOiAnUEFUQ0gnLFxuICAgICAgICAgICAgICAgICAgICBib2R5IDogZm9ybURhdGEsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3VsdC5qc29uKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICB9KTtcbiAgICAgICBcbiAgICAgICAgLy9jcsOpYXRpb24gZGUgbGEgbm91dmVsbGUgbGlzdGUgZW4gcG9zaXRpb24gMFxuICAgICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShldmVudC50YXJnZXQpO1xuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3Bvc2l0aW9uJywwKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZldGNoKGAke2xpc3RNb2R1bGUudXJsfWAsIHtcbiAgICAgICAgICAgICAgICBtZXRob2QgOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgYm9keSA6IGZvcm1EYXRhLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXN1bHQuanNvbigpO1xuICAgICAgICAgICAgLy9DcsOpZSBsYSBsaXN0ZSBhdmVjIGxlcyBkb25uw6llc1xuICAgICAgICAgICAgbGlzdE1vZHVsZS5tYWtlTGlzdEluRE9NKGRhdGEpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAvL0Zlcm1lIGxlIGZvcm1cbiAgICAgICAgdXRpbHNNb2R1bGUuaGlkZU1vZGFscygpO1xuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgIFxuICAgIH0sXG5cbiAgICAvL1NvdW1pc3Npb24gZHUgZm9ybSBlZGl0IGxpc3RcbiAgICBoYW5kbGVFZGl0TGlzdEZvcm06IGFzeW5jIChldmVudCkgPT4ge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShldmVudC50YXJnZXQpO1xuXG4gICAgICAgIGNvbnN0IGxpc3QgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLnBhbmVsJyk7XG4gICAgICAgIGNvbnN0IGxpc3RJZCA9IGxpc3QuZGF0YXNldC5saXN0SWQ7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZldGNoKGAke2xpc3RNb2R1bGUudXJsfS8ke2xpc3RJZH1gLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kIDogJ1BBVENIJyxcbiAgICAgICAgICAgICAgICBib2R5IDogZm9ybURhdGEsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXN1bHQuanNvbigpO1xuICAgICAgICAgICAgLy9tYWogZHUgdGl0cmUgZGUgbGEgbGlzdGVcbiAgICAgICAgICAgIGxpc3QucXVlcnlTZWxlY3RvcignaDInKS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICB1dGlsc01vZHVsZS5zaG93QW5kSGlkZShsaXN0LCAnZm9ybScsICdoMicpO1xuXG4gICAgfSxcblxuICAgIC8vQ3LDqWF0aW9uIGRlIGxhIG5vdXZlbGxlIGxpc3RlXG4gICAgbWFrZUxpc3RJbkRPTSA6IChkYXRhKSA9PiB7XG4gICAgIFxuICAgICAgICBcbiAgICAgICAgLy9PbiBjbG9uZSBub3RyZSB0ZW1wbGF0ZVxuICAgICAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpc3RUZW1wbGF0ZScpLmNvbnRlbnQuZmlyc3RDaGlsZDtcbiAgICAgICAgY29uc3QgbmV3TGlzdCA9IGxpc3QuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICAvL1LDqWN1cMOpcmUgbGUgbmFtZSBkYW5zIGxlIGZvcm11bG1haXJlIHBvdXIgbm9tbWVyIG5vdHJlIGxpc3RlXG4gICAgICAgIGNvbnN0IG5hbWVMaXN0ID0gbmV3TGlzdC5xdWVyeVNlbGVjdG9yKCdoMicpO1xuICAgICAgICBuYW1lTGlzdC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTsgIFxuICAgICAgICAvL0Rvbm5lIGwnaWQgYSBsYSBub3V2ZWxsZSBsaXN0XG4gICAgICAgIG5ld0xpc3QuZGF0YXNldC5saXN0SWQgPSBkYXRhLmlkO1xuICAgICAgICAvL2Rvbm5lIGxhIHBvc2l0aW9uIMOgIGxhIGxpc3RlIGF1c3NpXG4gICAgICAgIG5ld0xpc3QuZGF0YXNldC5wb3NpdGlvbklkID0gZGF0YS5wb3NpdGlvbjtcblxuXG4gICAgICAgIC8vSW5zw6lyZSBldCBhZmZpY2hlIG5vdHJlIG5vdXZlbGxlIGxpc3RlXG4gICAgICAgIGNvbnN0IHBhcmVudERpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkLWxpc3RzJyk7XG4gICAgICAgIHBhcmVudERpdi5pbnNlcnRCZWZvcmUobmV3TGlzdCwgcGFyZW50RGl2LmZpcnN0Q2hpbGQpO1xuXG4gICAgICAgIFxuICAgICAgICAvL2V2ZW50IHN1ciBsZSBib3V0b24gcGx1cyBwb3VyIGFqb3V0ZXIgdW5lIGNhcmRcbiAgICAgICAgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmlzLXB1bGxlZC1sZWZ0Jyk7XG4gICAgICAgIGFkZENhcmRNb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNhcmRNb2R1bGUuc2hvd0FkZENhcmRNb2RhbCk7XG4gICAgICAgIC8vZXZlbnQgZG91YmxlIGNsaWNrIHN1ciBsZSBub20gcG91ciDDqWRpdGVyIGxlcyBsaXN0ZXNcbiAgICAgICAgbmFtZUxpc3QuYWRkRXZlbnRMaXN0ZW5lcignZGJsY2xpY2snLCBsaXN0TW9kdWxlLnNob3dFZGl0TGlzdEZvcm0pO1xuICAgICAgICAvLyBldmVudCBzdXIgZm9ybSBlZGl0IGxpc3RcbiAgICAgICAgLy9WYWxpZGF0aW9uIGR1IGZvcm1cbiAgICAgICAgY29uc3QgZWRpdExpc3RzRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNlZGl0TGlzdEZvcm0nKTtcbiAgICAgICAgZWRpdExpc3RzRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBsaXN0TW9kdWxlLmhhbmRsZUVkaXRMaXN0Rm9ybSk7XG4gICAgICAgIC8vQXBwdWllIEVDSEFQXG4gICAgICAgIGVkaXRMaXN0c0Zvcm0uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldmVudCk9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuY29kZSA9PSAnRXNjYXBlJykge1xuXG4gICAgICAgICAgICAgICAgdXRpbHNNb2R1bGUuc2hvd0FuZEhpZGUobmV3TGlzdCwgJ2Zvcm0nLCAnaDInKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvL0FwcHVpZSBhdXRyZSBwYXJ0XG4gICAgICAgIGVkaXRMaXN0c0Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2V2ZW50IGNsaWNrIGRlbGV0ZSBidXR0b24gbGlzdFxuICAgICAgICBjb25zdCBkZWxMaXN0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlbExpc3RCdXR0b24nKTtcbiAgICAgICAgZGVsTGlzdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGxpc3RNb2R1bGUuZGVsZXRlTGlzdFRvQVBJKTtcblxuICAgICAgICAvL3NvcnRhYmxlXG4gICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmQtbGlzdHMnKTtcbiAgICAgICAgY29uc3Qgc29ydGFibGUgPSBTb3J0YWJsZS5jcmVhdGUoZWwsIHtcbiAgICAgICAgICAgIGRyYWdnYWJsZSA6ICcucGFuZWwnLCAgICAvL3V0aWxlID8gamUgc2FpcyBwYXMgXl5cbiAgICAgICAgICAgIGNob3NlbkNsYXNzOiBcInNvcnRhYmxlLWNob3NlblwiLCAgLy8gUGVybWV0IGRlIGRvbm5lciB1bmUgY2xhc3NlIGEgbCfDqWzDqW1lbnQgY2hvaXNpdCBldCBtb2RpZiBsZSBjc3MgYXByw6hzXG4gICAgICAgICAgICBkYXRhSWRBdHRyOiAnZGF0YS1saXN0LWlkJywgLy8gY2hvaXNpdCBxdWVsIGVsZW1lbnQgbm91cyBkb25uZSB1biBpZFxuICAgICAgICAgICAgLy9wZXJtZXQgZGUgbmUgcGFzIGRyYWcgc3VyIGxlIGZvcm0gZXQgZGUgcG91dm9pciBlaWR0ZXIgbGUgdGV4dGVcbiAgICAgICAgICAgIGZpbHRlcjogJy5ub3Qtc29ydGFibGUnLFxuICAgICAgICAgICAgcHJldmVudE9uRmlsdGVyOiBmYWxzZSwgXG5cbiAgICAgICAgICAgIG9uRW5kOiBhc3luYyAoZXZ0KSA9PiB7ICAgLy8gZXZlbnQgw6AgbGEgZmluIGR1IGRyYWdcbiAgICAgICAgICAgICAgICBzb3J0YWJsZS50b0FycmF5KCkuZm9yRWFjaCggYXN5bmMgKGlkLCBwb3NpdGlvbikgPT4geyAgXG4gICAgICAgICAgICAgICAgICAgIC8vIHLDqWN1cMOpcmUgbCdvZHJlIHNvdXMgZm9ybWUgZGUgdGFibGVhdSBxdSdvbiBib3VjbGVcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsgICAgICAgIC8vIG9uIGNvbnN0cnVpdCB1biBmb3JtRGF0YVxuICAgICAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3Bvc2l0aW9uJywgcG9zaXRpb24pXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmZXRjaChgJHtsaXN0TW9kdWxlLnVybH0vJHtpZH1gLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kIDogJ1BBVENIJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib2R5IDogZm9ybURhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBhcyBkZSBtYWogZHUgZnJvbnQgcHVpc3F1ZSBjJ2VzdCBsZSBmcm9udCBxdWkgZW52b2llIGwnaW5mbyBhIGwnQVBJXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSlcblxuXG4gICAgfSxcblxuXG59XG5cbm1vZHVsZS5leHBvcnRzID0gbGlzdE1vZHVsZTsiLCJcbmNvbnN0IHV0aWxzTW9kdWxlID0ge1xuXG4gICAgLy9SZW1vdmUgbGEgY2xhc3MgJ2lzLWFjdGl2ZScgcG91ciBoaWRlIGxlIE1vZGFsXG4gICAgaGlkZU1vZGFsczogKCkgPT4ge1xuICAgICAgICBjb25zdCBhbGxNb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubW9kYWwnKTtcbiAgICAgICAgYWxsTW9kYWxzLmZvckVhY2gobW9kYWwgPT4ge1xuICAgICAgICAgICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgLy9mb25jdGlvbiBxdWkgZ8OpcmUgZGUgY2FjaGVyIGV0IGZhaXJlIGFwcGFyYWl0cmUgbGVzIGZvcm11bGFpcmVzXG4gICAgc2hvd0FuZEhpZGU6IChwYXJlbnQsIGNsYXNzVG9IaWRlLCBjbGFzc1RvU2hvdykgPT4ge1xuICAgICAgICBwYXJlbnQucXVlcnlTZWxlY3RvcihjbGFzc1RvSGlkZSkuY2xhc3NMaXN0LmFkZCgnaXMtaGlkZGVuJyk7XG4gICAgICAgIHBhcmVudC5xdWVyeVNlbGVjdG9yKGNsYXNzVG9TaG93KS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1oaWRkZW4nKTtcbiAgICB9LFxuXG4gICAgLy8gZm9uY3Rpb24gcG91ciB0cmFuc2Zvcm1lciB1bmUgY291bGV1ciByZ2IgZW4gaGV4XG4gICAgUkdCVG9IZXggOihyZ2IpID0+IHtcbiAgICAgICAgLy8gQ2hvb3NlIGNvcnJlY3Qgc2VwYXJhdG9yXG4gICAgICAgIGxldCBzZXAgPSByZ2IuaW5kZXhPZihcIixcIikgPiAtMSA/IFwiLFwiIDogXCIgXCI7XG4gICAgICAgIC8vIFR1cm4gXCJyZ2IocixnLGIpXCIgaW50byBbcixnLGJdXG4gICAgICAgIHJnYiA9IHJnYi5zdWJzdHIoNCkuc3BsaXQoXCIpXCIpWzBdLnNwbGl0KHNlcCk7XG4gICAgICBcbiAgICAgICAgbGV0IHIgPSAoK3JnYlswXSkudG9TdHJpbmcoMTYpLFxuICAgICAgICAgICAgZyA9ICgrcmdiWzFdKS50b1N0cmluZygxNiksXG4gICAgICAgICAgICBiID0gKCtyZ2JbMl0pLnRvU3RyaW5nKDE2KTtcbiAgICAgIFxuICAgICAgICBpZiAoci5sZW5ndGggPT0gMSlcbiAgICAgICAgICByID0gXCIwXCIgKyByO1xuICAgICAgICBpZiAoZy5sZW5ndGggPT0gMSlcbiAgICAgICAgICBnID0gXCIwXCIgKyBnO1xuICAgICAgICBpZiAoYi5sZW5ndGggPT0gMSlcbiAgICAgICAgICBiID0gXCIwXCIgKyBiO1xuICAgICAgXG4gICAgICAgIHJldHVybiBcIiNcIiArIHIgKyBnICsgYjtcbiAgICBcbiAgICB9LFxuXG59XG5cbm1vZHVsZS5leHBvcnRzID0gdXRpbHNNb2R1bGU7Il19
